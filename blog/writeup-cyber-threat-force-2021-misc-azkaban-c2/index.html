<!doctype html><html lang=en><head><title>Writeup Cyber Threat Force : Azkaban C2 :: Nicolas Bourras</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="For this challenge, we were given a python script:
import socket def menu(): print(&amp;#34;______________________&amp;#34;) print(&amp;#34;| MENU |&amp;#34;) print(&amp;#34;| 1) see option |&amp;#34;) print(&amp;#34;| 2) edit option |&amp;#34;) print(&amp;#34;| 3) connect |&amp;#34;) print(&amp;#34;______________________&amp;#34;) print(&amp;#34;&amp;#34;&amp;#34; ______ __ __ ______ / \ / | / | / \ /$$$$$$ | ________ $$ | __ ______ $$ |____ ______ _______ _______ /$$$$$$ | $$ |__$$ |/ |$$ | / | / \ $$ \ / \ / \ / |$$____$$ | $$ $$ |$$$$$$$$/ $$ |_/$$/ $$$$$$ |$$$$$$$ | $$$$$$ |$$$$$$$ | /$$$$$$$/ / $$/ $$$$$$$$ | / $$/ $$ $$&amp;lt; / $$ |$$ | $$ | / $$ |$$ | $$ | $$ | /$$$$$$/ $$ | $$ | /$$$$/__ $$$$$$ \ /$$$$$$$ |$$ |__$$ |/$$$$$$$ |$$ | $$ | $$ \_____ $$ |_____ $$ | $$ |/$$ |$$ | $$ |$$ $$ |$$ $$/ $$ $$ |$$ | $$ | $$ |$$ | $$/ $$/ $$$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$/ $$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$$/ -----=[Azkaban C2 v."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-azkaban-c2/><link rel=stylesheet href=https://nicolasb.fr/assets/style.css><link rel=stylesheet href=https://nicolasb.fr/assets/pink.css><link rel=apple-touch-icon href=https://nicolasb.fr/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://nicolasb.fr/img/favicon/pink.png><meta name=twitter:card content="summary"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Writeup Cyber Threat Force : Azkaban C2"><meta property="og:description" content="For this challenge, we were given a python script:
import socket def menu(): print(&amp;#34;______________________&amp;#34;) print(&amp;#34;| MENU |&amp;#34;) print(&amp;#34;| 1) see option |&amp;#34;) print(&amp;#34;| 2) edit option |&amp;#34;) print(&amp;#34;| 3) connect |&amp;#34;) print(&amp;#34;______________________&amp;#34;) print(&amp;#34;&amp;#34;&amp;#34; ______ __ __ ______ / \ / | / | / \ /$$$$$$ | ________ $$ | __ ______ $$ |____ ______ _______ _______ /$$$$$$ | $$ |__$$ |/ |$$ | / | / \ $$ \ / \ / \ / |$$____$$ | $$ $$ |$$$$$$$$/ $$ |_/$$/ $$$$$$ |$$$$$$$ | $$$$$$ |$$$$$$$ | /$$$$$$$/ / $$/ $$$$$$$$ | / $$/ $$ $$&amp;lt; / $$ |$$ | $$ | / $$ |$$ | $$ | $$ | /$$$$$$/ $$ | $$ | /$$$$/__ $$$$$$ \ /$$$$$$$ |$$ |__$$ |/$$$$$$$ |$$ | $$ | $$ \_____ $$ |_____ $$ | $$ |/$$ |$$ | $$ |$$ $$ |$$ $$/ $$ $$ |$$ | $$ | $$ |$$ | $$/ $$/ $$$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$/ $$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$$/ -----=[Azkaban C2 v."><meta property="og:url" content="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-azkaban-c2/"><meta property="og:site_name" content="Nicolas Bourras"><meta property="og:image" content="https://nicolasb.fr/img/favicon/pink.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-07-11 09:45:09 +0100 +0100"></head><body class=pink><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Nicolas Bourras</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-azkaban-c2/>Writeup Cyber Threat Force : Azkaban C2</a></h1><div class=post-meta><span class=post-date>2021-07-11</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/misc/>misc</a>&nbsp;</span><div class=post-content><div><p>For this challenge, we were given a python script:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> socket

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>menu</span>():
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;______________________&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;|       MENU         |&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;| 1) see option      |&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;| 2) edit option     |&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;| 3) connect         |&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;______________________&#34;</span>)
    
<span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;&#34;&#34;
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>  ______             __                  __                                             ______  
</span><span style=color:#e6db74> /      \           /  |                /  |                                           /      \ 
</span><span style=color:#e6db74>/$$$$$$  | ________ $$ |   __   ______  $$ |____    ______   _______          _______ /$$$$$$  |
</span><span style=color:#e6db74>$$ |__$$ |/        |$$ |  /  | /      \ $$      \  /      \ /       \        /       |$$____$$ |
</span><span style=color:#e6db74>$$    $$ |$$$$$$$$/ $$ |_/$$/  $$$$$$  |$$$$$$$  | $$$$$$  |$$$$$$$  |      /$$$$$$$/  /    $$/ 
</span><span style=color:#e6db74>$$$$$$$$ |  /  $$/  $$   $$&lt;   /    $$ |$$ |  $$ | /    $$ |$$ |  $$ |      $$ |      /$$$$$$/  
</span><span style=color:#e6db74>$$ |  $$ | /$$$$/__ $$$$$$  \ /$$$$$$$ |$$ |__$$ |/$$$$$$$ |$$ |  $$ |      $$ \_____ $$ |_____ 
</span><span style=color:#e6db74>$$ |  $$ |/$$      |$$ | $$  |$$    $$ |$$    $$/ $$    $$ |$$ |  $$ |      $$       |$$       |
</span><span style=color:#e6db74>$$/   $$/ $$$$$$$$/ $$/   $$/  $$$$$$$/ $$$$$$$/   $$$$$$$/ $$/   $$/        $$$$$$$/ $$$$$$$$/ 
</span><span style=color:#e6db74>                                                                                                
</span><span style=color:#e6db74>-----=[Azkaban C2 v.0.0.1 alpha]
</span><span style=color:#e6db74>&#34;&#34;&#34;</span>)

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>see_option</span>():
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;_________________________________&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;| PIN CODE : &#34;</span> <span style=color:#f92672>+</span> pin_code <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;               |&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;| Team Serveur IP : &#34;</span> <span style=color:#f92672>+</span> teamserver_ip <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;|&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;| Team Serveur Port : &#34;</span> <span style=color:#f92672>+</span> teamserver_port <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;      |&#34;</span>)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;_________________________________&#34;</span>)
        
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>edit_option</span>():
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Current option :&#34;</span>)
    see_option()
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Where option you want to edit ?&#34;</span>)
    
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34; 1) PIN_CODE</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>2) TeamServer IP </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>3) TeamServer Port &#34;</span>)
    choix <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Azk-c2 &gt; &#34;</span>)
    choix <span style=color:#f92672>=</span> str(choix)
    <span style=color:#66d9ef>while</span> (True):
        <span style=color:#66d9ef>if</span> choix <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;1&#34;</span>:
            pin_code <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Azk-c2 | Edit PIN_CODE &gt; &#34;</span>)
            pin_code <span style=color:#f92672>=</span> str(pin_code)
            <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;[+]PIN_CODE : &#34;</span> <span style=color:#f92672>+</span> pin_code)
            <span style=color:#66d9ef>break</span>
            
        <span style=color:#66d9ef>elif</span> choix <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;2&#34;</span>:
            teamserver_ip  <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Azk-c2 | Edit TeamServer IP &gt; &#34;</span>)
            teamserver_ip <span style=color:#f92672>=</span> str(teamserver_ip)
            <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;[+]TeamServer IP : &#34;</span> <span style=color:#f92672>+</span> teamserver_ip)
            <span style=color:#66d9ef>break</span>
            
        <span style=color:#66d9ef>elif</span> choix <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;3&#34;</span>:
            teamserver_port  <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Azk-c2 | Edit TeamServer Port &gt; &#34;</span>)
            teamserver_port <span style=color:#f92672>=</span> str(teamserver_port)
            <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;[+]TeamServer Port : &#34;</span> <span style=color:#f92672>+</span> teamserver_port)
            <span style=color:#66d9ef>break</span>
        <span style=color:#66d9ef>else</span>:
            <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Error&#34;</span>)
    
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>connect</span>(pin_code, teamserver_ip, teamserver_port):

    teamserver_port <span style=color:#f92672>=</span> int(teamserver_port)
    
    clientSocket <span style=color:#f92672>=</span> socket<span style=color:#f92672>.</span>socket(socket<span style=color:#f92672>.</span>AF_INET, socket<span style=color:#f92672>.</span>SOCK_STREAM);
    clientSocket<span style=color:#f92672>.</span>connect((teamserver_ip,teamserver_port));
    clientSocket<span style=color:#f92672>.</span>send(pin_code<span style=color:#f92672>.</span>encode());
    dataFromServer <span style=color:#f92672>=</span> clientSocket<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>1024</span>);
    <span style=color:#66d9ef>print</span>(dataFromServer<span style=color:#f92672>.</span>decode());
    
    res <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Azk-c2 &gt; &#34;</span>)
    res <span style=color:#f92672>=</span> str(res)
    clientSocket<span style=color:#f92672>.</span>send(res<span style=color:#f92672>.</span>encode());
    dataFromServer <span style=color:#f92672>=</span> clientSocket<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>1024</span>);
    <span style=color:#66d9ef>print</span>(dataFromServer<span style=color:#f92672>.</span>decode());
    
    

<span style=color:#66d9ef>while</span> (True):
    menu()
    pin_code <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;4785&#34;</span>
    teamserver_ip <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;144.217.73.235&#34;</span>
    teamserver_port <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;26007&#34;</span>
    
    
    choix <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Azk-c2 &gt; &#34;</span>)
    choix <span style=color:#f92672>=</span> str(choix)
    <span style=color:#66d9ef>if</span> choix <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;1&#34;</span>:
        see_option()
    <span style=color:#66d9ef>elif</span> choix <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;2&#34;</span>:
        edit_option()
    <span style=color:#66d9ef>elif</span> choix <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;3&#34;</span>:
        connect(pin_code, teamserver_ip, teamserver_port)
    <span style=color:#66d9ef>else</span>:
        <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Bad choice, try again&#34;</span>)
</code></pre></div><p>At the end, we can see an IP, a port, and a PIN. Upon connecting to the service using netcat, it asked us the result of a simple addition. After that, we had to enter the pin (4785), and select an option. Option 2, &ldquo;Dump creds&rdquo;, printed out the flag.</p><p>I unfortunately am writting this after the server was shutdown, so I can&rsquo;t include a demo.</p><p>The flag is <code>CYBERTF{0wn_th3_t3ams3rv3r}</code>.</p><p>You can <a href=https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/misc/azkaban-c2>view the sources on github</a> or <a href=/blog/cyber-threat-force-ctf/>read other writeups</a>.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://nicolasb.fr/blog/cyber-threat-force-ctf/><span class=button__icon>←</span>
<span class=button__text>Cyber Threat Force (CTF)</span></a></span>
<span class="button next"><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-like-a-duck-in-water/><span class=button__text>Writeup Cyber Threat Force : Like a duck in water</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://nicolasb.fr/assets/main.js></script><script src=https://nicolasb.fr/assets/prism.js></script></div></body></html>