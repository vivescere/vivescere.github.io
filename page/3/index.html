<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.83.1"><title>Nicolas Bourras</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://nicolasb.fr/><link rel=stylesheet href=https://nicolasb.fr/assets/style.css><link rel=stylesheet href=https://nicolasb.fr/assets/pink.css><link rel=apple-touch-icon href=https://nicolasb.fr/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://nicolasb.fr/img/favicon/pink.png><meta name=twitter:card content="summary"><meta name=twitter:creator content="vivescere"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Nicolas Bourras"><meta property="og:description" content><meta property="og:url" content="https://nicolasb.fr/"><meta property="og:site_name" content="Nicolas Bourras"><meta property="og:image" content="https://nicolasb.fr/img/favicon/pink.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/index.xml rel=alternate type=application/rss+xml title="Nicolas Bourras"></head><body class=pink><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Nicolas Bourras</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/dghack-my-second-ctf/>DG&rsquo;hAck: My Second CTF</a></h1><div class=post-meta><span class=post-date>2020-12-01</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>I joined this CTF because there was a possiblity to get an internship (or a job). I think I did pretty well, ranking 1/1214 among the students, and 5 overall out of 2063 :)
This was a whole lot of fun, I got to learn a ton of things, lose some sleep, and make new friends. I can&rsquo;t wait for my next CTF!
Here are the challenges that I completed, with links to my writeups:</div><div><a class="read-more button" href=/blog/dghack-my-second-ctf/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-involucrypt-2/>Writeup DG&rsquo;hAck: Involucrypt 2</a></h1><div class=post-meta><span class=post-date>2020-12-01</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>This is the second version of the involucrypt challenge. You can see my writeup of the first version here. It presents the encryption script and a simple bruteforce approach.
The only thing that changed for the second version is the encrypted data, which is now 1497 bytes long. This makes the previous bruteforce attempt unusable: checking a single key takes about 50ms on my machine, and there are a lot of possible keys (since it&rsquo;s 10 chars instead of 3).</div><div><a class="read-more button" href=/blog/writeup-dghack-involucrypt-2/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-job-board/>Writeup DG&rsquo;hAck: Job Board</a></h1><div class=post-meta><span class=post-date>2020-11-30</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>This challenge starts with a website that presents a list of jobs (once connected). Our goal is to login as an administrator. Here is the landing page:
Right of the bat, we see a login link, and a contact link. The contact page seems interesting, and after toying around with some XSS payloads, we quickly find that a bot clicks on any link that is passed as a message.</div><div><a class="read-more button" href=/blog/writeup-dghack-job-board/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-time-for-something-different/>Writeup DG&rsquo;hAck: Time for Something Different</a></h1><div class=post-meta><span class=post-date>2020-11-30</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>This is a steganography challenge where we&rsquo;re given a PCAP file. Opening it in wireshark reveals a list of identical ICMP packets.
Nothing seems to be unique, except the time of each packet, that we can extract using tshark:
$ tshark -r data.pcap -T fields -e frame.time_epoch 1604485685.271523000 1604485685.974534000 1604485686.737381000 1604485687.390550000 1604485688.103364000 1604485689.336651000 1604485690.500205000 1604485690.982931000 1604485691.465408000 1604485692.617796000 1604485693.701056000 1604485694.814156000 1604485695.686772000 1604485696.799993000 1604485697.943153000 1604485699.106441000 1604485699.589015000 1604485700.071611000 1604485700.754520000 1604485701.266580000 1604485702.449633000 1604485702.942506000 1604485704.054744000 1604485705.</div><div><a class="read-more button" href=/blog/writeup-dghack-time-for-something-different/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-stickitup/>Writeup DG&rsquo;hAck: StickItUp</a></h1><div class=post-meta><span class=post-date>2020-11-30</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>When starting this challenge, we&rsquo;re greeted by two forms, a login one and a registration one. Registering for an account allows us to login, which brings us to this dashboard:
We&rsquo;re asked to find a note created by the admin user. I started by trying a few SQLi on the login page (they didn&rsquo;t work), and noticed this in the source code:
&lt;!-- $_COOKIES['auth'] = 'testuser:' . sha1(SECRET_KEY . 'testuser'); --> So the auth cookie format is username:hash, where the hash is a SHA1 of a secret plus the username.</div><div><a class="read-more button" href=/blog/writeup-dghack-stickitup/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-bwing/>Writeup DG&rsquo;hAck: Bwing</a></h1><div class=post-meta><span class=post-date>2020-11-30</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>For this challenge, we&rsquo;re given a dump.raw file, which we&rsquo;re told is a memory dump. We have to find confidential data in it.
First, let&rsquo;s see what kind of image this is:
$ volatility -f dump.raw imageinfo Volatility Foundation Volatility Framework 2.6.1 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : No suggestion (Instantiated with no profile) AS Layer1 : FileAddressSpace (/home/vivescere/Projects/dghack/bwing/dump.raw) PAE type : No PAE None of the default profiles seem to work, we&rsquo;ll have to create our own.</div><div><a class="read-more button" href=/blog/writeup-dghack-bwing/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-sad-crypto/>Writeup DG&rsquo;hAck: Sad Crypto</a></h1><div class=post-meta><span class=post-date>2020-11-30</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>This challenge starts with a login page:
From the description, we gather that this is a service that generates decryption keys when given a French SSN. Our goal is to get the key for this number: 1-46-85-30-750-318-37.
admin/admin doesn&rsquo;t seem to work, let&rsquo;s try an SQLi! Entering " or 1=1 -- as the username reveals a second page:
We seem to be able to enter a patient name (that we have to auto-complete), and get a decryption key: 797b4c-c4bd852fe0e32ebda194cb2a9fe00099.</div><div><a class="read-more button" href=/blog/writeup-dghack-sad-crypto/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-shadowmallet/>Writeup DG&rsquo;hAck: Shadowmallet</a></h1><div class=post-meta><span class=post-date>2020-11-28</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>This challenge starts with a file called shadowmallet. We&rsquo;re asked to help an administrator whose server detected an abnormal activity.
The file command doesn&rsquo;t give us anything:
$ file shadowmallet shadowmallet: data But searching for the first few bytes (53ff 00f0 53ff 00f0 53ff 00f0 53ff 00f0) of the file online quickly reveals it&rsquo;s a memory dump. Let&rsquo;s use volatility!
$ volatility -f shadowmallet imageinfo Volatility Foundation Volatility Framework 2.6.1 INFO : volatility.</div><div><a class="read-more button" href=/blog/writeup-dghack-shadowmallet/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-gitbad/>Writeup DG&rsquo;hAck: Gitbad</a></h1><div class=post-meta><span class=post-date>2020-11-28</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>This challenge takes place on a Gitlab instance, where we have to find private data. You start by creating an account, which is automatically validated after a few seconds. Once logged in, you can do a few things, for example:
create a project create a group edit your profile see the help page see public repositories Nothing seems to be particularly interesting, except for this message, on the help page:</div><div><a class="read-more button" href=/blog/writeup-dghack-gitbad/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-dghack-involucrypt-1/>Writeup DG&rsquo;hAck: Involucrypt 1</a></h1><div class=post-meta><span class=post-date>2020-11-20</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/dghack/>dghack</a>&nbsp;</span><div class=post-content>This writeup uses a naive approach, see my writeup of involucrypt 2 for a better solution.
The challenge starts off with two files:
crypt.py involucrypt1 The first one is a script that can encode a message, the second one contains crypted data.
Here is the (slightly redacted) script:
import itertools import operator import sys BLOCK = 150 class mersenne_rng(object): ... def keystream(seeds, length, base=None): key = base if base else [] for seed in seeds: random = mersenne_rng(seed) for _ in range(BLOCK): if len(key) == length: break key.</div><div><a class="read-more button" href=/blog/writeup-dghack-involucrypt-1/>Read more →</a></div></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=/page/2/><span class=button__icon>←</span>
<span class=button__text>Newer posts</span></a></span>
<span class="button next"><a href=/page/4/><span class=button__text>Older posts</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://nicolasb.fr/assets/main.js></script><script src=https://nicolasb.fr/assets/prism.js></script></div></body></html>