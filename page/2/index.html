<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.83.1"><title>Nicolas Bourras</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://nicolasb.fr/><link rel=stylesheet href=https://nicolasb.fr/assets/style.css><link rel=stylesheet href=https://nicolasb.fr/assets/pink.css><link rel=apple-touch-icon href=https://nicolasb.fr/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://nicolasb.fr/img/favicon/pink.png><meta name=twitter:card content="summary"><meta name=twitter:creator content="vivescere"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Nicolas Bourras"><meta property="og:description" content><meta property="og:url" content="https://nicolasb.fr/"><meta property="og:site_name" content="Nicolas Bourras"><meta property="og:image" content="https://nicolasb.fr/img/favicon/pink.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/index.xml rel=alternate type=application/rss+xml title="Nicolas Bourras"></head><body class=pink><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Nicolas Bourras</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/>Posts</a></li><li><a href=/recipes>Recipes</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-smasher/>Writeup Cyber Threat Force : Smasher</a></h1><div class=post-meta><span class=post-date>2021-07-10</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/reverse/>reverse</a>&nbsp;</span><div class=post-content>For this challenge, we were given two files:
smasher-1.0.0.AppImage smasher_Setup_1.0.0.exe I only looked at the AppImage one, since I&rsquo;m running linux. Launching the program reveals an electron app:
We can simply use the dev tools to reveal the source code. Only one javascript file is there, login.js:
function Login() { var i = { _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", encode: function(r) { var t, e, o, a, n, c, h = "", d = 0; for (r = i.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-reverse-smasher/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-verify-this/>Writeup Cyber Threat Force : Verify this</a></h1><div class=post-meta><span class=post-date>2021-07-10</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/reverse/>reverse</a>&nbsp;</span><div class=post-content>For this challenge, we were given a Stagged.exe executable. Before running it on our machine, we can try to run it against hybrid analysis, an online malware analysis service.
Here is the link to the full report.
We can see in the &ldquo;Network Analysis&rdquo; tab that the program made two requests:
HTTP Traffic&rdquo; part of the report"
Trying to download the first image gives us a PE file. If we upload it again, we see that it also makes a request to /ordertoexecute.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-reverse-verify-this/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-welcome-to-the-matrix/>Writeup Cyber Threat Force : Welcome to the matrix</a></h1><div class=post-meta><span class=post-date>2021-07-09</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/forensic/>forensic</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-forensic-welcome-to-the-matrix/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-flag-checker/>Writeup Cyber Threat Force : Flag checker</a></h1><div class=post-meta><span class=post-date>2021-07-09</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/reverse/>reverse</a>&nbsp;</span><div class=post-content>For this challenge, we were given a program executable.
$ ./program ./program FLAG $ ./program MYFLAG failed Seems like it valides the flag that is passed as an argument. Let&rsquo;s open the binary in Ghidra.
There are a lot of functions defined, and looking at the exports we see that quite a lot of them start with caml_. I didn&rsquo;t know you could compile OCaml to C, that&rsquo;s pretty neat.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-reverse-flag-checker/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-take-your-time/>Writeup Cyber Threat Force : Take your time</a></h1><div class=post-meta><span class=post-date>2021-07-08</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/reverse/>reverse</a>&nbsp;</span><div class=post-content>For this challenge, we were given a TakeYourTime executable, which seems to hang when we run it. We can analyze its code using ghidra:
unsigned int FLAG[] = { 0xb5, 0x63, 0x98, 0x3d, 0xb5, 0x06, 0x46, 0xba, 0x0f, 0xd5, 0x47, 0xce, 0x97, 0xef, 0x7b, 0x28, 0xdb, 0xe7, 0x39, 0x10, 0xb0, 0xf5, 0x44, 0xec, 0x30, 0x88, 0x46, 0xf6, 0x88, }; undefined8 main(void) { byte bVar1; int iVar2; uint local_28; int local_24; ulong local_20; local_28 = 0; local_20 = 0x32; while (local_20 &lt; 0x4f) { bVar1 = fibonacci(); local_28 = local_28 >> 8 | (local_28 ^ bVar1) &lt;&lt; 0x18; local_20 = local_20 + 1; } srand(local_28); local_24 = 0; while (local_24 &lt; 0x1d) { bVar1 = FLAG[local_24]; iVar2 = rand(); putchar((uint)bVar1 ^ iVar2 % 0xff); local_24 = local_24 + 1; } puts("\nGood you can validate the chall with this password ;)!</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-reverse-take-your-time/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-return-to-the-school/>Writeup Cyber Threat Force : Return to the school</a></h1><div class=post-meta><span class=post-date>2021-07-08</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/misc/>misc</a>&nbsp;</span><div class=post-content>This challenge involved solving an ASCII maze in under 10 seconds. I can&rsquo;t include a demo because I&rsquo;m writing this after the CTF ended.
My script uses the astar package, because I was too lazy to re-implement A* manually. It isn&rsquo;t particularly pretty, but at least it is functionnal.
Here it is:
import math from pwn import * from astar import AStar def parse_maze(source): source = source.strip() source = source.split('\n') source = source[:-1] # Remove last line (dots) source = [list(l[1:-1]) for l in source] # Remove left and right dots return source # Mostly copied from the astar package example.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-misc-return-to-the-school/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-privesc/>Writeup Cyber Threat Force : PrivEsc</a></h1><div class=post-meta><span class=post-date>2021-07-08</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/pwn/>pwn</a>&nbsp;</span><div class=post-content>For this challenge, we were given SSH access to a machine, as the user ctf. After running sudo -l, we quickly find that we can run the /opt/Ivazov binary as ctf_cracked. The user in question has a flag.txt file in their home, which only they can read.
We also notice env_keep += LD_PRELOAD. From there, we can try an LD_PRELOAD exploit. The steps taken here are copied from the guide was was just linked.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-pwn-privesc/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-3/>Writeup Cyber Threat Force : bof_3</a></h1><div class=post-meta><span class=post-date>2021-07-08</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/pwn/>pwn</a>&nbsp;</span><div class=post-content>For this challenge, we also were given a service executable. It was hosted remotely.
NOTE: since I&rsquo;m writting this after the CTF ended, the demos are done locally.
$ checksec ./service [*] '/home/vivescere/ctf/bof_3/service' Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) $ ./service password: mypassword nop NX enabled, and partial RELRO. Let&rsquo;s take a look at the binary using Ghidra:
undefined4 main(void) { ignorMe(&stack0x00000004); puts("password: "); vuln(); puts("nop"); return 0; } void vuln(void) { undefined local_70 [104]; read(0,local_70,0x96); return; } We have an overflow, but not much else going on.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-pwn-bof-3/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-2/>Writeup Cyber Threat Force : bof_2 (with PrivEsc)</a></h1><div class=post-meta><span class=post-date>2021-07-07</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/pwn/>pwn</a>&nbsp;</span><div class=post-content>For this challenge, we were also given a service executable. It was also hosted remotely.
NOTE: since I&rsquo;m writting this after the CTF ended, the demos are done locally.
Level 1 $ checksec service [*] '/home/vivescere/ctf/bof_2/service' Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX disabled PIE: PIE enabled RWX: Has RWX segments $ ./service Hello authentifie toi ! Username: vivescere Bienvenue vivescere password: mypassword oops i have lost my db sorry This time, the only protection that&rsquo;s activated is PIE, which means addresses won&rsquo;t be stable.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-pwn-bof-2/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-1/>Writeup Cyber Threat Force : bof_1 (with GetShell & PrivEsc)</a></h1><div class=post-meta><span class=post-date>2021-07-07</span></div><span class=post-tags>#<a href=https://nicolasb.fr/tags/blog/>blog</a>&nbsp;
#<a href=https://nicolasb.fr/tags/security/>security</a>&nbsp;
#<a href=https://nicolasb.fr/tags/ctf/>ctf</a>&nbsp;
#<a href=https://nicolasb.fr/tags/cyber-threat-force/>cyber-threat-force</a>&nbsp;
#<a href=https://nicolasb.fr/tags/pwn/>pwn</a>&nbsp;</span><div class=post-content>For this challenge, we were given a service executable. It was also hosted remotely.
NOTE: since I&rsquo;m writting this after the CTF ended, the demos are done locally.
Level 1 $ checksec service [*] '/home/vivescere/ctf/bof_1/service' Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) $ ./service hello who are you? vivescere Hello vivescere We do have NX enabled, along with canaries and partial RELRO. Also, the executable is statically linked, meaning we won&rsquo;t have access to the libc easily.</div><div><a class="read-more button" href=/blog/writeup-cyber-threat-force-2021-pwn-bof-1/>Read more →</a></div></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=/><span class=button__icon>←</span>
<span class=button__text>Newer posts</span></a></span>
<span class="button next"><a href=/page/3/><span class=button__text>Older posts</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://nicolasb.fr/assets/main.js></script><script src=https://nicolasb.fr/assets/prism.js></script></div></body></html>